var Mi=Object.create;var St=Object.defineProperty;var Ri=Object.getOwnPropertyDescriptor;var xi=Object.getOwnPropertyNames;var Di=Object.getPrototypeOf,Li=Object.prototype.hasOwnProperty;var re=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(t,i)=>(typeof require<"u"?require:t)[i]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var vt=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var Fi=(r,t,i,d)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of xi(t))!Li.call(r,a)&&a!==i&&St(r,a,{get:()=>t[a],enumerable:!(d=Ri(t,a))||d.enumerable});return r};var $e=(r,t,i)=>(i=r!=null?Mi(Di(r)):{},Fi(t||!r||!r.__esModule?St(i,"default",{value:r,enumerable:!0}):i,r));var qe=vt(Ie=>{(function(r){Date.now=Date.now||function(){return new Date().getTime()};var t={extend:function(){arguments[0]=arguments[0]||{};for(var a=1;a<arguments.length;a++)for(var s in arguments[a])arguments[a].hasOwnProperty(s)&&(typeof arguments[a][s]=="object"?arguments[a][s]instanceof Array?arguments[0][s]=arguments[a][s]:arguments[0][s]=t.extend(arguments[0][s],arguments[a][s]):arguments[0][s]=arguments[a][s]);return arguments[0]},binarySearch:function(a,s){for(var h=0,o=a.length;h<o;){var e=h+o>>1;s<a[e][0]?o=e:h=e+1}return h},pixelSnap:function(a,s){return s%2===0?Math.round(a):Math.floor(a)+.5}};function i(a){this.options=t.extend({},i.defaultOptions,a),this.disabled=!1,this.clear()}i.defaultOptions={resetBoundsInterval:3e3,resetBounds:!0},i.prototype.clear=function(){this.data=[],this.maxValue=Number.NaN,this.minValue=Number.NaN},i.prototype.resetBounds=function(){if(this.data.length){this.maxValue=this.data[0][1],this.minValue=this.data[0][1];for(var a=1;a<this.data.length;a++){var s=this.data[a][1];s>this.maxValue&&(this.maxValue=s),s<this.minValue&&(this.minValue=s)}}else this.maxValue=Number.NaN,this.minValue=Number.NaN},i.prototype.append=function(a,s,h){if(!(isNaN(a)||isNaN(s))){var o=this.data.length-1;if(o>=0)for(var e=o;;){var n=this.data[e];if(a>=n[0]){a===n[0]?h?(n[1]+=s,s=n[1]):n[1]=s:this.data.splice(e+1,0,[a,s]);break}if(e--,e<0){this.data.splice(0,0,[a,s]);break}}else this.data.push([a,s]);this.maxValue=isNaN(this.maxValue)?s:Math.max(this.maxValue,s),this.minValue=isNaN(this.minValue)?s:Math.min(this.minValue,s)}},i.prototype.dropOldData=function(a,s){for(var h=0;this.data.length-h>=s&&this.data[h+1][0]<a;)h++;h!==0&&this.data.splice(0,h)};function d(a){this.options=t.extend({},d.defaultChartOptions,a),this.seriesSet=[],this.currentValueRange=1,this.currentVisMinValue=0,this.lastRenderTimeMillis=0,this.lastChartTimestamp=0,this.mousemove=this.mousemove.bind(this),this.mouseout=this.mouseout.bind(this)}d.tooltipFormatter=function(a,s){var h=this.options.timestampFormatter||d.timeFormatter,o=document.createElement("div"),e;o.appendChild(document.createTextNode(h(new Date(a))));for(var n=0;n<s.length;++n){e=s[n].series.options.tooltipLabel||"",e!==""&&(e=e+" ");var c=document.createElement("span");c.style.color=s[n].series.options.strokeStyle,c.appendChild(document.createTextNode(e+this.options.yMaxFormatter(s[n].value,this.options.labels.precision))),o.appendChild(document.createElement("br")),o.appendChild(c)}return o.innerHTML},d.defaultChartOptions={millisPerPixel:20,enableDpiScaling:!0,yMinFormatter:function(a,s){return parseFloat(a).toFixed(s)},yMaxFormatter:function(a,s){return parseFloat(a).toFixed(s)},yIntermediateFormatter:function(a,s){return parseFloat(a).toFixed(s)},maxValueScale:1,minValueScale:1,interpolation:"bezier",scaleSmoothing:.125,maxDataSetLength:2,scrollBackwards:!1,displayDataFromPercentile:1,grid:{fillStyle:"#000000",strokeStyle:"#777777",lineWidth:2,millisPerLine:1e3,verticalSections:2,borderVisible:!0},labels:{fillStyle:"#ffffff",disabled:!1,fontSize:10,fontFamily:"monospace",precision:2,showIntermediateLabels:!1,intermediateLabelSameAxis:!0},title:{text:"",fillStyle:"#ffffff",fontSize:15,fontFamily:"monospace",verticalAlign:"middle"},horizontalLines:[],tooltip:!1,tooltipLine:{lineWidth:1,strokeStyle:"#BBBBBB"},tooltipFormatter:d.tooltipFormatter,nonRealtimeData:!1,responsive:!1,limitFPS:0},d.AnimateCompatibility=function(){var a=function(h,o){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){return window.setTimeout(function(){n(Date.now())},16)};return e.call(window,h,o)},s=function(h){var o=window.cancelAnimationFrame||function(e){clearTimeout(e)};return o.call(window,h)};return{requestAnimationFrame:a,cancelAnimationFrame:s}}(),d.defaultSeriesPresentationOptions={lineWidth:1,strokeStyle:"#ffffff"},d.prototype.addTimeSeries=function(a,s){this.seriesSet.push({timeSeries:a,options:t.extend({},d.defaultSeriesPresentationOptions,s)}),a.options.resetBounds&&a.options.resetBoundsInterval>0&&(a.resetBoundsTimerId=setInterval(function(){a.resetBounds()},a.options.resetBoundsInterval))},d.prototype.removeTimeSeries=function(a){for(var s=this.seriesSet.length,h=0;h<s;h++)if(this.seriesSet[h].timeSeries===a){this.seriesSet.splice(h,1);break}a.resetBoundsTimerId&&clearInterval(a.resetBoundsTimerId)},d.prototype.getTimeSeriesOptions=function(a){for(var s=this.seriesSet.length,h=0;h<s;h++)if(this.seriesSet[h].timeSeries===a)return this.seriesSet[h].options},d.prototype.bringToFront=function(a){for(var s=this.seriesSet.length,h=0;h<s;h++)if(this.seriesSet[h].timeSeries===a){var o=this.seriesSet.splice(h,1);this.seriesSet.push(o[0]);break}},d.prototype.streamTo=function(a,s){this.canvas=a,this.clientWidth=parseInt(this.canvas.getAttribute("width")),this.clientHeight=parseInt(this.canvas.getAttribute("height")),this.delay=s,this.start()},d.prototype.getTooltipEl=function(){return this.tooltipEl||(this.tooltipEl=document.createElement("div"),this.tooltipEl.className="smoothie-chart-tooltip",this.tooltipEl.style.pointerEvents="none",this.tooltipEl.style.position="absolute",this.tooltipEl.style.display="none",document.body.appendChild(this.tooltipEl)),this.tooltipEl},d.prototype.updateTooltip=function(){if(this.options.tooltip){var a=this.getTooltipEl();if(!this.mouseover||!this.options.tooltip){a.style.display="none";return}for(var s=this.lastChartTimestamp,h=this.options.scrollBackwards?s-this.mouseX*this.options.millisPerPixel:s-(this.clientWidth-this.mouseX)*this.options.millisPerPixel,o=[],e=0;e<this.seriesSet.length;e++){var n=this.seriesSet[e].timeSeries;if(!n.disabled){var c=t.binarySearch(n.data,h);c>0&&c<n.data.length&&o.push({series:this.seriesSet[e],index:c,value:n.data[c][1]})}}o.length?(a.innerHTML=this.options.tooltipFormatter.call(this,h,o),a.style.display="block"):a.style.display="none"}},d.prototype.mousemove=function(a){if(this.mouseover=!0,this.mouseX=a.offsetX,this.mouseY=a.offsetY,this.mousePageX=a.pageX,this.mousePageY=a.pageY,!!this.options.tooltip){var s=this.getTooltipEl();s.style.top=Math.round(this.mousePageY)+"px",s.style.left=Math.round(this.mousePageX)+"px",this.updateTooltip()}},d.prototype.mouseout=function(){this.mouseover=!1,this.mouseX=this.mouseY=-1,this.tooltipEl&&(this.tooltipEl.style.display="none")},d.prototype.resize=function(){var a=!this.options.enableDpiScaling||!window?1:window.devicePixelRatio,s,h;this.options.responsive?(s=this.canvas.offsetWidth,h=this.canvas.offsetHeight,s!==this.lastWidth&&(this.lastWidth=s,this.canvas.setAttribute("width",Math.floor(s*a).toString()),this.canvas.getContext("2d").scale(a,a)),h!==this.lastHeight&&(this.lastHeight=h,this.canvas.setAttribute("height",Math.floor(h*a).toString()),this.canvas.getContext("2d").scale(a,a)),this.clientWidth=s,this.clientHeight=h):(s=parseInt(this.canvas.getAttribute("width")),h=parseInt(this.canvas.getAttribute("height")),a!==1?(Math.floor(this.clientWidth*a)!==s&&(this.canvas.setAttribute("width",Math.floor(s*a).toString()),this.canvas.style.width=s+"px",this.clientWidth=s,this.canvas.getContext("2d").scale(a,a)),Math.floor(this.clientHeight*a)!==h&&(this.canvas.setAttribute("height",Math.floor(h*a).toString()),this.canvas.style.height=h+"px",this.clientHeight=h,this.canvas.getContext("2d").scale(a,a))):(this.clientWidth=s,this.clientHeight=h))},d.prototype.start=function(){if(!this.frame){this.canvas.addEventListener("mousemove",this.mousemove),this.canvas.addEventListener("mouseout",this.mouseout);var a=function(){this.frame=d.AnimateCompatibility.requestAnimationFrame(function(){if(this.options.nonRealtimeData){var s=new Date(0),h=this.seriesSet.reduce(function(o,e){var n=e.timeSeries.data,c=Math.round(this.options.displayDataFromPercentile*n.length)-1;if(c=c>=0?c:0,c=c<=n.length-1?c:n.length-1,n&&n.length>0){var f=n[c][0];o=o>f?o:f}return o}.bind(this),s);this.render(this.canvas,h>s?h:null)}else this.render();a()}.bind(this))}.bind(this);a()}},d.prototype.stop=function(){this.frame&&(d.AnimateCompatibility.cancelAnimationFrame(this.frame),delete this.frame,this.canvas.removeEventListener("mousemove",this.mousemove),this.canvas.removeEventListener("mouseout",this.mouseout))},d.prototype.updateValueRange=function(){for(var a=this.options,s=Number.NaN,h=Number.NaN,o=0;o<this.seriesSet.length;o++){var e=this.seriesSet[o].timeSeries;e.disabled||(isNaN(e.maxValue)||(s=isNaN(s)?e.maxValue:Math.max(s,e.maxValue)),isNaN(e.minValue)||(h=isNaN(h)?e.minValue:Math.min(h,e.minValue)))}if(a.maxValue!=null?s=a.maxValue:s*=a.maxValueScale,a.minValue!=null?h=a.minValue:h-=Math.abs(h*a.minValueScale-h),this.options.yRangeFunction){var n=this.options.yRangeFunction({min:h,max:s});h=n.min,s=n.max}if(!isNaN(s)&&!isNaN(h)){var c=s-h,f=c-this.currentValueRange,u=h-this.currentVisMinValue;this.isAnimatingScale=Math.abs(f)>.1||Math.abs(u)>.1,this.currentValueRange+=a.scaleSmoothing*f,this.currentVisMinValue+=a.scaleSmoothing*u}this.valueRange={min:h,max:s}},d.prototype.render=function(a,s){var h=Date.now();if(!(this.options.limitFPS>0&&h-this.lastRenderTimeMillis<1e3/this.options.limitFPS)){if(s=(s||h)-(this.delay||0),s-=s%this.options.millisPerPixel,!this.isAnimatingScale){var o=this.lastChartTimestamp===s;if(o){var e=h-this.lastRenderTimeMillis>166.66666666666666;if(!e)return}}this.lastRenderTimeMillis=h,this.lastChartTimestamp=s,this.resize(),a=a||this.canvas;var n=a.getContext("2d"),c=this.options,f={top:0,left:0,width:this.clientWidth,height:this.clientHeight},u=s-f.width*c.millisPerPixel,g=function(O,X){var $=O-this.currentVisMinValue,J=this.currentValueRange===0?f.height:f.height*(1-$/this.currentValueRange);return t.pixelSnap(J,X)}.bind(this),v=function(O,X){var $=c.scrollBackwards?(s-O)/c.millisPerPixel:f.width-(s-O)/c.millisPerPixel;return t.pixelSnap($,X)};if(this.updateValueRange(),n.font=c.labels.fontSize+"px "+c.labels.fontFamily,n.save(),n.translate(f.left,f.top),n.beginPath(),n.rect(0,0,f.width,f.height),n.clip(),n.save(),n.fillStyle=c.grid.fillStyle,n.clearRect(0,0,f.width,f.height),n.fillRect(0,0,f.width,f.height),n.restore(),n.save(),n.lineWidth=c.grid.lineWidth,n.strokeStyle=c.grid.strokeStyle,c.grid.millisPerLine>0){n.beginPath();for(var p=s-s%c.grid.millisPerLine;p>=u;p-=c.grid.millisPerLine){var I=v(p,c.grid.lineWidth);n.moveTo(I,0),n.lineTo(I,f.height)}n.stroke(),n.closePath()}for(var M=1;M<c.grid.verticalSections;M++){var b=t.pixelSnap(M*f.height/c.grid.verticalSections,c.grid.lineWidth);n.beginPath(),n.moveTo(0,b),n.lineTo(f.width,b),n.stroke(),n.closePath()}if(c.grid.borderVisible&&(n.beginPath(),n.strokeRect(0,0,f.width,f.height),n.closePath()),n.restore(),c.horizontalLines&&c.horizontalLines.length)for(var E=0;E<c.horizontalLines.length;E++){var R=c.horizontalLines[E],_=R.lineWidth||1,m=g(R.value,_);n.strokeStyle=R.color||"#ffffff",n.lineWidth=_,n.beginPath(),n.moveTo(0,m),n.lineTo(f.width,m),n.stroke(),n.closePath()}for(var l=0;l<this.seriesSet.length;l++){var x=this.seriesSet[l].timeSeries,C=x.data;if(x.dropOldData(u,c.maxDataSetLength),!(C.length<=1||x.disabled)){n.save();var S=this.seriesSet[l].options,A=S.strokeStyle&&S.strokeStyle!=="none",w=A?S.lineWidth:0;n.beginPath();var D=v(C[0][0],w),F=g(C[0][1],w),P=D,L=F,N;switch(n.moveTo(D,F),S.interpolation||c.interpolation){case"linear":case"line":{N=function(O,X,$,J){n.lineTo(O,X)};break}case"bezier":default:{N=function(O,X,$,J){n.bezierCurveTo(Math.round(($+O)/2),J,Math.round($+O)/2,X,O,X)};break}case"step":{N=function(O,X,$,J){n.lineTo(O,J),n.lineTo(O,X)};break}}for(var V=1;V<C.length;V++){var K=C[V],ae=v(K[0],w),Ct=g(K[1],w);N(ae,Ct,P,L),P=ae,L=Ct}A&&(n.lineWidth=S.lineWidth,n.strokeStyle=S.strokeStyle,n.stroke()),S.fillStyle&&(n.lineTo(P,f.height+w+1),n.lineTo(D,f.height+w+1),n.fillStyle=S.fillStyle,n.fill()),n.restore()}}c.tooltip&&this.mouseX>=0&&(n.lineWidth=c.tooltipLine.lineWidth,n.strokeStyle=c.tooltipLine.strokeStyle,n.beginPath(),n.moveTo(this.mouseX,0),n.lineTo(this.mouseX,f.height),n.closePath(),n.stroke()),this.updateTooltip();var Y=c.labels;if(!Y.disabled&&!isNaN(this.valueRange.min)&&!isNaN(this.valueRange.max)){var gt=c.yMaxFormatter(this.valueRange.max,Y.precision),Te=c.yMinFormatter(this.valueRange.min,Y.precision),vi=c.scrollBackwards?0:f.width-n.measureText(gt).width-2,Ei=c.scrollBackwards?0:f.width-n.measureText(Te).width-2;n.fillStyle=Y.fillStyle,n.fillText(gt,vi,Y.fontSize),n.fillText(Te,Ei,f.height-2)}if(Y.showIntermediateLabels&&!isNaN(this.valueRange.min)&&!isNaN(this.valueRange.max)&&c.grid.verticalSections>0)for(var Ai=(this.valueRange.max-this.valueRange.min)/c.grid.verticalSections,bi=f.height/c.grid.verticalSections,M=1;M<c.grid.verticalSections;M++){var b=f.height-Math.round(M*bi),Xe=c.yIntermediateFormatter(this.valueRange.min+M*Ai,Y.precision),Ti=Y.intermediateLabelSameAxis?c.scrollBackwards?0:f.width-n.measureText(Xe).width-2:c.scrollBackwards?f.width-n.measureText(Xe).width-2:0;n.fillText(Xe,Ti,b-c.grid.lineWidth)}if(c.timestampFormatter&&c.grid.millisPerLine>0)for(var ze=c.scrollBackwards?n.measureText(Te).width:f.width-n.measureText(Te).width+4,p=s-s%c.grid.millisPerLine;p>=u;p-=c.grid.millisPerLine){var I=v(p,0);if(!c.scrollBackwards&&I<ze||c.scrollBackwards&&I>ze){var Ii=new Date(p),Ue=c.timestampFormatter(Ii),We=n.measureText(Ue).width;ze=c.scrollBackwards?I+We+2:I-We-2,n.fillStyle=c.labels.fillStyle,c.scrollBackwards?n.fillText(Ue,I,f.height-2):n.fillText(Ue,I-We,f.height-2)}}if(c.title.text!==""){n.font=c.title.fontSize+"px "+c.title.fontFamily;var wi=c.scrollBackwards?f.width-n.measureText(c.title.text).width-2:2;if(c.title.verticalAlign=="bottom"){n.textBaseline="bottom";var Ye=f.height}else if(c.title.verticalAlign=="middle"){n.textBaseline="middle";var Ye=f.height/2}else{n.textBaseline="top";var Ye=0}n.fillStyle=c.title.fillStyle,n.fillText(c.title.text,wi,Ye)}n.restore()}},d.timeFormatter=function(a){function s(h){return(h<10?"0":"")+h}return s(a.getHours())+":"+s(a.getMinutes())+":"+s(a.getSeconds())},r.TimeSeries=i,r.SmoothieChart=d})(Ie)});var It=vt((Tt,Ze)=>{(function(r){if(typeof Tt=="object"&&typeof Ze<"u")Ze.exports=r();else if(typeof define=="function"&&define.amd)define([],r);else{var t;t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this,t.Fili=r()}})(function(){return function r(t,i,d){function a(o,e){if(!i[o]){if(!t[o]){var n=typeof re=="function"&&re;if(!e&&n)return n(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var f=i[o]={exports:{}};t[o][0].call(f.exports,function(u){var g=t[o][1][u];return a(g||u)},f,f.exports,r,t,i,d)}return i[o].exports}for(var s=typeof re=="function"&&re,h=0;h<d.length;h++)a(d[h]);return a}({1:[function(r,t,i){"use strict";t.exports={CalcCascades:r("./src/calcCascades"),Fft:r("./src/fft"),FirCoeffs:r("./src/firCoeffs"),FirFilter:r("./src/firFilter"),IirCoeffs:r("./src/iirCoeffs"),IirFilter:r("./src/iirFilter"),TestFilter:r("./src/testFilter")}},{"./src/calcCascades":2,"./src/fft":3,"./src/firCoeffs":4,"./src/firFilter":5,"./src/iirCoeffs":6,"./src/iirFilter":7,"./src/testFilter":8}],2:[function(r,t,i){"use strict";var d=r("./iirCoeffs"),a=new d,s={bessel:{q:[[.57735026919],[.805538281842,.521934581669],[1.02331395383,.611194546878,.510317824749],[1.22566942541,.710852074442,.559609164796,.505991069397],[1.41530886916,.809790964842,.620470155556,.537552151325,.503912727276],[1.59465693507,.905947107025,.684008068137,.579367238641,.525936202016,.502755558204],[1.76552743493,.998998442993,.747625068271,.624777082395,.556680772868,.519027293158,.502045428643],[1.9292718407,1.08906376917,.810410302962,.671382379377,.591144659703,.542678365981,.514570953471,.501578400482],[2.08691792612,1.17637337045,.872034231424,.718163551101,.627261751983,.569890924765,.533371782078,.511523796759,.50125489338],[2.23926560629,1.26117120993,.932397288146,.764647810579,.664052481472,.598921924986,.555480327396,.526848630061,.509345928377,.501021580965],[2.38695091667,1.34368488961,.991497755204,.81060830488,.701011199665,.628878390935,.57943181849,.545207253735,.52208637596,.507736060535,.500847111042],[2.53048919562,1.42411783481,1.04937620183,.85593899901,.737862159044,.659265671705,.604435823473,.565352679646,.537608804383,.51849505465,.506508536474,.500715908905]],f3dB:[[1.27201964951],[1.60335751622,1.43017155999],[1.9047076123,1.68916826762,1.60391912877],[2.18872623053,1.95319575902,1.8320926012,1.77846591177],[2.45062684305,2.20375262593,2.06220731793,1.98055310881,1.94270419166],[2.69298925084,2.43912611431,2.28431825401,2.18496722634,2.12472538477,2.09613322542],[2.91905714471,2.66069088948,2.49663434571,2.38497976939,2.30961462222,2.26265746534,2.24005716132],[3.13149167404,2.87016099416,2.69935018044,2.57862945683,2.49225505119,2.43227707449,2.39427710712,2.37582307687],[3.33237300564,3.06908580184,2.89318259511,2.76551588399,2.67073340527,2.60094950474,2.55161764546,2.52001358804,2.50457164552],[3.52333123464,3.25877569704,3.07894353744,2.94580435024,2.84438325189,2.76691082498,2.70881411245,2.66724655259,2.64040228249,2.62723439989],[3.70566068548,3.44032173223,3.2574059854,3.11986367838,3.01307175388,2.92939234605,2.86428726094,2.81483068055,2.77915465405,2.75596888377,2.74456638588],[3.88040469682,3.61463243697,3.4292654707,3.28812274966,3.17689762788,3.08812364257,3.01720732972,2.96140104561,2.91862858495,2.88729479473,2.8674198668,2.8570800015]],f1dB:[[2.16477559371],[2.70320928596,2.41122332505],[3.25676581436,2.88822569572,2.74246238837],[3.76153580353,3.35675411406,3.14862673032,3.05646412475],[4.22174260104,3.79644757806,3.55260471864,3.41193742197,3.34673435508],[4.64584812552,4.20789257981,3.94082363122,3.76942681446,3.66549975744,3.61617359345],[5.04060395196,4.5944592201,4.3111677248,4.11836351827,3.98822359814,3.90713836715,3.86811234525],[5.41107948467,4.95951159709,4.66435804468,4.45575796102,4.30650679478,4.20286750045,4.13720522991,4.10531748119],[5.76110791853,5.30592898465,5.00182215701,4.7811081045,4.61724509926,4.49660100894,4.41131378918,4.35667671372,4.32997951075],[6.09364309488,5.63609116014,5.32506930789,5.09480346139,4.91939504255,4.78540258409,4.68493280536,4.61302286993,4.56661931366,4.54382759952],[6.41100731543,5.95195558182,5.63550073656,5.39754464742,5.21278891332,5.06801430334,4.95539684456,4.8697869429,4.80814951843,4.76793469612,4.74828032403],[6.71506056052,6.25514029778,5.9343616072,5.69011422355,5.49763642361,5.34401973764,5.22125973611,5.12485045619,5.05037962112,4.99699982231,4.96155789635,4.94441828777]]}},h={bessel:{as:[[1.3617],[1.3397,.7743],[1.2217,.9686,.5131],[1.1112,.9754,.7202,.3728],[1.0215,.9393,.7815,.5604,.2883]],bs:[[.618],[.4889,.389],[.3887,.3505,.2756],[.3162,.2979,.2621,.2087],[.265,.2549,.2351,.2059,.1665]]},butterworth:{as:[[1.4142],[1.8478,.7654],[1.9319,1.4142,.5176],[1.9616,1.6629,1.1111,.3902],[1.9754,1.782,1.4142,.908,.3129]],bs:[[1],[1,1],[1,1,1],[1,1,1,1],[1,1,1,1,1]]},tschebyscheff05:{as:[[1.3614],[2.6282,.3648],[3.8645,.7528,.1589],[5.1117,1.0639,.3439,.0885],[6.3648,1.3582,.4822,.1994,.0563]],bs:[[1.3827],[3.4341,1.1509],[6.9797,1.8573,1.0711],[11.9607,2.9365,1.4206,1.0407],[18.3695,4.3453,1.944,1.252,1.0263]]},tschebyscheff1:{as:[[1.3022],[2.5904,.3039],[3.8437,.6292,.1296],[5.1019,.8916,.2806,.0717],[6.3634,1.1399,.3939,.1616,.0455]],bs:[[1.5515],[4.1301,1.1697],[8.5529,1.9124,1.0766],[14.7608,3.0426,1.4334,1.0432],[22.7468,4.5167,1.9665,1.2569,1.0277]]},tschebyscheff2:{as:[[1.1813],[2.4025,.2374],[3.588,.4925,.0995],[4.7743,.6991,.2153,.0547],[5.9618,.8947,.3023,.1233,.0347]],bs:[[1.7775],[4.9862,1.1896],[10.4648,1.9622,1.0826],[18.151,3.1353,1.4449,1.0461],[28.0376,4.6644,1.9858,1.2614,1.0294]]},tschebyscheff3:{as:[[1.065],[2.1853,.1964],[3.2721,.4077,.0815],[4.3583,.5791,.1765,.0448],[5.4449,.7414,.2479,.1008,.0283]],bs:[[1.9305],[5.5339,1.2009],[11.6773,1.9873,1.0861],[20.2948,3.1808,1.4507,1.0478],[31.3788,4.7363,1.9952,1.2638,1.0304]]},allpass:{as:[[1.6278],[2.337,1.3506],[2.6117,2.0706,1.0967],[2.7541,2.4174,1.785,.9239],[2.8406,2.612,2.1733,1.5583,.8018]],bs:[[.8832],[1.4878,1.1837],[1.7763,1.6015,1.2596],[1.942,1.83,1.6101,1.2822],[2.049,1.9714,1.8184,1.5923,1.2877]]}},o=function(f,u){var g=[],v=0;if(u!=="fromPZ")for(f.order>12&&(f.order=12),v=0;v<f.order;v++){var p,I,M;f.transform==="matchedZ"?g.push(a.lowpassMZ({Fs:f.Fs,Fc:f.Fc,preGain:f.preGain,as:h[f.characteristic].as[f.order-1][v],bs:h[f.characteristic].bs[f.order-1][v]})):(f.characteristic==="butterworth"?(p=.5/Math.sin(Math.PI/(2*f.order)*(v+.5)),I=1):(p=s[f.characteristic].q[f.order-1][v],I=f.oneDb?s[f.characteristic].f1dB[f.order-1][v]:s[f.characteristic].f3dB[f.order-1][v]),M=u==="highpass"?f.Fc/I:f.Fc*I,u!=="bandpass"&&u!=="bandstop"||f.characteristic==="bessel"&&(M=Math.sqrt(f.order)*M/f.order),g.push(a[u]({Fs:f.Fs,Fc:M,Q:p,BW:f.BW||0,gain:f.gain||0,preGain:f.preGain||!1})))}else for(v=0;v<f.length;v++)g.push(a[u](f[v]));return g},e=function(f){return function(u){return o(u,f)}},n={},c=function(){var f=[];for(var u in a)n[u]=e(u),f.push(u);return n.available=function(){return f},n};t.exports=c},{"./iirCoeffs":6}],3:[function(r,t,i){"use strict";var d=function(a){if(!function(_){return!(_&_-1)}(a))return!1;var s={};s.length=a,s.buffer=new Float64Array(a),s.re=new Float64Array(a),s.im=new Float64Array(a),s.reI=new Float64Array(a),s.imI=new Float64Array(a),s.twiddle=new Int32Array(a),s.sinTable=new Float64Array(a-1),s.cosTable=new Float64Array(a-1);var h=2*Math.PI,o=Math.floor(Math.log(a)/Math.LN2);for(n=s.sinTable.length;n--;)s.sinTable[n]=Math.sin(h*(n/a)),s.cosTable[n]=Math.cos(h*(n/a));for(var e=a>>1,n=0,c=0;s.twiddle[n]=c,!(++n>=a);){for(o=e;o<=c;)c-=o,o>>=1;c+=o}var f=Math.PI,u=2*Math.PI,g=Math.abs,v=Math.pow,p=Math.cos,I=Math.sin,M=function(_){return I(f*_)/(f*_)},b=Math.E,E={rectangular:{calc:function(){return 1},values:[],correction:1},none:{calc:function(){return 1},values:[],correction:1},hanning:{calc:function(_,m){return .5*(1-p(u*_/(m-1)))},values:[],correction:2},hamming:{calc:function(_,m){return .54-.46*p(u*_/(m-1))},values:[],correction:1.8518999946875638},tukery:{calc:function(_,m,l){return _<l*(m-1)/2?.5*(1+p(f*(2*_/(l*(m-1))-1))):(m-1)*(1-l/2)<_?.5*(1+p(f*(2*_/(l*(m-1))-2/l+1))):1},values:[],correction:4/3},cosine:{calc:function(_,m){return I(f*_/(m-1))},values:[],correction:1.570844266360796},lanczos:{calc:function(_,m){return M(2*_/(m-1)-1)},values:[],correction:1.6964337576195783},triangular:{calc:function(_,m){return 2/(m+1)*((m+1)/2-g(_-(m-1)/2))},values:[],correction:2},bartlett:{calc:function(_,m){return 2/(m-1)*((m-1)/2-g(_-(m-1)/2))},values:[],correction:2},gaussian:{calc:function(_,m,l){return v(b,-.5*v((_-(m-1)/2)/(l*(m-1)/2),2))},values:[],correction:5/3},bartlettHanning:{calc:function(_,m){var l=u*_/(m-1);return .62-.48*g(_/(m-1)-.5)-.38*p(l)},values:[],correction:2},blackman:{calc:function(_,m,l){var x=(1-l)/2,C=l/2,S=u*_/(m-1);return x-.5*p(S)+C*p(2*S)},values:[],correction:4/3},blackmanHarris:{calc:function(_,m){var l=u*_/(m-1);return .35875-.48829*p(l)+.14128*p(2*l)-.01168*p(3*l)},values:[],correction:1.5594508635},nuttall3:{calc:function(_,m){var l=u*_/(m-1);return .375-.5*p(l)+.125*p(2*l)},values:[],correction:1.56},nuttall3a:{calc:function(_,m){var l=u*_/(m-1);return .40897-.5*p(l)+.09103*p(2*l)},values:[],correction:1.692},nuttall3b:{calc:function(_,m){var l=u*_/(m-1);return .4243801-.4973406*p(l)+.078793*p(2*l)},values:[],correction:1.7372527},nuttall4:{calc:function(_,m){var l=u*_/(m-1);return .3125-.46875*p(l)+.1875*p(2*l)-.03125*p(3*l)},values:[],correction:1.454543},nuttall4a:{calc:function(_,m){var l=u*_/(m-1);return .338946-.481973*p(l)+.161054*p(2*l)-.018027*p(3*l)},values:[],correction:1.512732763},nuttall4b:{calc:function(_,m){var l=u*_/(m-1);return .355768-.481973*p(l)+.144232*p(2*l)-.012604*p(3*l)},values:[],correction:1.55223262},nuttall4c:{calc:function(_,m){var l=u*_/(m-1);return .3635819-.4891775*p(l)+.1365995*p(2*l)-.0106411*p(3*l)},values:[],correction:1.57129067},sft3f:{calc:function(_,m){var l=u*_/(m-1);return .26526-.5*p(l)+.23474*p(2*l)},values:[],correction:1.3610238},sft4f:{calc:function(_,m){var l=u*_/(m-1);return .21706-.42103*p(l)+.28294*p(2*l)-.07897*p(3*l)},values:[],correction:1.2773573},sft5f:{calc:function(_,m){var l=u*_/(m-1);return .1881-.36923*p(l)+.28702*p(2*l)-.13077*p(3*l)+.02488*p(4*l)},values:[],correction:1.23167769},sft3m:{calc:function(_,m){var l=u*_/(m-1);return .28235-.52105*p(l)+.19659*p(2*l)},values:[],correction:1.39343451},sft4m:{calc:function(_,m){var l=u*_/(m-1);return .241906-.460841*p(l)+.2552381*p(2*l)-.041872*p(3*l)},values:[],correction:1.3190596},sft5m:{calc:function(_,m){var l=u*_/(m-1);return .209671-.407331*p(l)+.281225*p(2*l)-.092669*p(3*l)+.0091036*p(4*l)},values:[],correction:1.26529456464},nift:{calc:function(_,m){var l=u*_/(m-1);return .2810639-.5208972*p(l)+.1980399*p(2*l)},values:[],correction:1.39094182},hpft:{calc:function(_,m){var l=u*_/(m-1);return(1-1.912510941*p(l)+1.079173272*p(2*l)-.1832630879*p(3*l))/m},values:[],correction:1},srft:{calc:function(_,m){var l=u*_/(m-1);return(1-1.93*p(l)+1.29*p(2*l)-.388*p(3*l)+.028*p(4*l))/m},values:[],correction:1},hft70:{calc:function(_,m){var l=u*_/(m-1);return(1-1.90796*p(l)+1.07349*p(2*l)-.18199*p(3*l))/m},values:[],correction:1},hft95:{calc:function(_,m){var l=u*_/(m-1);return(1-1.9383379*p(l)+1.3045202*p(2*l)-.402827*p(3*l)+.0350665*p(4*l))/m},values:[],correction:1},hft90d:{calc:function(_,m){var l=u*_/(m-1);return(1-1.942604*p(l)+1.340318*p(2*l)-.440811*p(3*l)+.043097*p(4*l))/m},values:[],correction:1},hft116d:{calc:function(_,m){var l=u*_/(m-1);return(1-1.9575375*p(l)+1.4780705*p(2*l)-.6367431*p(3*l)+.1228389*p(4*l)-.0066288*p(5*l))/m},values:[],correction:1},hft144d:{calc:function(_,m){var l=u*_/(m-1);return(1-1.96760033*p(l)+1.57983607*p(2*l)-.81123644*p(3*l)+.22583558*p(4*l)-.02773848*p(5*l)+9036e-7*p(6*l))/m},values:[],correction:1},hft196d:{calc:function(_,m){var l=u*_/(m-1);return(1-1.97441842*p(l)+1.65409888*p(2*l)-.95788186*p(3*l)+.3367342*p(4*l)-.06364621*p(5*l)+.00521942*p(6*l)-10599e-8*p(7*l))/m},values:[],correction:1},hft223d:{calc:function(_,m){var l=u*_/(m-1);return(1-1.98298997309*p(l)+1.75556083063*p(2*l)-1.19037717712*p(3*l)+.56155440797*p(4*l)-.17296769663*p(5*l)+.03233247087*p(6*l)-.00324954578*p(7*l)+.0001380104*p(8*l)-132725e-11*p(9*l))/m},values:[],correction:1},hft248d:{calc:function(_,m){var l=u*_/(m-1);return(1-1.985844164102*p(l)+1.791176438506*p(2*l)-1.282075284005*p(3*l)+.667777530266*p(4*l)-.240160796576*p(5*l)+.056656381764*p(6*l)-.008134974479*p(7*l)+.00062454465*p(8*l)-19808998e-12*p(9*l)+132974e-12*p(10*l))/m},values:[],correction:1}},R=function(_){return E[_.name].values.length!==_.N?(_.n===0&&(E[_.name].values.length=0),E[_.name].values[_.n]=E[_.name].correction*E[_.name].calc(_.n,_.N,_.a),E[_.name].values[_.n]):E[_.name].values};return{forward:function(_,m){var l,x,C,S,A,w,D,F,P,L,N,V;C=s.buffer.length;var K={name:m,N:C,a:.5,n:0},ae=R(K);if(typeof ae=="number")for(l=0;l<C;++l)K.n=l,s.buffer[l]=_[l]*R(K);else for(l=0;l<C;++l)s.buffer[l]=_[l]*ae[l];for(l=C;l--;)s.re[l]=s.buffer[s.twiddle[l]],s.im[l]=0;for(S=1;S<C;S=A)for(w=0,A=S+S,D=C/A,x=0;x<S;x++){for(F=s.cosTable[w],P=s.sinTable[w],l=x;l<C;l+=A)L=l+S,N=P*s.im[L]+F*s.re[L],V=F*s.im[L]-P*s.re[L],s.re[L]=s.re[l]-N,s.re[l]+=N,s.im[L]=s.im[l]-V,s.im[l]+=V;w+=D}return{re:s.re,im:s.im}},inverse:function(_,m){var l,x,C,S,A,w,D,F,P,L,N,V;for(C=_.length,l=C;l--;)x=s.twiddle[l],s.reI[l]=_[x],s.imI[l]=-m[x];for(S=1;S<C;S=A)for(w=0,A=S+S,D=C/A,x=0;x<S;x++){for(F=s.cosTable[w],P=s.sinTable[w],l=x;l<C;l+=A)L=l+S,N=P*s.imI[L]+F*s.reI[L],V=F*s.imI[L]-P*s.reI[L],s.reI[L]=s.reI[l]-N,s.reI[l]+=N,s.imI[L]=s.imI[l]-V,s.imI[l]+=V;w+=D}for(l=C;l--;)s.buffer[l]=s.reI[l]/C;return s.buffer},magnitude:function(_){for(var m=[],l=0;l<_.re.length;l++)m.push(Math.sqrt(_.re[l]*_.re[l]+_.im[l]*_.im[l]));return m},magToDb:function(_){for(var m=[],l=0;l<_.length;l++)m.push(20*Math.log(_[l])*Math.LOG10E);return m},phase:function(_){for(var m=[],l=0;l<_.re.length;l++)m.push(Math.atan2(_.im[l],_.re[l]));return m},windows:function(){var _=[];for(var m in E)_.push(m);return _}}};t.exports=d},{}],4:[function(r,t,i){"use strict";var d=function(){var a=function(e){var n=e.Fs,c=e.Fa,f=e.Fb,u=e.order||51,g=e.Att||100,v=function(_){for(var m=0,l=1,x=1;l>1e-6*x;)m+=2,l*=_*_/(m*m),x+=l;return x};u/2-Math.floor(u/2)==0&&u++;var p,I=(u-1)/2,M=[],b=0,E=0,R=[];for(M[0]=2*(f-c)/n,E=1;E<=I;E++)M[E]=(Math.sin(2*E*Math.PI*f/n)-Math.sin(2*E*Math.PI*c/n))/(E*Math.PI);for(b=g<21?0:g>50?.1102*(g-8.7):.5842*Math.pow(g-21,.4)+.07886*(g-21),p=v(b),E=0;E<=I;E++)R[I+E]=M[E]*v(b*Math.sqrt(1-E*E/(I*I)))/p;for(E=0;E<I;E++)R[E]=R[u-1-E];return R},s=function(e){var n=e.Fs,c=e.Fc,f=e.order,u=2*Math.PI*c/n,g=0,v=0,p=[];for(g=0;g<=f;g++)g-f/2==0?p[g]=u:(p[g]=Math.sin(u*(g-f/2))/(g-f/2),p[g]*=.54-.46*Math.cos(2*Math.PI*g/f)),v+=p[g];for(g=0;g<=f;g++)p[g]/=v;return p},h=function(e){var n;for(n=0;n<e.length;n++)e[n]=-e[n];return e[(e.length-1)/2]++,e},o=function(e){for(var n=s({order:e.order,Fs:e.Fs,Fc:e.F2}),c=h(s({order:e.order,Fs:e.Fs,Fc:e.F1})),f=[],u=0;u<n.length;u++)f.push(n[u]+c[u]);return f};return{lowpass:function(e){return s(e)},highpass:function(e){return h(s(e))},bandstop:function(e){return o(e)},bandpass:function(e){return h(o(e))},kbFilter:function(e){return a(e)},available:function(){return["lowpass","highpass","bandstop","bandpass","kbFilter"]}}};t.exports=d},{}],5:[function(r,t,i){"use strict";var d=r("./utils"),a=d.runMultiFilter,s=d.runMultiFilterReverse,h=d.complex,o=d.evaluatePhase,e=function(n){var c=n,f=[],u=0;for(u=0;u<c.length;u++)f[u]={re:c[u],im:0};var g=function(b){var E,R=[];for(E=0;E<b;E++)R.push(0);return{buf:R,pointer:0}},v=g(c.length-1),p=function(b,E){E.buf[E.pointer]=b;var R=0;for(u=0;u<E.buf.length;u++)R+=c[u]*E.buf[(E.pointer+u)%E.buf.length];return E.pointer=(E.pointer+1)%E.buf.length,R},I=function(b){var E=g(c.length-1);return a(b,E,p)},M=function(b){for(var E=b.Fs,R=b.Fr,_=-Math.PI*(R/E)*2,m={re:0,im:0},l=0;l<c.length-1;l++)m=h.add(m,h.mul(f[l],{re:Math.cos(_*l),im:Math.sin(_*l)}));var x=h.magnitude(m);return{magnitude:x,phase:h.phase(m),dBmagnitude:20*Math.log(x)*Math.LOG10E}};return{responsePoint:function(b){return M(b)},response:function(b){b=b||100;var E=[],R=0,_=2*b;for(R=0;R<b;R++)E[R]=M({Fs:_,Fr:R});return o(E),E},simulate:function(b){return I(b)},singleStep:function(b){return p(b,v)},multiStep:function(b,E){return a(b,v,p,E)},filtfilt:function(b,E){return s(a(b,v,p,E),v,p,!0)},reinit:function(){v=g(c.length-1)}}};t.exports=e},{"./utils":9}],6:[function(r,t,i){"use strict";var d=function(){var a=function(o,e){var n=o.Q,c=o.Fc,f=o.Fs,u={},g=2*Math.PI*c/f;return o.BW?u.alpha=Math.sin(g)*Math.sinh(Math.log(2)/2*o.BW*g/Math.sin(g)):u.alpha=Math.sin(g)/(2*n),u.cw=Math.cos(g),u.a0=1+u.alpha,e.a0=u.a0,e.a.push(-2*u.cw/u.a0),e.k=1,e.a.push((1-u.alpha)/u.a0),u},s=function(o){var e=o.Q,n=o.Fc,c=o.Fs,f={},u=2*Math.PI*n/c;return f.alpha=Math.sin(u)/(2*e),f.cw=Math.cos(u),f.A=Math.pow(10,o.gain/40),f},h=function(){var o={};return o.z=[0,0],o.a=[],o.b=[],o};return{fromPZ:function(o){var e=h();return e.a0=1,e.b.push(1),e.b.push(-o.z0.re-o.z1.re),e.b.push(o.z0.re*o.z1.re-o.z0.im*o.z1.im),e.a.push(-o.p0.re-o.p1.re),e.a.push(o.p0.re*o.p1.re-o.p0.im*o.p1.im),o.type==="lowpass"?e.k=(1+e.a[0]+e.a[1])/(1+e.b[1]+e.b[2]):e.k=(1-e.a[0]+e.a[1])/(1-e.b[1]+e.b[2]),e},lowpassMZ:function(o){var e=h();e.a0=1;var n=o.as,c=o.bs,f=2*Math.PI*o.Fc/o.Fs,u=-n/(2*c);return e.a.push(2*-Math.pow(Math.E,u*f)*Math.cos(-f*Math.sqrt(Math.abs(Math.pow(n,2)/(4*Math.pow(c,2))-1/c)))),e.a.push(Math.pow(Math.E,2*u*f)),o.preGain?(e.b.push(1),e.k=e.a0+e.a[0]+e.a[1]):(e.b.push(e.a0+e.a[0]+e.a[1]),e.k=1),e.b.push(0),e.b.push(0),e},lowpassBT:function(o){var e=h();return o.Q=1,e.wp=Math.tan(2*Math.PI*o.Fc/(2*o.Fs)),e.wp2=e.wp*e.wp,o.BW&&delete o.BW,e.k=1,e.a0=3*e.wp+3*e.wp2+1,e.b.push(3*e.wp2*o.Q/e.a0),e.b.push(2*e.b[0]),e.b.push(e.b[0]),e.a.push((6*e.wp2-2)/e.a0),e.a.push((3*e.wp2-3*e.wp+1)/e.a0),e},highpassBT:function(o){var e=h();return o.Q=1,e.wp=Math.tan(2*Math.PI*o.Fc/(2*o.Fs)),e.wp2=e.wp*e.wp,o.BW&&delete o.BW,e.k=1,e.a0=e.wp+e.wp2+3,e.b.push(3*o.Q/e.a0),e.b.push(2*e.b[0]),e.b.push(e.b[0]),e.a.push((2*e.wp2-6)/e.a0),e.a.push((e.wp2-e.wp+3)/e.a0),e},lowpass:function(o){var e=h();o.BW&&delete o.BW;var n=a(o,e);return o.preGain?(e.k=.5*(1-n.cw),e.b.push(1/n.a0)):(e.k=1,e.b.push((1-n.cw)/(2*n.a0))),e.b.push(2*e.b[0]),e.b.push(e.b[0]),e},highpass:function(o){var e=h();o.BW&&delete o.BW;var n=a(o,e);return o.preGain?(e.k=.5*(1+n.cw),e.b.push(1/n.a0)):(e.k=1,e.b.push((1+n.cw)/(2*n.a0))),e.b.push(-2*e.b[0]),e.b.push(e.b[0]),e},allpass:function(o){var e=h();o.BW&&delete o.BW;var n=a(o,e);return e.k=1,e.b.push((1-n.alpha)/n.a0),e.b.push(-2*n.cw/n.a0),e.b.push((1+n.alpha)/n.a0),e},bandpassQ:function(o){var e=h(),n=a(o,e);return e.k=1,e.b.push(n.alpha*o.Q/n.a0),e.b.push(0),e.b.push(-e.b[0]),e},bandpass:function(o){var e=h(),n=a(o,e);return e.k=1,e.b.push(n.alpha/n.a0),e.b.push(0),e.b.push(-e.b[0]),e},bandstop:function(o){var e=h(),n=a(o,e);return e.k=1,e.b.push(1/n.a0),e.b.push(-2*n.cw/n.a0),e.b.push(e.b[0]),e},peak:function(o){var e=h(),n=s(o);return e.k=1,e.a0=1+n.alpha/n.A,e.a.push(-2*n.cw/e.a0),e.a.push((1-n.alpha/n.A)/e.a0),e.b.push((1+n.alpha*n.A)/e.a0),e.b.push(-2*n.cw/e.a0),e.b.push((1-n.alpha*n.A)/e.a0),e},lowshelf:function(o){var e=h();o.BW&&delete o.BW;var n=s(o);e.k=1;var c=2*Math.sqrt(n.A)*n.alpha;return e.a0=n.A+1+(n.A-1)*n.cw+c,e.a.push(-2*(n.A-1+(n.A+1)*n.cw)/e.a0),e.a.push((n.A+1+(n.A-1)*n.cw-c)/e.a0),e.b.push(n.A*(n.A+1-(n.A-1)*n.cw+c)/e.a0),e.b.push(2*n.A*(n.A-1-(n.A+1)*n.cw)/e.a0),e.b.push(n.A*(n.A+1-(n.A-1)*n.cw-c)/e.a0),e},highshelf:function(o){var e=h();o.BW&&delete o.BW;var n=s(o);e.k=1;var c=2*Math.sqrt(n.A)*n.alpha;return e.a0=n.A+1-(n.A-1)*n.cw+c,e.a.push(2*(n.A-1-(n.A+1)*n.cw)/e.a0),e.a.push((n.A+1-(n.A-1)*n.cw-c)/e.a0),e.b.push(n.A*(n.A+1+(n.A-1)*n.cw+c)/e.a0),e.b.push(-2*n.A*(n.A-1+(n.A+1)*n.cw)/e.a0),e.b.push(n.A*(n.A+1+(n.A-1)*n.cw-c)/e.a0),e},aweighting:function(o){var e=h();e.k=1;var n=2*Math.PI*o.Fc/o.Fs,c=2*Math.tan(n/2),f=o.Q,u=Math.pow(c,2);return e.a0=4*f+u*f+2*c,e.a.push(2*u*f-8*f),e.a.push(4*f+u*f-2*c),e.b.push(u*f),e.b.push(2*u*f),e.b.push(u*f),e}}};t.exports=d},{}],7:[function(r,t,i){"use strict";var d=r("./utils"),a=d.complex,s=d.runMultiFilter,h=d.runMultiFilterReverse,o=d.evaluatePhase,e=function(n){for(var c=n,f={re:1,im:0},u=[],g=[],v=0;v<c.length;v++){u[v]={};var p=c[v];u[v].b0={re:p.b[0],im:0},u[v].b1={re:p.b[1],im:0},u[v].b2={re:p.b[2],im:0},u[v].a1={re:p.a[0],im:0},u[v].a2={re:p.a[1],im:0},u[v].k={re:p.k,im:0},u[v].z=[0,0],g[v]={},g[v].b1=p.b[1]/p.b[0],g[v].b2=p.b[2]/p.b[0],g[v].a1=p.a[0],g[v].a2=p.a[1]}var I=function(C,S){var A=S*C.k.re-C.a1.re*C.z[0]-C.a2.re*C.z[1],w=C.b0.re*A+C.b1.re*C.z[0]+C.b2.re*C.z[1];return C.z[1]=C.z[0],C.z[0]=A,w},M=function(C,S){var A=C,w=0;for(w=0;w<S.length;w++)A=I(S[w],A);return A},b=function(C,S){var A=C.Fs,w=C.Fr,D=-Math.PI*(w/A)*2,F={re:Math.cos(D),im:Math.sin(D)},P=a.mul(S.k,a.add(S.b0,a.mul(F,a.add(S.b1,a.mul(S.b2,F))))),L=a.add(f,a.mul(F,a.add(S.a1,a.mul(S.a2,F)))),N=a.div(P,L);return{magnitude:a.magnitude(N),phase:a.phase(N)}},E=function(C){var S=0,A={magnitude:1,phase:0};for(S=0;S<u.length;S++){var w=b(C,u[S]);A.magnitude*=w.magnitude,A.phase+=w.phase}return A.dBmagnitude=20*Math.log(A.magnitude)*Math.LOG10E,A},R=function(){for(var C=[],S=0;S<c.length;S++)C[S]={b0:{re:p.b[0],im:0},b1:{re:p.b[1],im:0},b2:{re:p.b[2],im:0},a1:{re:p.a[0],im:0},a2:{re:p.a[1],im:0},k:{re:p.k,im:0},z:[0,0]};return C},_=function(C){var S=R();return s(C,S,M)},m=function(C,S){var A={},w=[],D=0;for(D=0;D<S;D++)w.push(C(D));A.out=_(w);var F=!1,P=!1;for(D=0;D<S-1;D++)if(A.out[D]>A.out[D+1]&&!F&&(F=!0,A.max={sample:D,value:A.out[D]}),F&&!P&&A.out[D]<A.out[D+1]){P=!0,A.min={sample:D,value:A.out[D]};break}return A},l=function(C,S){var A=Math.pow(C/2,2)-S;return A<0?[{re:-C/2,im:Math.sqrt(Math.abs(A))},{re:-C/2,im:-Math.sqrt(Math.abs(A))}]:[{re:-C/2+Math.sqrt(A),im:0},{re:-C/2-Math.sqrt(A),im:0}]},x=function(){for(var C=[],S=0;S<g.length;S++)C[S]={},C[S].z=l(g[S].b1,g[S].b2),C[S].p=l(g[S].a1,g[S].a2);return C};return{singleStep:function(C){return M(C,u)},multiStep:function(C,S){return s(C,u,M,S)},filtfilt:function(C,S){return h(s(C,u,M,S),u,M,!0)},simulate:function(C){return _(C)},stepResponse:function(C){return m(function(){return 1},C)},impulseResponse:function(C){return m(function(S){return S===0?1:0},C)},responsePoint:function(C){return E(C)},response:function(C){C=C||100;var S=[],A=0,w=2*C;for(A=0;A<C;A++)S[A]=E({Fs:w,Fr:A});return o(S),S},polesZeros:function(){return x()},reinit:function(){for(v=0;v<u.length;v++)u[v].z=[0,0]}}};t.exports=e},{"./utils":9}],8:[function(r,t,i){"use strict";var d=function(a){var s,h=a,o=[],e=function(u){for(s=0;s<u.steps;s++)o.push(h.singleStep((Math.random()-.5)*u.pp+u.offset))},n=function(u){var g=u.offset+u.pp,v=u.offset-u.pp;for(s=0;s<u.steps;s++)s%200<100?o.push(h.singleStep(g)):o.push(h.singleStep(v))},c=function(u){var g=u.offset+u.pp,v=u.offset-u.pp;for(s=0;s<u.steps;s++)s%100==0?o.push(h.singleStep(g)):o.push(h.singleStep(v))},f=function(u){var g=u.offset+u.pp,v=u.offset-u.pp,p=v,I=(g-v)/100;for(s=0;s<u.steps;s++)s%200<100?p+=I:p-=I,o.push(h.singleStep(p))};return{randomStability:function(u){for(h.reinit(),o.length=0,e(u),s=u.setup;s<o.length;s++)if(o[s]>u.maxStable||o[s]<u.minStable)return o[s];return!0},directedRandomStability:function(u){h.reinit(),o.length=0;var g;for(g=0;g<u.tests;g++){var v=Math.random();v<.25?e(u):v<.5?n(u):v<.75?c(u):f(u)}for(e(u),s=u.setup;s<o.length;s++)if(o[s]>u.maxStable||o[s]<u.minStable)return o[s];return!0},evaluateBehavior:function(){}}};t.exports=d},{}],9:[function(r,t,i){"use strict";i.evaluatePhase=function(o){var e=0,n=0,c=Math.PI,f=2*c,u=[];for(n=0;n<o.length;n++)u.push(o[n].phase);for(o[0].unwrappedPhase=o[0].phase,o[0].groupDelay=0,n=1;n<u.length;n++){var g=u[n]-u[n-1];if(g>c)for(e=n;e<u.length;e++)u[e]-=f;else if(g<-c)for(e=n;e<u.length;e++)u[e]+=f;u[n]<0?o[n].unwrappedPhase=-u[n]:o[n].unwrappedPhase=u[n],o[n].phaseDelay=o[n].unwrappedPhase/(n/o.length),o[n].groupDelay=(o[n].unwrappedPhase-o[n-1].unwrappedPhase)/(c/o.length),o[n].groupDelay<0&&(o[n].groupDelay=-o[n].groupDelay)}o[0].magnitude!==0?(o[0].phaseDelay=o[1].phaseDelay,o[0].groupDelay=o[1].groupDelay):(o[0].phaseDelay=o[2].phaseDelay,o[0].groupDelay=o[2].groupDelay,o[1].phaseDelay=o[2].phaseDelay,o[1].groupDelay=o[2].groupDelay)},i.runMultiFilter=function(o,e,n,c){var f=[];c&&(f=o);var u;for(u=0;u<o.length;u++)f[u]=n(o[u],e);return f},i.runMultiFilterReverse=function(o,e,n,c){var f=[];c&&(f=o);var u;for(u=o.length-1;u>=0;u--)f[u]=n(o[u],e);return f};var d=function(o,e){for(var n=!0;n;){var c=o,f=e;if(n=!1,f||(f=1),c!==Math.floor(c)||f!==Math.floor(f))return 1;if(c===0||c===1)return f;o=c-1,e=f*c,n=!0}};i.besselFactors=function(o){for(var e=[],n=0;n<o+1;n++){var c=d(2*o-n),f=Math.pow(2,o-n)*d(n)*d(o-n);e.unshift(Math.floor(c/f))}return e};var a=function(o,e){for(var n=0,c=0;c<e;c++){var f=1/Math.pow(2,c+1);o>f&&(o-=f,n+=f)}return n},s=function(o,e){return o&Math.pow(2,e)},h=function(o,e,n){var c=Math.abs(o),f=o-c;return{number:s(c,e).toString(),fraction:a(f,n).toString(),numberBits:e,fractionBits:n}};i.fixedPoint={convert:function(o,e,n){return h(o,e,n)},add:function(o,e){},sub:function(o,e){},mul:function(o,e){},div:function(o,e){}},i.complex={div:function(o,e){var n=o.re,c=o.im,f=e.re,u=e.im,g=f*f+u*u;return{re:(n*f+c*u)/g,im:(c*f-n*u)/g}},mul:function(o,e){var n=o.re,c=o.im,f=e.re,u=e.im;return{re:n*f-c*u,im:(n+c)*(f+u)-n*f-c*u}},add:function(o,e){return{re:o.re+e.re,im:o.im+e.im}},sub:function(o,e){return{re:o.re-e.re,im:o.im-e.im}},phase:function(o){return Math.atan2(o.im,o.re)},magnitude:function(o){return Math.sqrt(o.re*o.re+o.im*o.im)}}},{}]},{},[1])(1)})});var y=$e(qe(),1);var At=$e(qe(),1),we="#ebebebcc",Me="#5f5f5fcc",oe="14px Arial";function bt(r){return parseFloat(r.split("px")[0])}var Re=class{timeseries;tsPresOpts;text;x=0;y=0;fillStyle;textBaseline="top";textAlign="start";font=oe;on=!0;on_fillStyle;off_fillStyle=Me;width=void 0;height=void 0;constructor(t,i,d,a="start",s=0,h=0,o=!0,e="top",n=oe,c=void 0,f=void 0){this.timeseries=t,this.tsPresOpts=i,this.text=d,this.textAlign=a,this.x=s,this.y=h,this.on=o,this.fillStyle=i?.strokeStyle||(o?we:Me),this.textBaseline=e,this.font=n,c!==void 0?this.on_fillStyle=c:this.on&&(this.on_fillStyle=this.fillStyle),f!==void 0?this.off_fillStyle=f:this.on||(this.off_fillStyle=this.fillStyle),this.enable(o)}getHeight(){return this.height=bt(this.font),this.height}getWidth(t){let i=t.getContext("2d");return i&&(i.save(),i.textBaseline=this.textBaseline,i.textAlign=this.textAlign,i.font=this.font,i.fillStyle=this.fillStyle,this.width=i.measureText(this.text).width,i.restore()),this.width}enable(t=!0){this.on=t,this.fillStyle=this.on?this.on_fillStyle:this.off_fillStyle}onclick(){this.on=!this.on,this.enable(this.on)}};function Et(r,t,i,d,a,s){return r>i&&r<i+d&&t>a&&t<a+s}var le=class extends At.SmoothieChart{smoothieTSInfos;isRow=!0;enableRenderLegend=!0;allowToggleTooltip=!0;allowToggleLegend=!0;allowToggleLabelAuto=!0;ctrlFont=oe;ctrlFontHeight=0;enableTooltipText="[Tooltip]";enableTooltipTextX=0;enableTooltipTextY=0;enableTooltipTextWidth=0;yAutoScaleText="[Auto Y scale]";yAutoScaleTextX=0;yAutoScaleTextY=0;yAutoScaleTextWidth=0;defaultXSpacing=10;defaultYSpacing=0;renderOffset=0;prevMinValue=void 0;prevMaxValue=void 0;scrollable=!1;constructor(t,i=!0,d=!0,a=!0,s=!0,h=!0,o=oe,e=10,n=0,c=!1){super(t),this.smoothieTSInfos=[],this.isRow=i,this.enableRenderLegend=d,this.allowToggleTooltip=a,this.allowToggleLegend=s,this.allowToggleLabelAuto=h,this.ctrlFont=o,this.defaultXSpacing=e,this.defaultYSpacing=n,this.ctrlFontHeight=bt(this.ctrlFont),this.scrollable=c}canvasOnClick=t=>{if(this.allowToggleLegend&&"canvas"in this){let i=this.canvas;this.allowToggleTooltip&&this.options.tooltip!==void 0&&Et(t.offsetX,t.offsetY,this.enableTooltipTextX,this.enableTooltipTextWidth,this.enableTooltipTextY,this.ctrlFontHeight)&&(this.options.tooltip?(this.options.tooltip=!1,"tooltipEl"in this&&(this.tooltipEl.style.display="none")):this.options.tooltip=!0),this.allowToggleLabelAuto&&Et(t.offsetX,t.offsetY,this.yAutoScaleTextX,this.yAutoScaleTextWidth,this.yAutoScaleTextY,this.ctrlFontHeight)&&(this.yScaleIsAuto()?(this.options.minValue=this.prevMinValue||this?.valueRange?.min||20,this.options.maxValue=this.prevMaxValue||this?.valueRange?.max||-20,this.updateValueRange(),this.showScrollMessage()):(this.prevMinValue=this.options.minValue,this.prevMaxValue=this.options.maxValue,this.options.minValue=void 0,this.options.maxValue=void 0,this.updateValueRange()));for(let d=0;d<this.smoothieTSInfos.length;d++){let a=this.smoothieTSInfos[d],s=a.width||a.getWidth(i)||0,h=a.height||a.getHeight()||0;s>0&&h>0&&t.offsetX-this.renderOffset>a.x&&t.offsetX-this.renderOffset<a.x+s&&t.offsetY>a.y&&t.offsetY<a.y+h&&(a.onclick(),a.on?a.timeseries!==void 0&&this.addTimeSeries(a.timeseries,a.tsPresOpts):a.timeseries!==void 0&&this.removeTimeSeries(a.timeseries))}}};yScaleIsAuto(){return this.options.minValue===void 0||this.options.maxValue===void 0}streamTo(t,i){if(super.streamTo(t,i),"canvas"in this){let d=this.canvas;d.removeEventListener("click",this.canvasOnClick),d.addEventListener("click",this.canvasOnClick)}}render(t,i){if(super.render(t,i),this.enableRenderLegend&&this.smoothieTSInfos.length){let d=this.lastRenderTimeMillis;Date.now()-d<3&&this.renderLegend(t)}}renderLegend(t){let i=t.getContext("2d");if(i){i.save();let d=this.smoothieTSInfos,a=this.defaultXSpacing;this.allowToggleTooltip&&(i.textBaseline="top",i.textAlign="start",i.font=this.ctrlFont,i.fillStyle=this.options.tooltip?we:Me,i.fillText(this.enableTooltipText,a,this.defaultYSpacing),this.enableTooltipTextX=a,this.enableTooltipTextY=this.defaultYSpacing,this.enableTooltipTextWidth=i.measureText(this.enableTooltipText).width,a+=this.enableTooltipTextWidth+this.defaultXSpacing),this.allowToggleLabelAuto&&(i.textBaseline="top",i.textAlign="start",i.font=this.ctrlFont,i.fillStyle=we,i.fillStyle=this.yScaleIsAuto()?we:Me,i.fillText(this.yAutoScaleText,a,this.defaultYSpacing),this.yAutoScaleTextX=a,this.yAutoScaleTextY=this.defaultYSpacing,this.yAutoScaleTextWidth=i.measureText(this.yAutoScaleText).width,a+=this.yAutoScaleTextWidth+this.defaultXSpacing),this.renderOffset=a;let s=0;for(let h=0;h<d.length;h++){if(h>0){if(this.isRow&&d[h].x===d[0].x)d[h].x=d[h-1].x+s+this.defaultXSpacing;else if(!this.isRow&&d[h].y===d[0].y){let e=parseFloat(d[h].font.split("px")[0]);d[h].y=d[h-1].y+e+2}}let o=d[h];i.textBaseline=o.textBaseline,i.textAlign=o.textAlign,i.font=o.font,i.fillStyle=o.fillStyle,o.timeseries===void 0&&o.tsPresOpts===void 0?i.fillText(o.text,o.x,o.y):i.fillText(o.text,a+o.x,o.y),s=i.measureText(o.text).width}i.restore()}}addSmoothieTSInfo(t){this.smoothieTSInfos.indexOf(t)<0&&(this.smoothieTSInfos.push(t),t.timeseries!==void 0&&t.tsPresOpts!==void 0&&this.addTimeSeries(t.timeseries,t.tsPresOpts))}removeLegendTSInfo(t){let i=this.smoothieTSInfos.indexOf(t);return i>-1?(t.timeseries!==void 0&&this.removeTimeSeries(t.timeseries),this.smoothieTSInfos.splice(i,1)):[]}clearLegendTSInfos(){for(let t=0;t<this.smoothieTSInfos.length;t++){let i=this.smoothieTSInfos[t];i.timeseries!==void 0&&this.removeTimeSeries(i.timeseries)}this.smoothieTSInfos=[]}configureTimeSeries(t,i,d,a=!1,s=void 0,h=void 0,o=1,e=1,n="",c=!1,f=[],u=!0,g=!1,v=!0){this.clearLegendTSInfos();for(let p=0;p<t.length;p++){let I=new Re(t[p],i[p],d[p].legend,d[p].textAlign,d[p].x,d[p].y,!0,d[p].textBaseline,d[p].font);this.addSmoothieTSInfo(I)}this.scrollable=a,this.showScrollMessage(),this.options.minValue=s,this.options.maxValue=h,this.options.minValueScale=o,this.options.maxValueScale=e,this.updateValueRange(),n.length>0&&this.options.title!==void 0&&(this.options.title.text=n),this.options.labels!==void 0&&(this.options.labels.disabled=c),this.options.horizontalLines=f,this.allowToggleLegend=u,this.allowToggleLabelAuto=g,this.allowToggleTooltip=v}showScrollMessage(){if(this.scrollable&&"canvas"in this){let t=this.canvas,i=new Re(void 0,void 0,"Scroll to change y-range","center",t.width/window.devicePixelRatio/2,30,!0,"top","16px Arial","#fbfbfb");this.addSmoothieTSInfo(i),setTimeout(()=>{this.removeLegendTSInfo(i)},1500)}}};function G(r,t=10,i=5,d="top",a="start",s=oe){return{legend:r,x:t,y:i,textBaseline:d,textAlign:a,font:s}}var B=$e(It(),1);var Gi="fb005c80-02e7-f387-1cad-8acd2d8df0c8",yi="fb005c81-02e7-f387-1cad-8acd2d8df0c8",Pi="fb005c82-02e7-f387-1cad-8acd2d8df0c8",je=(r=>(r[r.SAMPLE_RATE=0]="SAMPLE_RATE",r[r.RESOLUTION=1]="RESOLUTION",r[r.RANGE_PN_UNIT=2]="RANGE_PN_UNIT",r[r.RANGE_MILI_UNIT=3]="RANGE_MILI_UNIT",r[r.NUM_CHANNELS=4]="NUM_CHANNELS",r[r.CONVERSION_FACTOR=5]="CONVERSION_FACTOR",r))(je||{});function Qe(r,t,i=!0){return r.getUint16(t,i)}function Ni(r,t,i=!0){return r.getFloat32(t,i)}function Oi(r,t,i=!0){return[r.getUint16(t,i),r.getUint16(t+2,i),r.getUint16(t+4,i),r.getUint16(t+6,i)]}var Hi={SAMPLE_RATE:Qe,RESOLUTION:Qe,RANGE_PN_UNIT:Qe,RANGE_MILI_UNIT:Oi,CONVERSION_FACTOR:Ni},Bi={SAMPLE_RATE:2,RESOLUTION:2,RANGE_PN_UNIT:2,RANGE_MILI_UNIT:8,NUM_CHANNELS:1,CONVERSION_FACTOR:4},Ke=(r=>(r[r.GET_MEASUREMENT_SETTINGS=1]="GET_MEASUREMENT_SETTINGS",r[r.REQUEST_MEASUREMENT_START=2]="REQUEST_MEASUREMENT_START",r[r.REQUEST_MEASUREMENT_STOP=3]="REQUEST_MEASUREMENT_STOP",r))(Ke||{}),ee=["SUCCESS","INVALID OP CODE","INVALID MEASUREMENT TYPE","NOT SUPPORTED","INVALID LENGTH","INVALID PARAMETER","ALREADY IN STATE","INVALID RESOLUTION","INVALID SAMPLE RATE","INVALID RANGE","INVALID MTU","INVALID NUMBER OF CHANNELS","INVALID STATE","DEVICE IN CHARGER"],z=(r=>(r[r.ECG=0]="ECG",r[r.PPG=1]="PPG",r[r.ACC=2]="ACC",r[r.PPI=3]="PPI",r[r.GYRO=5]="GYRO",r[r.MAGNETOMETER=6]="MAGNETOMETER",r[r.SDK_MODE=9]="SDK_MODE",r[r.LOCATION=10]="LOCATION",r[r.PRESSURE=11]="PRESSURE",r[r.TEMPERATURE=12]="TEMPERATURE",r))(z||{}),an=Object.keys(je).filter(r=>isNaN(Number(r))),xe=Object.keys(z).filter(r=>isNaN(Number(r))),rn=Object.keys(Ke).filter(r=>isNaN(Number(r))),wt=class{device;server=void 0;PMDService=void 0;PMDCtrlChar=void 0;PMDDataChar=void 0;BattService=void 0;BattLvlChar=void 0;streaming=!1;verbose=!0;dataHandle={};timeOffset=BigInt(0);eventTimeOffset;lastECGTimestamp;lastACCTimestamp;ACCStarted=!1;ECGStarted=!1;constructor(r,t=!0){this.device=r,this.verbose=t,this.lastECGTimestamp=0,this.lastACCTimestamp=0,this.ACCStarted=!1,this.ECGStarted=!1;for(let i=0;i<xe.length;i++)this.dataHandle[xe[i]]=[]}addEventListener(r,t){this.dataHandle[r].includes(t)||this.dataHandle[r].push(t)}removeEventListener(r,t){let i=this.dataHandle[r].indexOf(t);return i>-1&&this.dataHandle[r].splice(i,1),i}clearEventListner(r){delete this.dataHandle[r],this.dataHandle[r]=[]}log(...r){this.verbose&&console.log(...r)}async init(){this.server=await this.device.gatt?.connect(),this.log(`Connecting to ${this.device.name} GATT server...`),this.PMDService=await this.server?.getPrimaryService(Gi),this.log("  Got PMD Service"),this.PMDCtrlChar=await this.PMDService?.getCharacteristic(yi),this.log("    Got PMD control characteristic"),await this.PMDCtrlChar?.startNotifications(),this.log("    Start notification"),this.PMDDataChar=await this.PMDService?.getCharacteristic(Pi),this.log("    Got PMD data characteristic"),await this.PMDDataChar?.startNotifications(),this.log("    Start notification"),this.streaming=!1,this.BattService=await this.server?.getPrimaryService("battery_service"),this.log("  Got battery Service"),this.BattLvlChar=await this.BattService?.getCharacteristic("battery_level"),this.log("    Got battery level characteristic"),this.PMDDataChar?.addEventListener("characteristicvaluechanged",this.PMDDataHandle.bind(this))}PMDCtrlCharHandle(r){this.log(r)}PMDCtrlDataHandle(r){this.log(r)}async getBatteryLevel(){let r=await this.BattLvlChar?.readValue();return r?r.getUint8(0):0}async getPMDFeatures(){let r=await this.PMDCtrlChar?.readValue(),t=[];if(r!==void 0&&r.byteLength===17&&r.getUint8(0)===15){let i=r.getUint8(1);for(let d=0;d<xe.length;d++){let a=xe[d];i>>z[a]&1&&t.push(a)}}return t}async getSensorSettingsFromName(r){return this.getSensorSettingsFromId(z[r])}parseSensorSettings(r){if(r.getUint8(0)==240&&r.getUint8(1)==1){let t={type:z[r.getUint8(2)],error:ee[r.getUint8(3)],more_frames:r.getUint8(4),settings:{}},i=5;for(;i<r.byteLength;){let d=r.getUint8(i);i+=1;let a=r.getUint8(i);i+=1;let s=je[d];t.settings[s]=[];for(let h=0;h<a;h++)t.settings[s].push(Hi[s](r,i)),i+=Bi[s]}return t}}async getSensorSettingsFromId(r){if(!this.streaming){let t,i=new Promise((s,h)=>{t=s}),d=s=>{let h=s?.target?.value;t(this.parseSensorSettings(h))};this.PMDCtrlChar?.addEventListener("characteristicvaluechanged",d,{once:!0});let a=new Uint8Array([1,r]);return await this.PMDCtrlChar?.writeValue(a),await i}}PMDDataHandle(r){let t=r.target.value,i=t.getBigUint64(1,!0);this.timeOffset===BigInt(0)&&(this.timeOffset=i,this.eventTimeOffset=r.timeStamp+performance.timeOrigin);let d=Number(i-this.timeOffset)/1e6,a=t.getUint8(0),s=t.getUint8(9),h={type:z[a],sample_timestamp_ms:d,prev_sample_timestamp_ms:0,recv_epoch_time_ms:r.timeStamp+performance.timeOrigin,event_time_offset_ms:this.eventTimeOffset};switch(a){case 2:s==1&&(h.samples=new Int16Array(t.buffer.slice(10)),h.prev_sample_timestamp_ms=this.lastACCTimestamp,this.lastACCTimestamp=d);break;case 0:if(s===0){let o=Math.floor((t.byteLength-10)/3);h.samples=new Int32Array(o);for(let e=10;e<t.byteLength;e+=3){let n=t.getUint8(e+2)<<16|t.getUint8(e+1)<<8|t.getUint8(e);n&8388608&&(n|=4278190080),h.samples[Math.floor((e-10)/3)]=n}h.prev_sample_timestamp_ms=this.lastECGTimestamp,this.lastECGTimestamp=d}break}for(let o of this.dataHandle[z[a]])o(h)}parseCtrlReply(r){if(r.getUint8(0)===240){let t=r.getUint8(1);if(t===2||t===3){let i={type:Ke[t],sensor:z[r.getUint8(2)],error:ee[r.getUint8(3)],more_frames:r.getUint8(4)};return r.byteLength>5&&(i.reserved=r.getUint8(5)),i}}}async startACC(r=4,t=100,i=16){if(this.ACCStarted)return;let d,a=new Promise((n,c)=>{d=n}),s=n=>{this.log("PMDSensorSettingHandle");let c=n?.target?.value;d(this.parseCtrlReply(c))};this.PMDCtrlChar?.addEventListener("characteristicvaluechanged",s,{once:!0});let h=new Uint8Array(14),o=new DataView(h.buffer);h[0]=2,h[1]=2,h[2]=2,h[3]=1,o.setUint16(4,r,!0),h[6]=0,h[7]=1,o.setUint16(8,t,!0),h[10]=1,h[11]=1,o.setUint16(12,i,!0),await this.PMDCtrlChar?.writeValue(h);let e=await a;return e?.error===ee[0]&&(this.ACCStarted=!0),e}async startECG(r=130,t=14){if(this.ECGStarted)return;let i,d=new Promise((e,n)=>{i=e}),a=e=>{this.log("PMDSensorSettingHandle");let n=e?.target?.value;i(this.parseCtrlReply(n))};this.PMDCtrlChar?.addEventListener("characteristicvaluechanged",a,{once:!0});let s=new Uint8Array(10),h=new DataView(s.buffer);s[0]=2,s[1]=0,s[2]=1,s[3]=1,h.setUint16(4,t,!0),s[6]=0,s[7]=1,h.setUint16(8,r,!0),await this.PMDCtrlChar?.writeValue(s);let o=await d;return o?.error===ee[0]&&(this.ECGStarted=!0),o}async stopECG(){if(!this.ECGStarted)return;let r=await this.stopSensor(0);return r?.error===ee[0]&&(this.ECGStarted=!1),r}async stopACC(){if(!this.ACCStarted)return;let r=await this.stopSensor(2);return r?.error===ee[0]&&(this.ACCStarted=!1),r}async stopSensor(r){let t,i=new Promise((s,h)=>{t=s}),d=s=>{let h=s?.target?.value;t(this.parseCtrlReply(h))};this.PMDCtrlChar?.addEventListener("characteristicvaluechanged",d,{once:!0});let a=new Uint8Array(2);return a[0]=3,a[1]=r,await this.PMDCtrlChar?.writeValue(a),await i}};var Rt=["","LShoulder","RShoulder","Chest","MiddleSpine","LowerSpine","Hip","LThigh","RThigh"],Vi=new Date("2000-01-01T00:00:00Z"),ki=new Date("2018-01-01T00:00:00Z"),Xi=Vi.valueOf(),zi=BigInt(Xi)*BigInt(1e6),Ui=ki.valueOf(),Wi=BigInt(Ui)*BigInt(1e6),xt=Wi-zi,Yi=xt/BigInt(1e6),Mt=Number(xt-Yi*BigInt(1e6))/1e6,cn=Mt+Number(Mt);var ce=5,Dt=35,Lt=600,Ft=-120,Je=120,Gt=0,et=120,De=25,Z=1,Q=20,yt=4,te=130,Pt=5,Nt=5,tt=1,Le=20,Fe=800,Ot=10,Ge=200,Ht=Math.round(te/(1e3/Ge)),U=.7,he=40,q=.1,Bt=600,ye=[2,4,8],Pe=[25,50,100,200],it=100,nt=4,st=-2e3,Ne=2e3,at=10,rt=4;var ot=10,Vt=100,Oe=2.5,He=.1,kt=4,Xt=-20,lt=20,ct=1,zt=1,de=8,ue=0,fe=800,Ut=1,pe=1,_e=30,Wt=.1,me=0,Ce=800,Yt=1,ge=1,Se=30,$t=.1,ht={limitFPS:60,grid:{strokeStyle:"#484f58",fillStyle:"#000000",lineWidth:1,millisPerLine:1e3,borderVisible:!1},title:{text:"EXG raw voltage (0.7\u201340 Hz)",fontFamily:"Arial",verticalAlign:"bottom",fillStyle:"#ffffff80",fontSize:14},responsive:!1,nonRealtimeData:!0,millisPerPixel:de,scaleSmoothing:.1,tooltip:!1,minValueScale:1,maxValueScale:1},dt={limitFPS:60,minValue:st,maxValue:Ne,grid:{strokeStyle:"#484f58",fillStyle:"#000000",lineWidth:1,millisPerLine:1e3,borderVisible:!1},title:{text:"Accelerometer raw",fontFamily:"Arial",verticalAlign:"bottom",fillStyle:"#ffffff80",fontSize:14},labels:{disabled:!1},responsive:!1,nonRealtimeData:!0,millisPerPixel:de,scaleSmoothing:.1,tooltip:!1,minValueScale:1,maxValueScale:1},qt={lineWidth:2,interpolation:"linear",strokeStyle:"#fbfbfbcc"},Zt={lineWidth:2,interpolation:"linear",strokeStyle:"#ffdcaacc"},Qt={lineWidth:2,interpolation:"linear",strokeStyle:"#dcaaffcc",fillStyle:"#f0beff99"},jt={lineWidth:2,interpolation:"linear",strokeStyle:"#ff453acc"},Kt={lineWidth:2,interpolation:"linear",strokeStyle:"#32ff4bcc"},Jt={lineWidth:2,interpolation:"linear",strokeStyle:"#0a84ffcc"},ei={lineWidth:2,interpolation:"linear",strokeStyle:"#ff776ccc"},ti={lineWidth:2,interpolation:"linear",strokeStyle:"#64ff7dcc"},ii={lineWidth:2,interpolation:"linear",strokeStyle:"#3cb6ffcc"},ni={lineWidth:2,interpolation:"linear",strokeStyle:"#6effffcc"},si={lineWidth:2,interpolation:"linear",strokeStyle:"#ff70ffcc"},ai={lineWidth:2,interpolation:"linear",strokeStyle:"#ffff78cc"},ri={lineWidth:2,interpolation:"linear",strokeStyle:"#fbfbfbcc"},oi={lineWidth:2,interpolation:"linear",strokeStyle:"#ffdcaacc"},li={lineWidth:2,interpolation:"linear",strokeStyle:"#f0883e"},ci={lineWidth:2,interpolation:"linear",strokeStyle:"#f778ba"},hi={lineWidth:2,interpolation:"linear",strokeStyle:"#388afd"},di={lineWidth:2,interpolation:"linear",strokeStyle:"#aadcffcc"},ui=(c=>(c[c.ECG=0]="ECG",c[c.PPG=1]="PPG",c[c.ACC=2]="ACC",c[c.PPI=3]="PPI",c[c.GYRO=5]="GYRO",c[c.MAGNETOMETER=6]="MAGNETOMETER",c[c.SDK_MODE=9]="SDK_MODE",c[c.LOCATION=10]="LOCATION",c[c.PRESSURE=11]="PRESSURE",c[c.TEMPERATURE=12]="TEMPERATURE",c))(ui||{}),hn=Object.keys(ui).filter(r=>isNaN(Number(r))),Be=["lowpass","highpass","bandpass"],Ve=["butterworth","bessel"];var ut=new B.CalcCascades;async function gi(r,t){await new ke(r,t).init()}var ke=class r{static polarRowID=0;static polarVisRows=[];device;polarH10;deviceName;battLvl;parent;polarSensorDiv;optionDiv;deviceInfoDiv;nameDiv;loadingDiv;disconnectDiv;deviceNameDiv;battLvlDiv;dataInfo;bodypartLabel;bodypartSelectDiv;bodypartSelect;dataCtrl;extraDataCtrl;rowOrder;visContainerDiv;visConfigDiv;ECGConfigDiv;ECGChartConfigDiv;ECGFilterConfigDiv;ECGRMSConfigDiv;customBodyPartInput;ACCConfigDiv;ACCChartConfigDiv;ACCHPConfigDiv;ACCRMSConfigDiv;ECGCtrlDiv;ACCCtrlDiv;order;ECG_FILTER_MIN=Ft;ECG_FILTER_MAX=Je;ECG_RMS_MIN=Gt;ECG_RMS_MAX=et;ACC_MIN=st;ACC_MAX=Ne;ACC_FILTER_MIN=Xt;ACC_FILTER_MAX=lt;disBtn;orderUpBtn;orderDownBtn;show3DBtn;filterConfigBtn;ECGFormSelect;ECGSwitchInput;ECGDropDown;ACCFormSelect;ACCSwitchInput;ACCDropDown;ECGDiv=void 0;ACCDiv=void 0;ECGStreamDelayInput=void 0;ECGstreamMPPInput=void 0;ECGRMSWinInput=void 0;ACCStreamDelayInput=void 0;ACCstreamMPPInput=void 0;ecg_resize=void 0;ecg_chart=void 0;ecg_resize_observer=void 0;ecg_canvas=void 0;ecg_filter_iir_coef=void 0;ecg_ts=void 0;ecg_filter_info;ecg_filter_iir=void 0;ecg_filter_ts=void 0;ecg_rms_ts=void 0;ecg_mss_win=void 0;ecg_mss_win_i=0;ecg_buf_head=0;ecg_mss=0;acc_resize=void 0;acc_chart=void 0;acc_resize_observer=void 0;acc_canvas=void 0;acc_x_ts=void 0;acc_y_ts=void 0;acc_z_ts=void 0;acc_mag_ts=void 0;acc_lp_info;acc_lp_iir_coef=void 0;acc_x_lp_iir=void 0;acc_y_lp_iir=void 0;acc_z_lp_iir=void 0;acc_mag_lp_iir=void 0;acc_x_lp_ts=void 0;acc_y_lp_ts=void 0;acc_z_lp_ts=void 0;acc_mag_lp_ts=void 0;acc_rho_ts=void 0;acc_phi_ts=void 0;acc_theta_ts=void 0;acc_filter_info;acc_filter_iir_coef=void 0;acc_x_filter_iir=void 0;acc_y_filter_iir=void 0;acc_z_filter_iir=void 0;acc_mag_filter_iir=void 0;acc_x_filter_ts=void 0;acc_y_filter_ts=void 0;acc_z_filter_ts=void 0;acc_mag_filter_ts=void 0;ecg_rms_window_ms=Ge;ecg_rms_window_size=Ht;ecg_stream_delay=Lt;acc_stream_delay=Bt;ecg_millis_per_px=de;acc_millis_per_px=de;showVisConfig=!1;customBodyPart="";customBodyPartSpan=void 0;acc_range_options=void 0;acc_sample_rate_options=void 0;acc_range_g=nt;acc_sample_rate_hz=it;ACCSampleRateSelect=void 0;ACCRangeSelect=void 0;ECGFilterTypesSelect=void 0;ECGFilteCharSelect=void 0;ECGFilterOrderInput=void 0;ECGFilterCutoffInput=void 0;ECGFilterHighCutInput=void 0;ECGFilterLowCutInput=void 0;constructor(t,i){if(i.name===void 0)throw new Error("Invalid Bluetooth device! Missing name");this.parent=t,this.device=i,this.deviceName=this.device?.name?.substring(10)||"",this.ecg_rms_window_ms=Ge,this.updateECGRMSWinSize(),this.initFilterSettings(),this.showVisConfig=!1}updateECGRMSWinSize(){this.ecg_rms_window_size=Math.round(te/(1e3/this.ecg_rms_window_ms))}updateECGRMSWin(){this.ecg_mss_win_i=0,this.ecg_buf_head=0,this.ecg_mss=0,this.ecg_mss_win=new Float64Array(this.ecg_rms_window_ms)}initECGFilterSettings(){this.ecg_filter_info={type:"highpass",order:yt,characteristic:"butterworth",Fs:te,Fc:De,Fl:Z,Fh:Q,BW:Q-Z,gain:void 0,preGain:!1}}initACCFilterSettings(){this.acc_lp_info={type:"lowpass",order:rt,characteristic:"butterworth",Fs:this.acc_sample_rate_hz,Fc:at,Fl:1,Fh:10,BW:void 0,gain:void 0,preGain:!1},this.acc_filter_info={type:"bandpass",order:kt,characteristic:"butterworth",Fs:this.acc_sample_rate_hz,Fc:Math.sqrt(He*Oe),Fl:He,Fh:Oe,BW:Oe-He,gain:void 0,preGain:!1}}initFilterSettings(){this.initECGFilterSettings(),this.initACCFilterSettings()}updateBandpass(t){t.Fh!==void 0&&t.Fl!=null&&(t.BW=t.Fh-t.Fl,t.Fc=Math.sqrt(t.Fh*t.Fl))}disconnectPolarH10=async(t=void 0)=>{this.removeSelf(),this.ecg_chart!==void 0&&this.ecg_chart.stop(),this.ecg_resize_observer!==void 0&&this.ecg_resize_observer.disconnect(),this.ECGDiv!==void 0&&(this.visContainerDiv?.removeChild(this.ECGDiv),this.polarH10.removeEventListener("ECG",this.newECGCallback),await this.stopECG()),this.resetECG(),this.acc_chart!==void 0&&this.acc_chart.stop(),this.acc_resize_observer!==void 0&&this.acc_resize_observer.disconnect(),this.ACCDiv!==void 0&&(this.visContainerDiv?.removeChild(this.ACCDiv),this.polarH10.removeEventListener("ACC",this.newACCCallback),await this.stopAcc()),this.resetACC(),this.disconnectPolarH10IfAlone()};async init(){try{await this.initPolarH10(),await this.initDeviceInfo(),await this.initDeviceGraphCtrl(),r.polarRowID+=1,r.polarVisRows.push(this)}catch(t){this.disconnectPolarH10(),alert(t)}}moveUp=t=>{this.order-=1,this.polarSensorDiv.style.order=this.order.toString();let i=r.polarVisRows[this.order];i.order+=1,i.polarSensorDiv.style.order=i.order.toString(),r.polarVisRows[this.order]=this,r.polarVisRows[i.order]=i,this.order===0?(this.orderUpBtn.disabled=!0,this.orderDownBtn.disabled=!1,i.orderUpBtn.disabled=!1):this.order===r.polarVisRows.length-2&&(this.orderDownBtn.disabled=!1),i.order===r.polarVisRows.length-1&&(i.orderDownBtn.disabled=!0,i.orderUpBtn.disabled=!1)};moveDown=t=>{this.order+=1,this.polarSensorDiv.style.order=this.order.toString();let i=r.polarVisRows[this.order];i.order-=1,i.polarSensorDiv.style.order=i.order.toString(),r.polarVisRows[this.order]=this,r.polarVisRows[i.order]=i,this.order===r.polarVisRows.length-1?(this.orderUpBtn.disabled=!1,this.orderDownBtn.disabled=!0,i.orderDownBtn.disabled=!1):this.order===1&&(this.orderUpBtn.disabled=!1),i.order===0&&(i.orderDownBtn.disabled=!1,i.orderUpBtn.disabled=!0)};toggleVisConfig=t=>{this.showVisConfig=!this.showVisConfig,this.showVisConfig?(this.visContainerDiv.classList.add("hide"),this.visConfigDiv.classList.remove("hide"),this.filterConfigBtn.classList.add("btn-success")):(this.visContainerDiv.classList.remove("hide"),this.visConfigDiv.classList.add("hide"),this.filterConfigBtn.classList.remove("btn-success"))};newECGCallback=t=>{if(this.ecg_ts!==void 0&&this.ecg_rms_ts!==void 0&&this.ecg_filter_ts!==void 0&&t.prev_sample_timestamp_ms>0&&t.samples!==void 0&&this.ecg_filter_iir!==void 0){let i=(t.sample_timestamp_ms-t.prev_sample_timestamp_ms)/t.samples.length,d=t.event_time_offset_ms+t.prev_sample_timestamp_ms+i;for(let a=0;a<t.samples.length;a++){let s=a*i,h=d+s,o=t.samples[a],e=this.ecg_filter_iir.singleStep(o),n=e/this.ecg_rms_window_size*e,c;this.ecg_mss_win!==void 0&&(this.ecg_mss+=n,this.ecg_mss_win_i<this.ecg_rms_window_size?(this.ecg_mss_win[this.ecg_mss_win_i]=n,this.ecg_mss_win_i++):(this.ecg_mss-=this.ecg_mss_win[this.ecg_buf_head],this.ecg_mss_win[this.ecg_buf_head]=n,this.ecg_buf_head=(this.ecg_buf_head+1)%this.ecg_rms_window_size),this.ecg_mss_win_i===this.ecg_rms_window_size&&(c=Math.sqrt(this.ecg_mss))),setTimeout(()=>{this.ecg_ts?.append(h,o),this.ecg_filter_ts?.append(h,e),c!==void 0&&this.ecg_rms_ts?.append(h,c)},s)}}};newACCCallback=t=>{if(t.prev_sample_timestamp_ms>0&&t.samples!==void 0&&this.acc_x_ts!==void 0&&this.acc_y_ts!==void 0&&this.acc_z_ts!==void 0&&this.acc_mag_ts!==void 0&&this.acc_x_lp_ts!==void 0&&this.acc_y_lp_ts!==void 0&&this.acc_z_lp_ts!==void 0&&this.acc_mag_lp_ts!==void 0&&this.acc_rho_ts!==void 0&&this.acc_phi_ts!==void 0&&this.acc_theta_ts!==void 0&&this.acc_x_filter_ts!==void 0&&this.acc_y_filter_ts!==void 0&&this.acc_z_filter_ts!==void 0&&this.acc_mag_filter_ts!==void 0&&this.acc_x_lp_iir!==void 0&&this.acc_y_lp_iir!==void 0&&this.acc_z_lp_iir!==void 0&&this.acc_mag_lp_iir!==void 0&&this.acc_x_filter_iir!==void 0&&this.acc_y_filter_iir!==void 0&&this.acc_z_filter_iir!==void 0&&this.acc_mag_filter_iir!==void 0){let i=t.samples.length/3,d=(t.sample_timestamp_ms-t.prev_sample_timestamp_ms)/i,a=t.event_time_offset_ms+t.prev_sample_timestamp_ms+d;for(let s=0;s<t.samples.length;s+=3){let o=Math.floor(s/3)*d,e=a+o,n=-t.samples[s],c=-t.samples[s+1],f=t.samples[s+2],u=this.acc_x_lp_iir.singleStep(c),g=this.acc_y_lp_iir.singleStep(n),v=this.acc_z_lp_iir.singleStep(f),p=u*u,I=g*g,M=v*v,b=Math.atan(u/Math.sqrt(I+M))/Math.PI*180,E=Math.atan(g/Math.sqrt(p+M))/Math.PI*180,R=Math.atan(Math.sqrt(p+I)/v)/Math.PI*180,_=Math.sqrt(c*c+n*n+f*f),m=this.acc_mag_lp_iir.singleStep(_),l=this.acc_x_filter_iir.singleStep(c),x=this.acc_y_filter_iir.singleStep(n),C=this.acc_z_filter_iir.singleStep(f),S=this.acc_mag_filter_iir.singleStep(_);setTimeout(()=>{this.acc_x_ts?.append(e,c),this.acc_y_ts?.append(e,n),this.acc_z_ts?.append(e,f),this.acc_mag_ts?.append(e,_),this.acc_rho_ts?.append(e,b),this.acc_phi_ts?.append(e,E),this.acc_theta_ts?.append(e,R),this.acc_x_lp_ts?.append(e,u),this.acc_y_lp_ts?.append(e,g),this.acc_z_lp_ts?.append(e,v),this.acc_mag_lp_ts?.append(e,m),this.acc_x_filter_ts?.append(e,l),this.acc_y_filter_ts?.append(e,x),this.acc_z_filter_ts?.append(e,C),this.acc_mag_filter_ts?.append(e,S)},o)}}};changeECGGraph=t=>{if(this.ecg_chart!==void 0&&this.ecg_ts!==void 0&&this.ecg_filter_ts!==void 0&&this.ecg_rms_ts!==void 0){let i=t.target.selectedIndex;switch(this.ecg_chart.stop(),i){case 0:this.ecg_chart.configureTimeSeries([this.ecg_ts],[qt],[G("\u2015 Voltage (\u03BCV)",10,0)],!1,void 0,void 0,1,1,ht.title?.text||"EXG raw voltage (0.7\u201340 Hz)",!1,[],!0,!1,!0);break;case 1:this.ecg_chart.configureTimeSeries([this.ecg_filter_ts],[Zt],[G("\u2015 Voltage (\u03BCV)",10,0)],!0,this.ECG_FILTER_MIN,this.ECG_FILTER_MAX,1,1,`${pt(this.ecg_filter_info)} on EXG raw`,!1,[],!0,!0,!0);break;case 2:this.ecg_chart.configureTimeSeries([this.ecg_rms_ts],[Qt],[G("\u2015 RMS voltage (\u03BCV)",10,0)],!0,this.ECG_RMS_MIN,this.ECG_RMS_MAX,1,1,`RMS using ${this.ecg_rms_window_ms}ms window on ${pt(this.ecg_filter_info,!1)} EXG`,!1,[],!0,!0,!0);break}this.ecg_chart.start()}};changeACCGraph=t=>{if(this.acc_chart!==void 0&&this.acc_x_ts!==void 0&&this.acc_y_ts!==void 0&&this.acc_z_ts!==void 0&&this.acc_x_lp_ts!==void 0&&this.acc_y_lp_ts!==void 0&&this.acc_z_lp_ts!==void 0&&this.acc_mag_lp_ts!==void 0&&this.acc_rho_ts!==void 0&&this.acc_phi_ts!==void 0&&this.acc_theta_ts!==void 0&&this.acc_mag_ts!==void 0&&this.acc_x_filter_ts!==void 0&&this.acc_y_filter_ts!==void 0&&this.acc_z_filter_ts!==void 0&&this.acc_mag_filter_ts!==void 0){let i=t.target.selectedIndex,d="";switch(this.acc_chart.stop(),i){case 0:this.acc_chart.configureTimeSeries([this.acc_x_ts,this.acc_y_ts,this.acc_z_ts,this.acc_mag_ts],[jt,Kt,Jt,ri],[G("\u2015 X-axis (mG)",10,0),G("\u2015 Y-axis (mG)",10,0),G("\u2015 Z-axis (mG)",10,0),G("\u2015 ACC magnitude (mG)",10,0)],!0,this.ACC_MIN,this.ACC_MAX,1,1,dt.title?.text||"Accelerometer raw",!1,[],!0,!0,!0);break;case 1:this.acc_chart.configureTimeSeries([this.acc_x_lp_ts,this.acc_y_lp_ts,this.acc_z_lp_ts,this.acc_mag_lp_ts],[ei,ti,ii,oi],[G("\u2015 X-axis (mG)",10,0),G("\u2015 Y-axis (mG)",10,0),G("\u2015 Z-axis (mG)",10,0),G("\u2015 ACC magnitude (mG)",10,0)],!0,this.ACC_MIN,this.ACC_MAX,1,1,`Lowpass (${at}Hz ${rt}th order Butterworth) on accelerometer raw`,!1,[],!0,!0,!0);break;case 2:this.acc_chart.configureTimeSeries([this.acc_rho_ts,this.acc_phi_ts,this.acc_theta_ts],[ni,si,ai],[G("\u2015 \u03C1\xB0 \u2220(X-axis, Horizon)",10,0),G("\u2015 \u03D5\xB0 \u2220(Y-axis, Horizon)",10,0),G("\u2015 \u03B8\xB0 \u2220(Z-axis, -Gravity)",10,0)],!1,-120,120,1.3,1.3,"Tilt angle [-90\xB0, 90\xB0] from lowpass on accelerometer raw",!1,[{value:90,color:"#ffffff7f",lineWidth:1},{value:-90,color:"#ffffff7f",lineWidth:1}],!0,!0,!0);break;case 3:this.acc_chart.configureTimeSeries([this.acc_x_filter_ts,this.acc_y_filter_ts,this.acc_z_filter_ts,this.acc_mag_filter_ts],[li,ci,hi,di],[G("\u2015 X-axis (mG)",10,0),G("\u2015 Y-axis (mG)",10,0),G("\u2015 Z-axis (mG)",10,0),G("\u2015 ACC magnitude (mG)",10,0)],!0,this.ACC_FILTER_MIN,this.ACC_FILTER_MAX,1,1,`${pt(this.acc_filter_info)} on accelerometer raw magnitude`,!1,[],!0,!0,!0);break}this.acc_chart.start()}};onWheelECG=t=>{if(this.ecg_chart!==void 0&&!this.ecg_chart.yScaleIsAuto()){let i=t.deltaY<0?tt:-tt;switch(this.ECGFormSelect?.selectedIndex){case 0:break;case 1:this.ECG_FILTER_MAX!==void 0&&this.ECG_FILTER_MIN!==void 0&&(t.preventDefault(),this.ECG_FILTER_MAX+=i,this.ECG_FILTER_MIN-=i,(this.ECG_FILTER_MAX<Pt||this.ECG_FILTER_MAX<=this.ECG_FILTER_MIN||this.ECG_FILTER_MAX/ce>Je)&&(this.ECG_FILTER_MAX-=i,this.ECG_FILTER_MIN+=i),this.ecg_chart.options.minValue=this.ECG_FILTER_MIN,this.ecg_chart.options.maxValue=this.ECG_FILTER_MAX);break;case 2:if(this.ECG_RMS_MAX!==void 0){t.preventDefault(),this.ECG_RMS_MAX+=i,(this.ECG_RMS_MAX<Nt||this.ECG_RMS_MAX<=this.ECG_RMS_MIN||this.ECG_RMS_MAX/ce>et)&&(this.ECG_RMS_MAX-=i),this.ecg_chart.options.minValue=0,this.ecg_chart.options.maxValue=this.ECG_RMS_MAX;break}}}};onWheelACC=t=>{if(this.acc_chart!==void 0&&!this.acc_chart.yScaleIsAuto()){let i=0;switch(this.ACCFormSelect?.selectedIndex){case 0:case 1:this.ACC_MAX!==void 0&&this.ACC_MIN!==void 0&&(t.preventDefault(),i=t.deltaY<0?ot:-ot,this.ACC_MAX+=i,this.ACC_MIN-=i,(this.ACC_MAX<Vt||this.ACC_MAX<=this.ACC_MIN||this.ACC_MAX/ce>Ne)&&(this.ACC_MAX-=i,this.ACC_MIN+=i),this.acc_chart.options.minValue=this.ACC_MIN,this.acc_chart.options.maxValue=this.ACC_MAX);break;case 2:break;case 3:this.ACC_FILTER_MAX!==void 0&&this.ACC_FILTER_MIN!==void 0&&(t.preventDefault(),i=t.deltaY<0?ct:-ct,this.ACC_FILTER_MAX+=i,this.ACC_FILTER_MIN-=i,(this.ACC_FILTER_MAX<zt||this.ACC_FILTER_MAX<=this.ACC_MIN||this.ACC_FILTER_MAX/ce>lt)&&(this.ACC_FILTER_MAX-=i,this.ACC_FILTER_MIN+=i),this.acc_chart.options.minValue=this.ACC_FILTER_MIN,this.acc_chart.options.maxValue=this.ACC_FILTER_MAX);break}}};disableAllOtherSameSwitch(){for(let t=0;t<r.polarVisRows.length;t++){let i=r.polarVisRows[t];i!==this&&i.polarH10===this.polarH10&&(i.ECGSwitchInput.disabled=!0,i.ACCSwitchInput.disabled=!0)}}enableAllOtherSameSwitch(){for(let t=0;t<r.polarVisRows.length;t++){let i=r.polarVisRows[t];i!==this&&i.polarH10===this.polarH10&&(i.ECGSwitchInput.disabled=!1,i.ACCSwitchInput.disabled=!1)}}onToggleECG=async t=>{if(this.ACCSwitchInput.disabled=!0,this.disableAllOtherSameSwitch(),t.target?.checked){this.initECGFilterSettings();let i;this.ACCDiv===void 0?i="full-width":(i="half-width",this.ACCDiv.classList.remove("full-width"),this.ACCDiv.classList.add("half-width"),this.visContainerDiv.removeChild(this.ACCDiv)),this.ECGDiv=T("ECGDiv",this.visContainerDiv,["float-left","almost-full-height",i]),this.ECGDiv.addEventListener("wheel",this.onWheelECG),this.ACCDiv!==void 0&&this.visContainerDiv.appendChild(this.ACCDiv),this.ecg_canvas=_i("ecg_canvas",this.ECGDiv),this.ecg_chart=new le(ht),this.ecg_chart.options.millisPerPixel=this.ecg_millis_per_px,this.ecg_ts=new y.TimeSeries,this.ecg_rms_ts=new y.TimeSeries,this.ecg_filter_ts=new y.TimeSeries,this.ecg_chart.streamTo(this.ecg_canvas,this.ecg_stream_delay),this.updateECGRMSWinSize(),this.updateECGRMSWin(),this.ecg_resize=fi(this.ecg_chart,1,1),this.ecg_resize_observer=new ResizeObserver(d=>{for(let a of d)a.target===this.ECGDiv&&this.ecg_resize!==void 0&&this.ecg_resize()}),this.ecg_resize_observer.observe(this.ECGDiv),this.ecgFilterCoefReset(),this.ecg_resize(),this.ECGFormSelect!==void 0&&(this.ECGFormSelect.disabled=!1,this.ECGFormSelect.selectedIndex=0),await this.startECG(te),this.changeECGGraph({target:{selectedIndex:0}})}else this.ECGDiv!==void 0&&this.ecg_canvas!==void 0&&this.ecg_chart!==void 0&&(this.ecg_chart.stop(),this.ECGFormSelect!==void 0&&(this.ECGFormSelect.disabled=!0,this.ECGFormSelect.selectedIndex=0),this.ECGDiv.contains(this.ecg_canvas)&&(this.ACCDiv?.classList.remove("half-width"),this.ACCDiv?.classList.add("full-width"),await this.stopECG(),this.visContainerDiv.removeChild(this.ECGDiv),this.ecg_resize_observer?.disconnect(),this.polarH10.removeEventListener("ECG",this.newECGCallback),this.resetECG()));this.ACCSwitchInput&&(this.ACCSwitchInput.disabled=!1),this.enableAllOtherSameSwitch()};onToggleACC=async t=>{if(this.disableAllOtherSameSwitch(),this.ECGSwitchInput&&(this.ECGSwitchInput.disabled=!0),t.target?.checked){this.initACCFilterSettings();let i;this.ECGDiv===void 0?i="full-width":(i="half-width",this.ECGDiv.classList.remove("full-width"),this.ECGDiv.classList.add("half-width")),this.ACCDiv=T("ACCDiv",this.visContainerDiv,["float-left","almost-full-height",i]),this.ACCDiv.addEventListener("wheel",this.onWheelACC),this.acc_canvas=_i("acc_canvas",this.ACCDiv),this.acc_chart=new le(dt),this.acc_chart.options.millisPerPixel=this.acc_millis_per_px,this.acc_x_ts=new y.TimeSeries,this.acc_y_ts=new y.TimeSeries,this.acc_z_ts=new y.TimeSeries,this.acc_mag_ts=new y.TimeSeries,this.acc_x_lp_ts=new y.TimeSeries,this.acc_y_lp_ts=new y.TimeSeries,this.acc_z_lp_ts=new y.TimeSeries,this.acc_mag_lp_ts=new y.TimeSeries,this.acc_rho_ts=new y.TimeSeries,this.acc_phi_ts=new y.TimeSeries,this.acc_theta_ts=new y.TimeSeries,this.acc_x_filter_ts=new y.TimeSeries,this.acc_y_filter_ts=new y.TimeSeries,this.acc_z_filter_ts=new y.TimeSeries,this.acc_mag_filter_ts=new y.TimeSeries,this.acc_chart.streamTo(this.acc_canvas,this.acc_stream_delay),this.acc_resize=fi(this.acc_chart,1,1),this.acc_resize_observer=new ResizeObserver(d=>{for(let a of d)a.target===this.ACCDiv&&this.acc_resize!==void 0&&this.acc_resize()}),this.acc_resize_observer.observe(this.ACCDiv),this.acc_lp_iir_coef=ut[this.acc_lp_info.type](this.acc_lp_info),this.acc_x_lp_iir=(0,B.IirFilter)(this.acc_lp_iir_coef),this.acc_y_lp_iir=(0,B.IirFilter)(this.acc_lp_iir_coef),this.acc_z_lp_iir=(0,B.IirFilter)(this.acc_lp_iir_coef),this.acc_mag_lp_iir=(0,B.IirFilter)(this.acc_lp_iir_coef),this.acc_filter_iir_coef=ut[this.acc_filter_info.type](this.acc_filter_info),this.acc_x_filter_iir=(0,B.IirFilter)(this.acc_filter_iir_coef),this.acc_y_filter_iir=(0,B.IirFilter)(this.acc_filter_iir_coef),this.acc_z_filter_iir=(0,B.IirFilter)(this.acc_filter_iir_coef),this.acc_mag_filter_iir=(0,B.IirFilter)(this.acc_filter_iir_coef),this.acc_resize(),this.ACCFormSelect!==void 0&&(this.ACCFormSelect.disabled=!1,this.ACCFormSelect.selectedIndex=0),await this.startACC(this.acc_range_g,this.acc_sample_rate_hz),this.changeACCGraph({target:{selectedIndex:0}}),this.show3DBtn.disabled=!1}else this.show3DBtn.disabled=!0,this.ACCDiv!==void 0&&this.acc_canvas!==void 0&&this.acc_chart!==void 0&&(this.acc_chart.stop(),this.ACCFormSelect!==void 0&&(this.ACCFormSelect.disabled=!0,this.ACCFormSelect.selectedIndex=0),this.ACCDiv.contains(this.acc_canvas)&&this.ACCDiv.removeChild(this.acc_canvas),this.ECGDiv?.classList.remove("half-width"),this.ECGDiv?.classList.add("full-width"),this.polarH10.removeEventListener("ACC",this.newACCCallback),this.visContainerDiv.removeChild(this.ACCDiv),this.acc_resize_observer?.disconnect(),await this.stopAcc(),this.resetACC());this.ECGSwitchInput&&(this.ECGSwitchInput.disabled=!1),this.enableAllOtherSameSwitch()};removeSelf(){this.parent.contains(this.polarSensorDiv)&&this.parent.removeChild(this.polarSensorDiv);let t=r.polarVisRows.indexOf(this);t>-1&&(r.polarVisRows.splice(t,1),r.polarVisRows.length>0&&(t===r.polarVisRows.length?r.polarVisRows[t-1].orderDownBtn.disabled=!0:t===0&&(r.polarVisRows[0].orderUpBtn.disabled=!0),r.reOrderRows()))}static reOrderRows(){for(let t=0;t<r.polarVisRows.length;t++){let i=r.polarVisRows[t];i.order=t,i.polarSensorDiv.style.order=t.toString()}}async initPolarH10(){this.polarSensorDiv=T("polarSensorDiv",this.parent,["polar-sensor-row","flexbox"]),this.optionDiv=T("optionDiv",this.polarSensorDiv,["polar-sensor-left-panel","center"]),this.order=r.polarVisRows.length,this.polarSensorDiv.style.order=this.order.toString(),this.nameDiv=T("device-name-batt",this.optionDiv,["center","flexbox"],`Conneting ${this.deviceName}...`),this.loadingDiv=T("ConnectLoading",this.optionDiv,["loading","loading-lg","full-width","flexbox"]),await this.initPolarH10IfUnique()}includesDuplicate(t="device",i=void 0){let d=-1;if(i!==void 0)for(let a=0;a<r.polarVisRows.length;a++){let s=r.polarVisRows[a];if(s!==this&&s[t]===this[t]&&i(s)){d=a;break}}else for(let a=0;a<r.polarVisRows.length;a++){let s=r.polarVisRows[a];if(s!==this&&s[t]===this[t]){d=a;break}}return d}static includesDuplicate(t,i="device",d=void 0){let a=-1;if(d!==void 0)for(let s=0;s<r.polarVisRows.length;s++){let h=r.polarVisRows[s];if(h!==t&&h[i]===t[i]&&d(h)){a=s;break}}else for(let s=0;s<r.polarVisRows.length;s++){let h=r.polarVisRows[s];if(h!==t&&h[i]===t[i]){a=s;break}}return a}disconnectPolarH10IfAlone(){this.includesDuplicate("device")===-1&&this.device.gatt?.disconnect()}async initPolarH10IfUnique(){let t=this.includesDuplicate("device");if(t<0)try{this.polarH10=new wt(this.device),await this.polarH10.init();let i=await this.polarH10.getSensorSettingsFromId(z.ACC)}catch(i){throw console.log(i),new Error("polarH10 device initialization failed!")}else this.polarH10=r.polarVisRows[t].polarH10}resetECG(){this.ecg_canvas=void 0,this.ECGDiv=void 0,this.ecg_resize=void 0,this.ecg_mss_win=void 0,this.ecg_chart=void 0,this.ecg_ts=void 0,this.ecg_filter_ts=void 0,this.ecg_rms_ts=void 0,this.ecg_resize_observer=void 0,this.ecg_filter_iir_coef=void 0,this.ecg_filter_iir=void 0,this.ecg_mss_win_i=0,this.ecg_mss=0}resetACC(){this.ACCDiv=void 0,this.acc_resize=void 0,this.acc_canvas=void 0,this.acc_chart=void 0,this.acc_x_ts=void 0,this.acc_y_ts=void 0,this.acc_z_ts=void 0,this.acc_resize_observer=void 0,this.acc_lp_iir_coef=void 0,this.acc_filter_iir_coef=void 0,this.acc_x_lp_iir=void 0,this.acc_y_lp_iir=void 0,this.acc_z_lp_iir=void 0,this.acc_mag_lp_iir=void 0,this.acc_x_lp_ts=void 0,this.acc_y_lp_ts=void 0,this.acc_z_lp_ts=void 0,this.acc_rho_ts=void 0,this.acc_phi_ts=void 0,this.acc_theta_ts=void 0,this.acc_mag_ts=void 0}onBodypartSelect=t=>{let i=t.target.selectedIndex;for(let d=0;d<r.polarVisRows.length;d++){let a=r.polarVisRows[d];a!==this&&a.polarH10===this.polarH10&&(a.bodypartSelect.selectedIndex=i)}};onCustomBodyPart=t=>{let i=t.target.value;for(let d=0;d<r.polarVisRows.length;d++){let a=r.polarVisRows[d];a.customBodyPart=i,a.polarH10===this.polarH10&&a.customBodyPartSpan!==void 0&&(a.customBodyPartSpan.textContent=i,a.customBodyPartInput.value=i)}if(i.length===0)for(let d=0;d<r.polarVisRows.length;d++){let a=r.polarVisRows[d];a.polarH10===this.polarH10&&(a.customBodyPartSpan?.classList.add("hide"),a.bodypartSelect?.classList.remove("hide"))}else for(let d=0;d<r.polarVisRows.length;d++){let a=r.polarVisRows[d];a.polarH10===this.polarH10&&(a.customBodyPartSpan?.classList.remove("hide"),a.bodypartSelect?.classList.add("hide"))}};async initDeviceInfo(){this.deviceInfoDiv=T("deviceInfoDiv",this.optionDiv,["device-info"]),this.disconnectDiv=T("disconnectDiv",void 0,["flexbox","disconnect"]),this.disBtn=ve("delete","distBtn",this.disconnectDiv,!1,this.disconnectPolarH10,["btn","btn-primary","btn-sm","s-circle"]),ie(this.disBtn,"disconnect","top"),this.battLvl=await this.polarH10.getBatteryLevel(),this.optionDiv.removeChild(this.loadingDiv),this.optionDiv.removeChild(this.nameDiv),this.optionDiv.classList.remove("center"),this.nameDiv.textContent="",this.nameDiv.classList.add("flex"),this.deviceNameDiv=T("devicename",this.nameDiv,["flexbox"],this.deviceName);let t;this.battLvl>Dt?t=`\u{1F50B}${this.battLvl}%`:t=`\u{1FAAB}${this.battLvl}%`,this.battLvlDiv=T("battLvl",this.nameDiv,["flexbox","small-mid-text"],t),this.nameDiv.classList.add("flexbox"),this.deviceInfoDiv.appendChild(this.disconnectDiv),this.deviceInfoDiv.appendChild(this.nameDiv),this.optionDiv.appendChild(this.deviceInfoDiv),this.dataInfo=T("dataInfo",this.deviceInfoDiv,["data-info"]),this.extraDataCtrl=T("extraDataCtrl",this.optionDiv,["extra-data-ctrl","center"]),this.filterConfigBtn=ve("settings","filterConfigBtn",this.extraDataCtrl,!0,this.toggleVisConfig,["btn","btn-sm"]),this.showVisConfig&&this.filterConfigBtn.classList.add("btn-primary"),ie(this.filterConfigBtn,"settings, work-in-progress","left"),this.show3DBtn=ve("view_in_ar","show3DBtn",this.extraDataCtrl,!0,void 0,["btn","btn-sm"]),this.show3DBtn.disabled=!0,ie(this.show3DBtn,"3D Tilt, work-in-progress","left"),this.rowOrder=T("rowOrder",this.optionDiv,["row-order"]),this.orderUpBtn=ve("arrow-up","orderUpBtn",this.rowOrder,!1,this.moveUp,["btn","btn-primary","btn-sm"]),ie(this.orderUpBtn,"Move up","right"),this.orderUpBtn.disabled=r.polarVisRows.length<1,ie(this.orderUpBtn,"Move up","right"),this.orderDownBtn=ve("arrow-down","orderDownBtn",this.rowOrder,!1,this.moveDown,["btn","btn-primary","btn-sm"]),ie(this.orderDownBtn,"Move down","right"),this.orderDownBtn.disabled=!0,r.polarVisRows.length>0&&(r.polarVisRows[r.polarVisRows.length-1].orderDownBtn.disabled=!1),this.bodypartLabel=T("bodypartLabel",this.dataInfo,["bodypart-text"],"Bodypart:"),this.bodypartSelectDiv=T("bodypartSelectDiv",this.dataInfo,["bodypart-select"]),this.bodypartSelect=j("bodypartSelect",this.bodypartSelectDiv,["form-select","dark-input","select-sm","almost-full-width"],"",Rt,void 0,k),this.bodypartSelect.addEventListener("change",this.onBodypartSelect),this.customBodyPartSpan=H("customBodyPartSpan",this.bodypartSelectDiv,["hide","hide-overflow"],this.customBodyPart),this.dataCtrl=T("dataCtrl",this.optionDiv,["data-ctrl"]),this.visContainerDiv=T("visContainer",this.polarSensorDiv,["visContainer"]),this.visConfigDiv=T("visConfigDiv",this.polarSensorDiv,["visContainer"]),this.showVisConfig?this.visContainerDiv.classList.add("hide"):this.visConfigDiv.classList.add("hide"),this.initVisConfigDiv()}onECGStreamDelayChange=t=>{t.target.valueAsNumber<ue?(t.target.valueAsNumber=ue,t.target.value=ue.toString()):t.target.valueAsNumber>fe&&(t.target.valueAsNumber=fe,t.target.value=fe.toString()),this.ecg_stream_delay=t.target.valueAsNumber,this.ECGStreamDelayInput!==void 0&&(this.ECGStreamDelayInput.value=t.target.value),this.ecg_chart!==void 0&&"delay"in this.ecg_chart&&(this.ecg_chart.stop(),this.ecg_chart.delay=this.ecg_stream_delay,this.ecg_chart.start())};onECGRMSWinInput=t=>{let i=parseFloat(t.target.value);i<Le&&(i=Le),i>Fe&&(i=Fe),this.ecg_rms_window_ms=i,this.updateECGRMSWinSize(),this.updateECGRMSWin(),this.ecgFilterSelectGraphRestart()};onACCStreamDelayChange=t=>{t.target.valueAsNumber<me?(t.target.valueAsNumber=me,t.target.value=me.toString()):t.target.valueAsNumber>Ce&&(t.target.valueAsNumber=Ce,t.target.value=Ce.toString()),this.acc_stream_delay=t.target.valueAsNumber,this.ACCStreamDelayInput!==void 0&&(this.ACCStreamDelayInput.value=t.target.value),this.acc_chart!==void 0&&"delay"in this.acc_chart&&(this.acc_chart.stop(),this.acc_chart.delay=this.acc_stream_delay,this.acc_chart.start())};onECGMPPChange=t=>{t.target.valueAsNumber<pe?(t.target.valueAsNumber=pe,t.target.value=pe.toString()):t.target.valueAsNumber>_e&&(t.target.valueAsNumber=_e,t.target.value=_e.toString()),this.ecg_millis_per_px=t.target.valueAsNumber,this.ECGstreamMPPInput!==void 0&&(this.ECGstreamMPPInput.value=t.target.value),this.ecg_chart!==void 0&&(this.ecg_chart.stop(),this.ecg_chart.options.millisPerPixel=this.ecg_millis_per_px,this.ecg_chart.start())};onACCMPPChange=t=>{t.target.valueAsNumber<ge?(t.target.valueAsNumber=ge,t.target.value=ge.toString()):t.target.valueAsNumber>Se&&(t.target.valueAsNumber=Se,t.target.value=Se.toString()),this.acc_millis_per_px=t.target.valueAsNumber,this.ACCstreamMPPInput!==void 0&&(this.ACCstreamMPPInput.value=t.target.value),this.acc_chart!==void 0&&(this.acc_chart.stop(),this.acc_chart.options.millisPerPixel=this.acc_millis_per_px,this.acc_chart.start())};onACCRangeSelect=async t=>{let i=t.target.selectedIndex,d=ye[i];for(let a=0;a<r.polarVisRows.length;a++){let s=r.polarVisRows[a];s.polarH10===this.polarH10&&(s.ACCRangeSelect!==void 0&&(s.ACCRangeSelect.selectedIndex=i),s.acc_range_g=d,s.initACCFilterSettings())}await this.restartAllACC()};onACCSampleRateSelect=async t=>{let i=t.target.selectedIndex,d=Pe[i];for(let a=0;a<r.polarVisRows.length;a++){let s=r.polarVisRows[a];s.polarH10===this.polarH10&&(s.ACCSampleRateSelect!==void 0&&(s.ACCSampleRateSelect.selectedIndex=i),s.acc_sample_rate_hz=d,s.initACCFilterSettings())}await this.restartAllACC()};onECGFilterType=t=>{let i=t.target.selectedIndex;i===2?(this.ecg_filter_info.Fl=Z,this.ecg_filter_info.Fh=Q,this.ecg_filter_info.BW=Q-Z,this.ecg_filter_info.Fc=Math.sqrt(Z*Q),this.ECGFilterLowCutInput!==void 0&&(this.ECGFilterLowCutInput.value=Z.toString()),this.ECGFilterHighCutInput!==void 0&&(this.ECGFilterHighCutInput.value=Q.toString())):(this.ecg_filter_info.Fc=De,this.ECGFilterCutoffInput!==void 0&&(this.ECGFilterCutoffInput.value=De.toString())),this.ECGFilterCutoffInput!==void 0&&(i===2?this.ECGFilterCutoffInput.classList.add("hide"):this.ECGFilterCutoffInput.classList.remove("hide")),this.ECGFilterLowCutInput!==void 0&&(i===2?this.ECGFilterLowCutInput.classList.remove("hide"):this.ECGFilterLowCutInput.classList.add("hide")),this.ECGFilterHighCutInput!==void 0&&(i===2?this.ECGFilterHighCutInput.classList.remove("hide"):this.ECGFilterHighCutInput.classList.add("hide"));let d=Be[i];this.ecg_filter_info.type=d,this.ecgFilterSelectGraphRestart()};onECGFilterOrder=t=>{let i=parseInt(t.target.value);i<1&&(i=1),i>12&&(i=12),this.ecg_filter_info.order=i,this.ecgFilterSelectGraphRestart()};onECGFilterChar=t=>{let i=t.target.selectedIndex,d=Ve[i];this.ecg_filter_info.characteristic=d,this.ecgFilterSelectGraphRestart()};onECGFilterCutoff=t=>{let i=parseFloat(t.target.value);this.ecg_filter_info.Fc=i,this.ecgFilterSelectGraphRestart()};onECGFilterLowCutoff=t=>{let i=parseFloat(t.target.value);this.ecg_filter_info.Fh!==void 0&&i>=this.ecg_filter_info.Fh&&(i=this.ecg_filter_info.Fh-q),i>he&&(i=U),i<U&&(i=U),this.ecg_filter_info.Fl=i,this.updateBandpass(this.ecg_filter_info),this.ECGFilterHighCutInput!==void 0&&(this.ECGFilterHighCutInput.min=(i+q).toString()),this.ecgFilterSelectGraphRestart()};onECGFilterHighCutoff=t=>{let i=parseFloat(t.target.value);this.ecg_filter_info.Fl!==void 0&&i<=this.ecg_filter_info.Fl&&(i=this.ecg_filter_info.Fl+q),i>he&&(i=U),i<U&&(i=U),this.ecg_filter_info.Fh=i,this.updateBandpass(this.ecg_filter_info),this.ECGFilterLowCutInput!==void 0&&(this.ECGFilterLowCutInput.max=(i-q).toString()),this.ecgFilterSelectGraphRestart()};ecgFilterSelectGraphRestart(){this.ecgFilterCoefReset();let t=this.ECGFormSelect.selectedIndex,i=this.ECGFormSelect.disabled;this.generateECGFormSelect(),this.ECGFormSelect.disabled=i,this.ECGFormSelect.selectedIndex=t,t===1&&this.changeECGGraph({target:{selectedIndex:t}})}ecgFilterCoefReset(){this.ecg_filter_iir_coef=ut[this.ecg_filter_info.type](this.ecg_filter_info),this.ecg_filter_iir=(0,B.IirFilter)(this.ecg_filter_iir_coef)}async restartAllACC(){let t=[];for(let i=0;i<r.polarVisRows.length;i++){let d=r.polarVisRows[i];d.polarH10===this.polarH10&&d.ACCIsOn()&&(await d.onToggleACC({target:{checked:!1}}),t.push(d))}for(let i=0;i<t.length;i++)await t[i].onToggleACC({target:{checked:!0}})}initVisConfigDiv(){this.ECGConfigDiv=T("ECGConfigDiv",this.visConfigDiv,["float-left","almost-full-height","config-div","half-width","flexbox","flex-col"]);let t=T("ECGChartConfigTitleRow",this.ECGConfigDiv,["full-width","flexbox"]);T("ECGChartConfigTitle",t,["fourty-width","center","bold-text"],"EXG Visualization Configs");let i=T("customBodypartInputDiv",t,["sixty-width","flexbox"]),d=H("customBodypartSpan",i,["padright-5px","padleft-5px"],"Custom Bodypart:");this.customBodyPartInput=qi("customBodyPartInput",i,["dark-input","custom-bodypart-input-width"]),this.customBodyPartInput.addEventListener("input",this.onCustomBodyPart),this.ECGChartConfigDiv=T("ECGChartConfigDiv",this.ECGConfigDiv,["full-width","flexbox"]);let a=T("ECGChartStreamDelay",this.ECGChartConfigDiv,["full-width","flexbox"]);H("ECGStreamDelayLabel",a,["padright-5px","padleft-5px"],"Delay (ms):"),this.ECGStreamDelayInput=W("ECGStreamDelayInput",a,["marginright-15px","dark-input","input-width-4_5"],ue,fe,Ut,this.ecg_stream_delay),this.ECGStreamDelayInput.addEventListener("change",this.onECGStreamDelayChange),H("ECGStreamDelayLabel",a,["padright-5px","padleft-5px"],"Data width (ms/px):"),this.ECGstreamMPPInput=W("ECGStreamMPPInput",a,["marginright-15px","dark-input","input-width-3_5"],pe,_e,Wt,this.ecg_millis_per_px),this.ECGstreamMPPInput.addEventListener("change",this.onECGMPPChange),H("ECGSRMSLabel",a,["padright-5px","padleft-5px"],"RMS window (ms): "),this.ECGRMSWinInput=W("ECGRMSWinInput",a,["marginright-15px","dark-input","input-width-4_5"],Le,Fe,Ot,this.ecg_rms_window_ms),this.ECGRMSWinInput.addEventListener("change",this.onECGRMSWinInput),this.ECGFilterConfigDiv=T("ECGFilterConfigDiv",this.ECGConfigDiv,["full-width","flexbox"]),H("ECGFilterTypeSpan",this.ECGFilterConfigDiv,["padleft-5px","padright-5px"],"Filter Type:"),this.ECGFilterTypesSelect=j("ECGFilterTypesSelect",this.ECGFilterConfigDiv,["form-select","dark-input","select-sm","filter-type-width"],"",Be,Be.indexOf(this.ecg_filter_info.type)),this.ECGFilterTypesSelect.addEventListener("change",this.onECGFilterType),H("ECGFilterCharSpan",this.ECGFilterConfigDiv,["padleft-5px","padright-5px"],"Filter Char:"),this.ECGFilteCharSelect=j("ECGFilteCharSelect",this.ECGFilterConfigDiv,["form-select","dark-input","select-sm","filter-char-width"],"",Ve,Ve.indexOf(this.ecg_filter_info.characteristic)),this.ECGFilteCharSelect.addEventListener("change",this.onECGFilterChar),H("ECGFilterOrderSpan",this.ECGFilterConfigDiv,["padleft-5px","padright-5px"],"Order:"),this.ECGFilterOrderInput=W("ECGFilterOrderInput",this.ECGFilterConfigDiv,["dark-input","input-width-3_5"],1,12,1,this.ecg_filter_info.order),H("ECGFilterCutoffSpan",this.ECGFilterConfigDiv,["padleft-5px","padright-5px"],"Cutoff (Hz):"),this.ECGFilterCutoffInput=W("ECGFilterCutoffInput",this.ECGFilterConfigDiv,["dark-input","freq-input-width"],U,he,q,this.ecg_filter_info.Fc),this.ECGFilterCutoffInput.addEventListener("change",this.onECGFilterCutoff),this.ECGFilterLowCutInput=W("ECGFilterLowCutInput",this.ECGFilterConfigDiv,["margin-left-right-5","dark-input","freq-input-width","hide"],U,this.ecg_filter_info.Fh,q,this.ecg_filter_info.Fl),this.ECGFilterLowCutInput.addEventListener("change",this.onECGFilterLowCutoff),this.ECGFilterHighCutInput=W("ECGFilterHighCutInput",this.ECGFilterConfigDiv,["margin-left-right-5","dark-input","freq-input-width","hide"],this.ecg_filter_info.Fl,he,q,this.ecg_filter_info.Fh),this.ECGFilterHighCutInput.addEventListener("change",this.onECGFilterHighCutoff),this.ECGFilterTypesSelect.selectedIndex===2&&(this.ECGFilterCutoffInput.classList.add("hide"),this.ECGFilterLowCutInput.classList.remove("hide"),this.ECGFilterHighCutInput.classList.remove("hide")),this.ECGRMSConfigDiv=T("ECGRMSConfigDiv",this.ECGConfigDiv,["full-width"]),this.ACCConfigDiv=T("ACCConfigDiv",this.visConfigDiv,["float-left","almost-full-height","config-div","half-width","flexbox","flex-col"]);let s=T("ECGChartConfigTitleRow",this.ACCConfigDiv,["full-width","flexbox"]);T("ACCChartConfigTitle",s,["half-width","center","bold-text"],"Accelerometer Visualization Configs");let h=T("ACCSampleRateRange",s,["half-width"]),o=H("ACCSampleRateSpan",h,["padright-5px","padleft-5px"],"Fs (Hz):");this.ACCSampleRateSelect=j("ACCSampleRateSelect",h,["form-select","dark-input","select-sm","input-width-4_5"],"",Pe,Pe.indexOf(this.acc_sample_rate_hz)),this.ACCSampleRateSelect.addEventListener("change",this.onACCSampleRateSelect);let e=H("ACCRangeSpan",h,["padright-5px","padleft-5px"],"Range (\xB1G):");this.ACCRangeSelect=j("ACCRangeSelect",h,["form-select","dark-input","select-sm","input-width-3_5"],"",ye,ye.indexOf(this.acc_range_g)),this.ACCRangeSelect.addEventListener("change",this.onACCRangeSelect),this.ACCChartConfigDiv=T("ACCChartConfigDiv",this.ACCConfigDiv,["full-width","flexbox"]);let n=T("ACCDisplaySettingsDiv",this.ACCChartConfigDiv,["full-width","flexbox"]);H("ACCStreamDelayLabel",n,["padright-5px","padleft-5px"],"Delay (ms):"),this.ACCStreamDelayInput=W("ACCStreamDelayInput",n,["marginright-15px","dark-input","input-width-4_5"],me,Ce,Yt,this.acc_stream_delay),this.ACCStreamDelayInput.addEventListener("change",this.onACCStreamDelayChange),H("ACCStreamDelayLabel",n,["padright-5px","padleft-5px"],"Data width (ms/px):"),this.ACCstreamMPPInput=W("ACCSteamMPPInput",n,["marginright-15px","dark-input","input-width-3_5"],ge,Se,$t),this.ACCstreamMPPInput.value=this.acc_millis_per_px.toString(),this.ACCstreamMPPInput.addEventListener("change",this.onACCMPPChange),this.ACCHPConfigDiv=T("ACCHPConfigDiv",this.ACCConfigDiv,["full-width"]),this.ACCRMSConfigDiv=T("ACCRMSConfigDiv",this.ACCConfigDiv,["full-width"])}async initDeviceGraphCtrl(){this.ECGCtrlDiv=T("ECGCtrlDiv",this.dataCtrl,["half-width"]);let t=pi("EXG",this.onToggleECG);this.ECGCtrlDiv.appendChild(t),this.ECGSwitchInput=t.children.item(0),this.ECGDropDown=T("ECGDropDownDiv",this.ECGCtrlDiv,["form-group"]),this.generateECGFormSelect(),this.ACCCtrlDiv=T("ACCCtrlDiv",this.dataCtrl,["half-width"]);let i=pi("ACC",this.onToggleACC);this.ACCCtrlDiv.appendChild(i),this.ACCSwitchInput=i.children.item(0),this.ACCDropDown=T("ACCDropDownDiv",this.ACCCtrlDiv,["form-group"]),this.generateACCFormSelect()}generateECGFormSelect(t=0,i=!0){this.ECGFormSelect!==void 0&&this.ECGFormSelect.parentElement?.removeChild(this.ECGFormSelect),this.ECGFormSelect=j("ECGFormSelect",this.ECGDropDown,["form-select","dark-input","select-sm","almost-full-width"],"",["Raw",_t(this.ecg_filter_info),`${this.ecg_rms_window_ms}ms RMS`],t),this.ECGFormSelect.onchange=this.changeECGGraph,this.ECGFormSelect.disabled=i}generateACCFormSelect(t=0,i=!0){this.ACCFormSelect!==void 0&&this.ACCFormSelect.parentElement?.removeChild(this.ACCFormSelect),this.ACCFormSelect=j("ACCFormSelect",this.ACCDropDown,["form-select","dark-input","select-sm","almost-full-width"],"",["Raw",_t(this.acc_lp_info),"Tilt",_t(this.acc_filter_info)],t),this.ACCFormSelect.onchange=this.changeACCGraph,this.ACCFormSelect.disabled=i}async startECG(t=te,i=!0){if(this.includesDuplicate("device",mi)<0)try{let a=await this.polarH10.startECG(t);a?.error==="SUCCESS"||a?.error==="ALREADY IN STATE"?i&&this.polarH10.addEventListener("ECG",this.newECGCallback):(console.log(a),this.disconnectPolarH10())}catch(a){alert(a),this.disconnectPolarH10()}else this.polarH10.addEventListener("ECG",this.newECGCallback)}async stopECG(){if(this.includesDuplicate("device",mi)<0)try{let i=await this.polarH10.stopECG();i&&console.log(i)}catch(i){console.log(i),alert(i),i.name==="NetworkError"&&this.disconnectPolarH10()}}async startACC(t=nt,i=it,d=!0){if(this.includesDuplicate("device",Ci)<0)try{let s=await this.polarH10.startACC(t,i);s?.error==="SUCCESS"||s?.error==="ALREADY IN STATE"?d&&this.polarH10.addEventListener("ACC",this.newACCCallback):(console.log(s),this.disconnectPolarH10())}catch(s){alert(s),this.disconnectPolarH10()}else this.polarH10.addEventListener("ACC",this.newACCCallback)}async stopAcc(){if(this.includesDuplicate("device",Ci)<0)try{let i=await this.polarH10.stopACC();i&&console.log(i)}catch(i){console.log(i),alert(i),i.name==="NetworkError"&&this.disconnectPolarH10()}}ECGIsOn(){return this.ECGDiv!==void 0}ACCIsOn(){return this.ACCDiv!==void 0}};function fi(r,t,i,d=!1){return()=>{let s=r.canvas,h=s.parentNode,o=h.offsetWidth,e=h.offsetHeight,n=o*t,c=e*i;s.width=n-5,s.height=c,d&&console.log(`Resize at ${new Date().valueOf()} parent: ${h.id} ${h.offsetWidth} ${s.width} ${h.offsetHeight} ${s.height}`)}}function pi(r,t,i=k){let d=document.createElement("label");d.setAttribute("class","form-switch"),d.classList.add("label-sm");let a=document.createElement("input");a.id=`${r}-onoff-${i()}`,a.type="checkbox",a.addEventListener("change",t),a.classList.add("input-sm");let s=document.createElement("i");return s.classList.add("form-icon"),d.textContent=r,d.appendChild(a),d.appendChild(s),d}function j(r,t=void 0,i=[],d="",a=[],s=void 0,h=k){let o=document.createElement("select");return ne(o,r,t,i,d,h),$i(o,a,h),s!==void 0&&(o.selectedIndex=s),o}function $i(r,t,i=k){for(let d=0;d<t.length;d++){let a=t[d],s=document.createElement("option");s.id=`${r.id}-${d}-${i()}`,s.textContent=a.toString(),r.appendChild(s)}}function T(r,t=void 0,i=[],d="",a=k){let s=document.createElement("div");return ne(s,r,t,i,d,a),s}function W(r,t=void 0,i=[],d=0,a=100,s=1,h=1,o="",e=k){let n=document.createElement("input");return ne(n,r,t,["form-input","input-sm",...i],o,e),n.setAttribute("type","number"),n.setAttribute("min",d.toString()),n.setAttribute("max",a.toString()),n.setAttribute("step",s.toString()),n.setAttribute("value",h.toString()),n}function qi(r,t=void 0,i=[],d="",a=k){let s=document.createElement("input");return ne(s,r,t,["form-input","input-sm",...i],d,a),s.setAttribute("type","text"),s}function H(r,t=void 0,i=[],d="",a=k){let s=document.createElement("span");return ne(s,r,t,i,d,a),s}function _i(r,t=void 0,i=[],d="",a=k){let s=document.createElement("canvas");return ne(s,r,t,i,d,a),s}function ne(r,t,i=void 0,d=[],a="",s=k){return r.id=`${t}-${s()}`,i&&i.appendChild(r),d.length>0&&r.classList.add(...d),a.length>0&&(r.textContent=a),r}function k(){return ke.polarRowID}function mi(r){return r.ECGDiv!==void 0}function Ci(r){return r.ACCDiv!==void 0}function ie(r,t,i="top"){r.setAttribute("data-tooltip",t),r.classList.add("tooltip",`tooltip-${i}`)}function ve(r,t=void 0,i=void 0,d=!1,a=void 0,s=[],h=k){let o=document.createElement("button");t&&(o.id=`${t}-${h()}`),o.classList.add("flexbox","center");let e=document.createElement("i");return d?(e.classList.add("material-icons"),e.textContent=r):e.classList.add("icon",`icon-${r}`),o.appendChild(e),s.length>0&&o.classList.add(...s),a&&(o.onclick=a),i&&i.appendChild(o),o}function ft(r){return typeof r!="string"||r.length===0?r:r.charAt(0).toUpperCase()+r.slice(1)}function pt(r,t=!0){let i="";return r.type==="lowpass"||r.type==="highpass"?i=`${r.type} (${Number.isInteger(r.Fc)?r.Fc:r.Fc?.toFixed(1)}Hz ${r.order} order ${ft(r.characteristic)})`:i=`bandpass (${Number.isInteger(r.Fl)?r.Fl:r.Fl?.toFixed(1)}-${Number.isInteger(r.Fh)?r.Fh:r.Fh?.toFixed(1)}Hz ${r.order} order ${ft(r.characteristic)})`,t&&(i=ft(i)),i}function _t(r){let t="";return r.type==="lowpass"||r.type==="highpass"?t=`${Number.isInteger(r.Fc)?r.Fc:r.Fc?.toFixed(1)}Hz ${r.type}`:t=`${Number.isInteger(r.Fl)?r.Fl:r.Fl?.toFixed(1)}-${Number.isInteger(r.Fh)?r.Fh:r.Fh?.toFixed(1)}Hz ${r.type}`,t}var Ee=document.createElement("div");Ee.id="webapp_container";Ee.classList.add("container");document.body.appendChild(Ee);var Ae=document.createElement("div");Ae.id="top_bar_div";Ee.appendChild(Ae);var mt=document.createElement("h3");mt.textContent="Polar H10 raw data visualizer";mt.classList.add("title");Ae.appendChild(mt);Ae.classList.add("center");var Zi="ble_connect_btn",se=document.createElement("button");se.setAttribute("data-tooltip","Connect new Polar H10");se.id=Zi;se.classList.add("btn","btn-primary","btn-action","s-circle","ble-conn");var be=document.createElement("div");be.id="content_div";be.classList.add("flexbox","content");Ee.appendChild(be);if(navigator.bluetooth===void 0){let r=document.createElement("p");r.innerHTML=`Web Bluetooth API is not present!<br>
Please make sure you are using the latest chrome/chromium based browser.<br>
Also make sure to enable experimental-web-platform-features in your browser <a href="chrome://flags/#enable-experimental-web-platform-features">chrome://flags/#enable-experimental-web-platform-features</a> `,r.setAttribute("style","margin:5% 20%;font-size:1.4em;"),be.appendChild(r),window.stop()}var Si=document.createElement("i");Si.setAttribute("class","icon icon-plus");se.appendChild(Si);se.addEventListener("click",Qi(be,gi));Ae.appendChild(se);function Qi(r,t){return async i=>{let d;try{d=await navigator.bluetooth.requestDevice({filters:[{namePrefix:"Polar"}],optionalServices:["battery_service","fb005c80-02e7-f387-1cad-8acd2d8df0c8"]})}catch(a){console.log(a);return}t(r,d)}}
/*! Bundled license information:

smoothie/smoothie.js:
  (**
   * @license
   * MIT License:
   *
   * Copyright (c) 2010-2013, Joe Walnes
   *               2013-2018, Drew Noakes
   *
   * Permission is hereby granted, free of charge, to any person obtaining a copy
   * of this software and associated documentation files (the "Software"), to deal
   * in the Software without restriction, including without limitation the rights
   * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
   * copies of the Software, and to permit persons to whom the Software is
   * furnished to do so, subject to the following conditions:
   *
   * The above copyright notice and this permission notice shall be included in
   * all copies or substantial portions of the Software.
   *
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
   * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
   * THE SOFTWARE.
   *)

fili/dist/fili.min.js:
  (**
   * @name    fili
   * @version 2.0.3 | December 13th 2018
   * @author  Florian Markert
   * @license MIT
   *)
*/
//# sourceMappingURL=index.js.map
