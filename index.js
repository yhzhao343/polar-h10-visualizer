var Zt=Object.create;var Ye=Object.defineProperty;var Qt=Object.getOwnPropertyDescriptor;var jt=Object.getOwnPropertyNames;var Kt=Object.getPrototypeOf,Jt=Object.prototype.hasOwnProperty;var K=(n=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(n,{get:(r,o)=>(typeof require<"u"?require:r)[o]}):n)(function(n){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported')});var qe=(n,r)=>()=>(r||n((r={exports:{}}).exports,r),r.exports);var ei=(n,r,o,_)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of jt(r))!Jt.call(n,a)&&a!==o&&Ye(n,a,{get:()=>r[a],enumerable:!(_=Qt(r,a))||_.enumerable});return n};var Se=(n,r,o)=>(o=n!=null?Zt(Kt(n)):{},ei(r||!n||!n.__esModule?Ye(o,"default",{value:n,enumerable:!0}):o,n));var Ae=qe(oe=>{(function(n){Date.now=Date.now||function(){return new Date().getTime()};var r={extend:function(){arguments[0]=arguments[0]||{};for(var a=1;a<arguments.length;a++)for(var i in arguments[a])arguments[a].hasOwnProperty(i)&&(typeof arguments[a][i]=="object"?arguments[a][i]instanceof Array?arguments[0][i]=arguments[a][i]:arguments[0][i]=r.extend(arguments[0][i],arguments[a][i]):arguments[0][i]=arguments[a][i]);return arguments[0]},binarySearch:function(a,i){for(var d=0,s=a.length;d<s;){var e=d+s>>1;i<a[e][0]?s=e:d=e+1}return d},pixelSnap:function(a,i){return i%2===0?Math.round(a):Math.floor(a)+.5}};function o(a){this.options=r.extend({},o.defaultOptions,a),this.disabled=!1,this.clear()}o.defaultOptions={resetBoundsInterval:3e3,resetBounds:!0},o.prototype.clear=function(){this.data=[],this.maxValue=Number.NaN,this.minValue=Number.NaN},o.prototype.resetBounds=function(){if(this.data.length){this.maxValue=this.data[0][1],this.minValue=this.data[0][1];for(var a=1;a<this.data.length;a++){var i=this.data[a][1];i>this.maxValue&&(this.maxValue=i),i<this.minValue&&(this.minValue=i)}}else this.maxValue=Number.NaN,this.minValue=Number.NaN},o.prototype.append=function(a,i,d){if(!(isNaN(a)||isNaN(i))){var s=this.data.length-1;if(s>=0)for(var e=s;;){var t=this.data[e];if(a>=t[0]){a===t[0]?d?(t[1]+=i,i=t[1]):t[1]=i:this.data.splice(e+1,0,[a,i]);break}if(e--,e<0){this.data.splice(0,0,[a,i]);break}}else this.data.push([a,i]);this.maxValue=isNaN(this.maxValue)?i:Math.max(this.maxValue,i),this.minValue=isNaN(this.minValue)?i:Math.min(this.minValue,i)}},o.prototype.dropOldData=function(a,i){for(var d=0;this.data.length-d>=i&&this.data[d+1][0]<a;)d++;d!==0&&this.data.splice(0,d)};function _(a){this.options=r.extend({},_.defaultChartOptions,a),this.seriesSet=[],this.currentValueRange=1,this.currentVisMinValue=0,this.lastRenderTimeMillis=0,this.lastChartTimestamp=0,this.mousemove=this.mousemove.bind(this),this.mouseout=this.mouseout.bind(this)}_.tooltipFormatter=function(a,i){var d=this.options.timestampFormatter||_.timeFormatter,s=document.createElement("div"),e;s.appendChild(document.createTextNode(d(new Date(a))));for(var t=0;t<i.length;++t){e=i[t].series.options.tooltipLabel||"",e!==""&&(e=e+" ");var l=document.createElement("span");l.style.color=i[t].series.options.strokeStyle,l.appendChild(document.createTextNode(e+this.options.yMaxFormatter(i[t].value,this.options.labels.precision))),s.appendChild(document.createElement("br")),s.appendChild(l)}return s.innerHTML},_.defaultChartOptions={millisPerPixel:20,enableDpiScaling:!0,yMinFormatter:function(a,i){return parseFloat(a).toFixed(i)},yMaxFormatter:function(a,i){return parseFloat(a).toFixed(i)},yIntermediateFormatter:function(a,i){return parseFloat(a).toFixed(i)},maxValueScale:1,minValueScale:1,interpolation:"bezier",scaleSmoothing:.125,maxDataSetLength:2,scrollBackwards:!1,displayDataFromPercentile:1,grid:{fillStyle:"#000000",strokeStyle:"#777777",lineWidth:2,millisPerLine:1e3,verticalSections:2,borderVisible:!0},labels:{fillStyle:"#ffffff",disabled:!1,fontSize:10,fontFamily:"monospace",precision:2,showIntermediateLabels:!1,intermediateLabelSameAxis:!0},title:{text:"",fillStyle:"#ffffff",fontSize:15,fontFamily:"monospace",verticalAlign:"middle"},horizontalLines:[],tooltip:!1,tooltipLine:{lineWidth:1,strokeStyle:"#BBBBBB"},tooltipFormatter:_.tooltipFormatter,nonRealtimeData:!1,responsive:!1,limitFPS:0},_.AnimateCompatibility=function(){var a=function(d,s){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(function(){t(Date.now())},16)};return e.call(window,d,s)},i=function(d){var s=window.cancelAnimationFrame||function(e){clearTimeout(e)};return s.call(window,d)};return{requestAnimationFrame:a,cancelAnimationFrame:i}}(),_.defaultSeriesPresentationOptions={lineWidth:1,strokeStyle:"#ffffff"},_.prototype.addTimeSeries=function(a,i){this.seriesSet.push({timeSeries:a,options:r.extend({},_.defaultSeriesPresentationOptions,i)}),a.options.resetBounds&&a.options.resetBoundsInterval>0&&(a.resetBoundsTimerId=setInterval(function(){a.resetBounds()},a.options.resetBoundsInterval))},_.prototype.removeTimeSeries=function(a){for(var i=this.seriesSet.length,d=0;d<i;d++)if(this.seriesSet[d].timeSeries===a){this.seriesSet.splice(d,1);break}a.resetBoundsTimerId&&clearInterval(a.resetBoundsTimerId)},_.prototype.getTimeSeriesOptions=function(a){for(var i=this.seriesSet.length,d=0;d<i;d++)if(this.seriesSet[d].timeSeries===a)return this.seriesSet[d].options},_.prototype.bringToFront=function(a){for(var i=this.seriesSet.length,d=0;d<i;d++)if(this.seriesSet[d].timeSeries===a){var s=this.seriesSet.splice(d,1);this.seriesSet.push(s[0]);break}},_.prototype.streamTo=function(a,i){this.canvas=a,this.clientWidth=parseInt(this.canvas.getAttribute("width")),this.clientHeight=parseInt(this.canvas.getAttribute("height")),this.delay=i,this.start()},_.prototype.getTooltipEl=function(){return this.tooltipEl||(this.tooltipEl=document.createElement("div"),this.tooltipEl.className="smoothie-chart-tooltip",this.tooltipEl.style.pointerEvents="none",this.tooltipEl.style.position="absolute",this.tooltipEl.style.display="none",document.body.appendChild(this.tooltipEl)),this.tooltipEl},_.prototype.updateTooltip=function(){if(this.options.tooltip){var a=this.getTooltipEl();if(!this.mouseover||!this.options.tooltip){a.style.display="none";return}for(var i=this.lastChartTimestamp,d=this.options.scrollBackwards?i-this.mouseX*this.options.millisPerPixel:i-(this.clientWidth-this.mouseX)*this.options.millisPerPixel,s=[],e=0;e<this.seriesSet.length;e++){var t=this.seriesSet[e].timeSeries;if(!t.disabled){var l=r.binarySearch(t.data,d);l>0&&l<t.data.length&&s.push({series:this.seriesSet[e],index:l,value:t.data[l][1]})}}s.length?(a.innerHTML=this.options.tooltipFormatter.call(this,d,s),a.style.display="block"):a.style.display="none"}},_.prototype.mousemove=function(a){if(this.mouseover=!0,this.mouseX=a.offsetX,this.mouseY=a.offsetY,this.mousePageX=a.pageX,this.mousePageY=a.pageY,!!this.options.tooltip){var i=this.getTooltipEl();i.style.top=Math.round(this.mousePageY)+"px",i.style.left=Math.round(this.mousePageX)+"px",this.updateTooltip()}},_.prototype.mouseout=function(){this.mouseover=!1,this.mouseX=this.mouseY=-1,this.tooltipEl&&(this.tooltipEl.style.display="none")},_.prototype.resize=function(){var a=!this.options.enableDpiScaling||!window?1:window.devicePixelRatio,i,d;this.options.responsive?(i=this.canvas.offsetWidth,d=this.canvas.offsetHeight,i!==this.lastWidth&&(this.lastWidth=i,this.canvas.setAttribute("width",Math.floor(i*a).toString()),this.canvas.getContext("2d").scale(a,a)),d!==this.lastHeight&&(this.lastHeight=d,this.canvas.setAttribute("height",Math.floor(d*a).toString()),this.canvas.getContext("2d").scale(a,a)),this.clientWidth=i,this.clientHeight=d):(i=parseInt(this.canvas.getAttribute("width")),d=parseInt(this.canvas.getAttribute("height")),a!==1?(Math.floor(this.clientWidth*a)!==i&&(this.canvas.setAttribute("width",Math.floor(i*a).toString()),this.canvas.style.width=i+"px",this.clientWidth=i,this.canvas.getContext("2d").scale(a,a)),Math.floor(this.clientHeight*a)!==d&&(this.canvas.setAttribute("height",Math.floor(d*a).toString()),this.canvas.style.height=d+"px",this.clientHeight=d,this.canvas.getContext("2d").scale(a,a))):(this.clientWidth=i,this.clientHeight=d))},_.prototype.start=function(){if(!this.frame){this.canvas.addEventListener("mousemove",this.mousemove),this.canvas.addEventListener("mouseout",this.mouseout);var a=function(){this.frame=_.AnimateCompatibility.requestAnimationFrame(function(){if(this.options.nonRealtimeData){var i=new Date(0),d=this.seriesSet.reduce(function(s,e){var t=e.timeSeries.data,l=Math.round(this.options.displayDataFromPercentile*t.length)-1;if(l=l>=0?l:0,l=l<=t.length-1?l:t.length-1,t&&t.length>0){var u=t[l][0];s=s>u?s:u}return s}.bind(this),i);this.render(this.canvas,d>i?d:null)}else this.render();a()}.bind(this))}.bind(this);a()}},_.prototype.stop=function(){this.frame&&(_.AnimateCompatibility.cancelAnimationFrame(this.frame),delete this.frame,this.canvas.removeEventListener("mousemove",this.mousemove),this.canvas.removeEventListener("mouseout",this.mouseout))},_.prototype.updateValueRange=function(){for(var a=this.options,i=Number.NaN,d=Number.NaN,s=0;s<this.seriesSet.length;s++){var e=this.seriesSet[s].timeSeries;e.disabled||(isNaN(e.maxValue)||(i=isNaN(i)?e.maxValue:Math.max(i,e.maxValue)),isNaN(e.minValue)||(d=isNaN(d)?e.minValue:Math.min(d,e.minValue)))}if(a.maxValue!=null?i=a.maxValue:i*=a.maxValueScale,a.minValue!=null?d=a.minValue:d-=Math.abs(d*a.minValueScale-d),this.options.yRangeFunction){var t=this.options.yRangeFunction({min:d,max:i});d=t.min,i=t.max}if(!isNaN(i)&&!isNaN(d)){var l=i-d,u=l-this.currentValueRange,h=d-this.currentVisMinValue;this.isAnimatingScale=Math.abs(u)>.1||Math.abs(h)>.1,this.currentValueRange+=a.scaleSmoothing*u,this.currentVisMinValue+=a.scaleSmoothing*h}this.valueRange={min:d,max:i}},_.prototype.render=function(a,i){var d=Date.now();if(!(this.options.limitFPS>0&&d-this.lastRenderTimeMillis<1e3/this.options.limitFPS)){if(i=(i||d)-(this.delay||0),i-=i%this.options.millisPerPixel,!this.isAnimatingScale){var s=this.lastChartTimestamp===i;if(s){var e=d-this.lastRenderTimeMillis>166.66666666666666;if(!e)return}}this.lastRenderTimeMillis=d,this.lastChartTimestamp=i,this.resize(),a=a||this.canvas;var t=a.getContext("2d"),l=this.options,u={top:0,left:0,width:this.clientWidth,height:this.clientHeight},h=i-u.width*l.millisPerPixel,C=function(G,V){var z=G-this.currentVisMinValue,$=this.currentValueRange===0?u.height:u.height*(1-z/this.currentValueRange);return r.pixelSnap($,V)}.bind(this),E=function(G,V){var z=l.scrollBackwards?(i-G)/l.millisPerPixel:u.width-(i-G)/l.millisPerPixel;return r.pixelSnap(z,V)};if(this.updateValueRange(),t.font=l.labels.fontSize+"px "+l.labels.fontFamily,t.save(),t.translate(u.left,u.top),t.beginPath(),t.rect(0,0,u.width,u.height),t.clip(),t.save(),t.fillStyle=l.grid.fillStyle,t.clearRect(0,0,u.width,u.height),t.fillRect(0,0,u.width,u.height),t.restore(),t.save(),t.lineWidth=l.grid.lineWidth,t.strokeStyle=l.grid.strokeStyle,l.grid.millisPerLine>0){t.beginPath();for(var f=i-i%l.grid.millisPerLine;f>=h;f-=l.grid.millisPerLine){var T=E(f,l.grid.lineWidth);t.moveTo(T,0),t.lineTo(T,u.height)}t.stroke(),t.closePath()}for(var I=1;I<l.grid.verticalSections;I++){var b=r.pixelSnap(I*u.height/l.grid.verticalSections,l.grid.lineWidth);t.beginPath(),t.moveTo(0,b),t.lineTo(u.width,b),t.stroke(),t.closePath()}if(l.grid.borderVisible&&(t.beginPath(),t.strokeRect(0,0,u.width,u.height),t.closePath()),t.restore(),l.horizontalLines&&l.horizontalLines.length)for(var S=0;S<l.horizontalLines.length;S++){var M=l.horizontalLines[S],p=M.lineWidth||1,m=C(M.value,p);t.strokeStyle=M.color||"#ffffff",t.lineWidth=p,t.beginPath(),t.moveTo(0,m),t.lineTo(u.width,m),t.stroke(),t.closePath()}for(var c=0;c<this.seriesSet.length;c++){var R=this.seriesSet[c].timeSeries,v=R.data;if(R.dropOldData(h,l.maxDataSetLength),!(v.length<=1||R.disabled)){t.save();var g=this.seriesSet[c].options,A=g.strokeStyle&&g.strokeStyle!=="none",w=A?g.lineWidth:0;t.beginPath();var D=E(v[0][0],w),x=C(v[0][1],w),P=D,N=x,y;switch(t.moveTo(D,x),g.interpolation||l.interpolation){case"linear":case"line":{y=function(G,V,z,$){t.lineTo(G,V)};break}case"bezier":default:{y=function(G,V,z,$){t.bezierCurveTo(Math.round((z+G)/2),$,Math.round(z+G)/2,V,G,V)};break}case"step":{y=function(G,V,z,$){t.lineTo(G,$),t.lineTo(G,V)};break}}for(var B=1;B<v.length;B++){var W=v[B],j=E(W[0],w),We=C(W[1],w);y(j,We,P,N),P=j,N=We}A&&(t.lineWidth=g.lineWidth,t.strokeStyle=g.strokeStyle,t.stroke()),g.fillStyle&&(t.lineTo(P,u.height+w+1),t.lineTo(D,u.height+w+1),t.fillStyle=g.fillStyle,t.fill()),t.restore()}}l.tooltip&&this.mouseX>=0&&(t.lineWidth=l.tooltipLine.lineWidth,t.strokeStyle=l.tooltipLine.strokeStyle,t.beginPath(),t.moveTo(this.mouseX,0),t.lineTo(this.mouseX,u.height),t.closePath(),t.stroke()),this.updateTooltip();var k=l.labels;if(!k.disabled&&!isNaN(this.valueRange.min)&&!isNaN(this.valueRange.max)){var $e=l.yMaxFormatter(this.valueRange.max,k.precision),re=l.yMinFormatter(this.valueRange.min,k.precision),zt=l.scrollBackwards?0:u.width-t.measureText($e).width-2,Ut=l.scrollBackwards?0:u.width-t.measureText(re).width-2;t.fillStyle=k.fillStyle,t.fillText($e,zt,k.fontSize),t.fillText(re,Ut,u.height-2)}if(k.showIntermediateLabels&&!isNaN(this.valueRange.min)&&!isNaN(this.valueRange.max)&&l.grid.verticalSections>0)for(var Xt=(this.valueRange.max-this.valueRange.min)/l.grid.verticalSections,Wt=u.height/l.grid.verticalSections,I=1;I<l.grid.verticalSections;I++){var b=u.height-Math.round(I*Wt),me=l.yIntermediateFormatter(this.valueRange.min+I*Xt,k.precision),$t=k.intermediateLabelSameAxis?l.scrollBackwards?0:u.width-t.measureText(me).width-2:l.scrollBackwards?u.width-t.measureText(me).width-2:0;t.fillText(me,$t,b-l.grid.lineWidth)}if(l.timestampFormatter&&l.grid.millisPerLine>0)for(var ve=l.scrollBackwards?t.measureText(re).width:u.width-t.measureText(re).width+4,f=i-i%l.grid.millisPerLine;f>=h;f-=l.grid.millisPerLine){var T=E(f,0);if(!l.scrollBackwards&&T<ve||l.scrollBackwards&&T>ve){var Yt=new Date(f),Ce=l.timestampFormatter(Yt),ge=t.measureText(Ce).width;ve=l.scrollBackwards?T+ge+2:T-ge-2,t.fillStyle=l.labels.fillStyle,l.scrollBackwards?t.fillText(Ce,T,u.height-2):t.fillText(Ce,T-ge,u.height-2)}}if(l.title.text!==""){t.font=l.title.fontSize+"px "+l.title.fontFamily;var qt=l.scrollBackwards?u.width-t.measureText(l.title.text).width-2:2;if(l.title.verticalAlign=="bottom"){t.textBaseline="bottom";var Ee=u.height}else if(l.title.verticalAlign=="middle"){t.textBaseline="middle";var Ee=u.height/2}else{t.textBaseline="top";var Ee=0}t.fillStyle=l.title.fillStyle,t.fillText(l.title.text,qt,Ee)}t.restore()}},_.timeFormatter=function(a){function i(d){return(d<10?"0":"")+d}return i(a.getHours())+":"+i(a.getMinutes())+":"+i(a.getSeconds())},n.TimeSeries=o,n.SmoothieChart=_})(oe)});var je=qe((Qe,be)=>{(function(n){if(typeof Qe=="object"&&typeof be<"u")be.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var r;r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this,r.Fili=n()}})(function(){return function n(r,o,_){function a(s,e){if(!o[s]){if(!r[s]){var t=typeof K=="function"&&K;if(!e&&t)return t(s,!0);if(i)return i(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=o[s]={exports:{}};r[s][0].call(u.exports,function(h){var C=r[s][1][h];return a(C||h)},u,u.exports,n,r,o,_)}return o[s].exports}for(var i=typeof K=="function"&&K,d=0;d<_.length;d++)a(_[d]);return a}({1:[function(n,r,o){"use strict";r.exports={CalcCascades:n("./src/calcCascades"),Fft:n("./src/fft"),FirCoeffs:n("./src/firCoeffs"),FirFilter:n("./src/firFilter"),IirCoeffs:n("./src/iirCoeffs"),IirFilter:n("./src/iirFilter"),TestFilter:n("./src/testFilter")}},{"./src/calcCascades":2,"./src/fft":3,"./src/firCoeffs":4,"./src/firFilter":5,"./src/iirCoeffs":6,"./src/iirFilter":7,"./src/testFilter":8}],2:[function(n,r,o){"use strict";var _=n("./iirCoeffs"),a=new _,i={bessel:{q:[[.57735026919],[.805538281842,.521934581669],[1.02331395383,.611194546878,.510317824749],[1.22566942541,.710852074442,.559609164796,.505991069397],[1.41530886916,.809790964842,.620470155556,.537552151325,.503912727276],[1.59465693507,.905947107025,.684008068137,.579367238641,.525936202016,.502755558204],[1.76552743493,.998998442993,.747625068271,.624777082395,.556680772868,.519027293158,.502045428643],[1.9292718407,1.08906376917,.810410302962,.671382379377,.591144659703,.542678365981,.514570953471,.501578400482],[2.08691792612,1.17637337045,.872034231424,.718163551101,.627261751983,.569890924765,.533371782078,.511523796759,.50125489338],[2.23926560629,1.26117120993,.932397288146,.764647810579,.664052481472,.598921924986,.555480327396,.526848630061,.509345928377,.501021580965],[2.38695091667,1.34368488961,.991497755204,.81060830488,.701011199665,.628878390935,.57943181849,.545207253735,.52208637596,.507736060535,.500847111042],[2.53048919562,1.42411783481,1.04937620183,.85593899901,.737862159044,.659265671705,.604435823473,.565352679646,.537608804383,.51849505465,.506508536474,.500715908905]],f3dB:[[1.27201964951],[1.60335751622,1.43017155999],[1.9047076123,1.68916826762,1.60391912877],[2.18872623053,1.95319575902,1.8320926012,1.77846591177],[2.45062684305,2.20375262593,2.06220731793,1.98055310881,1.94270419166],[2.69298925084,2.43912611431,2.28431825401,2.18496722634,2.12472538477,2.09613322542],[2.91905714471,2.66069088948,2.49663434571,2.38497976939,2.30961462222,2.26265746534,2.24005716132],[3.13149167404,2.87016099416,2.69935018044,2.57862945683,2.49225505119,2.43227707449,2.39427710712,2.37582307687],[3.33237300564,3.06908580184,2.89318259511,2.76551588399,2.67073340527,2.60094950474,2.55161764546,2.52001358804,2.50457164552],[3.52333123464,3.25877569704,3.07894353744,2.94580435024,2.84438325189,2.76691082498,2.70881411245,2.66724655259,2.64040228249,2.62723439989],[3.70566068548,3.44032173223,3.2574059854,3.11986367838,3.01307175388,2.92939234605,2.86428726094,2.81483068055,2.77915465405,2.75596888377,2.74456638588],[3.88040469682,3.61463243697,3.4292654707,3.28812274966,3.17689762788,3.08812364257,3.01720732972,2.96140104561,2.91862858495,2.88729479473,2.8674198668,2.8570800015]],f1dB:[[2.16477559371],[2.70320928596,2.41122332505],[3.25676581436,2.88822569572,2.74246238837],[3.76153580353,3.35675411406,3.14862673032,3.05646412475],[4.22174260104,3.79644757806,3.55260471864,3.41193742197,3.34673435508],[4.64584812552,4.20789257981,3.94082363122,3.76942681446,3.66549975744,3.61617359345],[5.04060395196,4.5944592201,4.3111677248,4.11836351827,3.98822359814,3.90713836715,3.86811234525],[5.41107948467,4.95951159709,4.66435804468,4.45575796102,4.30650679478,4.20286750045,4.13720522991,4.10531748119],[5.76110791853,5.30592898465,5.00182215701,4.7811081045,4.61724509926,4.49660100894,4.41131378918,4.35667671372,4.32997951075],[6.09364309488,5.63609116014,5.32506930789,5.09480346139,4.91939504255,4.78540258409,4.68493280536,4.61302286993,4.56661931366,4.54382759952],[6.41100731543,5.95195558182,5.63550073656,5.39754464742,5.21278891332,5.06801430334,4.95539684456,4.8697869429,4.80814951843,4.76793469612,4.74828032403],[6.71506056052,6.25514029778,5.9343616072,5.69011422355,5.49763642361,5.34401973764,5.22125973611,5.12485045619,5.05037962112,4.99699982231,4.96155789635,4.94441828777]]}},d={bessel:{as:[[1.3617],[1.3397,.7743],[1.2217,.9686,.5131],[1.1112,.9754,.7202,.3728],[1.0215,.9393,.7815,.5604,.2883]],bs:[[.618],[.4889,.389],[.3887,.3505,.2756],[.3162,.2979,.2621,.2087],[.265,.2549,.2351,.2059,.1665]]},butterworth:{as:[[1.4142],[1.8478,.7654],[1.9319,1.4142,.5176],[1.9616,1.6629,1.1111,.3902],[1.9754,1.782,1.4142,.908,.3129]],bs:[[1],[1,1],[1,1,1],[1,1,1,1],[1,1,1,1,1]]},tschebyscheff05:{as:[[1.3614],[2.6282,.3648],[3.8645,.7528,.1589],[5.1117,1.0639,.3439,.0885],[6.3648,1.3582,.4822,.1994,.0563]],bs:[[1.3827],[3.4341,1.1509],[6.9797,1.8573,1.0711],[11.9607,2.9365,1.4206,1.0407],[18.3695,4.3453,1.944,1.252,1.0263]]},tschebyscheff1:{as:[[1.3022],[2.5904,.3039],[3.8437,.6292,.1296],[5.1019,.8916,.2806,.0717],[6.3634,1.1399,.3939,.1616,.0455]],bs:[[1.5515],[4.1301,1.1697],[8.5529,1.9124,1.0766],[14.7608,3.0426,1.4334,1.0432],[22.7468,4.5167,1.9665,1.2569,1.0277]]},tschebyscheff2:{as:[[1.1813],[2.4025,.2374],[3.588,.4925,.0995],[4.7743,.6991,.2153,.0547],[5.9618,.8947,.3023,.1233,.0347]],bs:[[1.7775],[4.9862,1.1896],[10.4648,1.9622,1.0826],[18.151,3.1353,1.4449,1.0461],[28.0376,4.6644,1.9858,1.2614,1.0294]]},tschebyscheff3:{as:[[1.065],[2.1853,.1964],[3.2721,.4077,.0815],[4.3583,.5791,.1765,.0448],[5.4449,.7414,.2479,.1008,.0283]],bs:[[1.9305],[5.5339,1.2009],[11.6773,1.9873,1.0861],[20.2948,3.1808,1.4507,1.0478],[31.3788,4.7363,1.9952,1.2638,1.0304]]},allpass:{as:[[1.6278],[2.337,1.3506],[2.6117,2.0706,1.0967],[2.7541,2.4174,1.785,.9239],[2.8406,2.612,2.1733,1.5583,.8018]],bs:[[.8832],[1.4878,1.1837],[1.7763,1.6015,1.2596],[1.942,1.83,1.6101,1.2822],[2.049,1.9714,1.8184,1.5923,1.2877]]}},s=function(u,h){var C=[],E=0;if(h!=="fromPZ")for(u.order>12&&(u.order=12),E=0;E<u.order;E++){var f,T,I;u.transform==="matchedZ"?C.push(a.lowpassMZ({Fs:u.Fs,Fc:u.Fc,preGain:u.preGain,as:d[u.characteristic].as[u.order-1][E],bs:d[u.characteristic].bs[u.order-1][E]})):(u.characteristic==="butterworth"?(f=.5/Math.sin(Math.PI/(2*u.order)*(E+.5)),T=1):(f=i[u.characteristic].q[u.order-1][E],T=u.oneDb?i[u.characteristic].f1dB[u.order-1][E]:i[u.characteristic].f3dB[u.order-1][E]),I=h==="highpass"?u.Fc/T:u.Fc*T,h!=="bandpass"&&h!=="bandstop"||u.characteristic==="bessel"&&(I=Math.sqrt(u.order)*I/u.order),C.push(a[h]({Fs:u.Fs,Fc:I,Q:f,BW:u.BW||0,gain:u.gain||0,preGain:u.preGain||!1})))}else for(E=0;E<u.length;E++)C.push(a[h](u[E]));return C},e=function(u){return function(h){return s(h,u)}},t={},l=function(){var u=[];for(var h in a)t[h]=e(h),u.push(h);return t.available=function(){return u},t};r.exports=l},{"./iirCoeffs":6}],3:[function(n,r,o){"use strict";var _=function(a){if(!function(p){return!(p&p-1)}(a))return!1;var i={};i.length=a,i.buffer=new Float64Array(a),i.re=new Float64Array(a),i.im=new Float64Array(a),i.reI=new Float64Array(a),i.imI=new Float64Array(a),i.twiddle=new Int32Array(a),i.sinTable=new Float64Array(a-1),i.cosTable=new Float64Array(a-1);var d=2*Math.PI,s=Math.floor(Math.log(a)/Math.LN2);for(t=i.sinTable.length;t--;)i.sinTable[t]=Math.sin(d*(t/a)),i.cosTable[t]=Math.cos(d*(t/a));for(var e=a>>1,t=0,l=0;i.twiddle[t]=l,!(++t>=a);){for(s=e;s<=l;)l-=s,s>>=1;l+=s}var u=Math.PI,h=2*Math.PI,C=Math.abs,E=Math.pow,f=Math.cos,T=Math.sin,I=function(p){return T(u*p)/(u*p)},b=Math.E,S={rectangular:{calc:function(){return 1},values:[],correction:1},none:{calc:function(){return 1},values:[],correction:1},hanning:{calc:function(p,m){return .5*(1-f(h*p/(m-1)))},values:[],correction:2},hamming:{calc:function(p,m){return .54-.46*f(h*p/(m-1))},values:[],correction:1.8518999946875638},tukery:{calc:function(p,m,c){return p<c*(m-1)/2?.5*(1+f(u*(2*p/(c*(m-1))-1))):(m-1)*(1-c/2)<p?.5*(1+f(u*(2*p/(c*(m-1))-2/c+1))):1},values:[],correction:4/3},cosine:{calc:function(p,m){return T(u*p/(m-1))},values:[],correction:1.570844266360796},lanczos:{calc:function(p,m){return I(2*p/(m-1)-1)},values:[],correction:1.6964337576195783},triangular:{calc:function(p,m){return 2/(m+1)*((m+1)/2-C(p-(m-1)/2))},values:[],correction:2},bartlett:{calc:function(p,m){return 2/(m-1)*((m-1)/2-C(p-(m-1)/2))},values:[],correction:2},gaussian:{calc:function(p,m,c){return E(b,-.5*E((p-(m-1)/2)/(c*(m-1)/2),2))},values:[],correction:5/3},bartlettHanning:{calc:function(p,m){var c=h*p/(m-1);return .62-.48*C(p/(m-1)-.5)-.38*f(c)},values:[],correction:2},blackman:{calc:function(p,m,c){var R=(1-c)/2,v=c/2,g=h*p/(m-1);return R-.5*f(g)+v*f(2*g)},values:[],correction:4/3},blackmanHarris:{calc:function(p,m){var c=h*p/(m-1);return .35875-.48829*f(c)+.14128*f(2*c)-.01168*f(3*c)},values:[],correction:1.5594508635},nuttall3:{calc:function(p,m){var c=h*p/(m-1);return .375-.5*f(c)+.125*f(2*c)},values:[],correction:1.56},nuttall3a:{calc:function(p,m){var c=h*p/(m-1);return .40897-.5*f(c)+.09103*f(2*c)},values:[],correction:1.692},nuttall3b:{calc:function(p,m){var c=h*p/(m-1);return .4243801-.4973406*f(c)+.078793*f(2*c)},values:[],correction:1.7372527},nuttall4:{calc:function(p,m){var c=h*p/(m-1);return .3125-.46875*f(c)+.1875*f(2*c)-.03125*f(3*c)},values:[],correction:1.454543},nuttall4a:{calc:function(p,m){var c=h*p/(m-1);return .338946-.481973*f(c)+.161054*f(2*c)-.018027*f(3*c)},values:[],correction:1.512732763},nuttall4b:{calc:function(p,m){var c=h*p/(m-1);return .355768-.481973*f(c)+.144232*f(2*c)-.012604*f(3*c)},values:[],correction:1.55223262},nuttall4c:{calc:function(p,m){var c=h*p/(m-1);return .3635819-.4891775*f(c)+.1365995*f(2*c)-.0106411*f(3*c)},values:[],correction:1.57129067},sft3f:{calc:function(p,m){var c=h*p/(m-1);return .26526-.5*f(c)+.23474*f(2*c)},values:[],correction:1.3610238},sft4f:{calc:function(p,m){var c=h*p/(m-1);return .21706-.42103*f(c)+.28294*f(2*c)-.07897*f(3*c)},values:[],correction:1.2773573},sft5f:{calc:function(p,m){var c=h*p/(m-1);return .1881-.36923*f(c)+.28702*f(2*c)-.13077*f(3*c)+.02488*f(4*c)},values:[],correction:1.23167769},sft3m:{calc:function(p,m){var c=h*p/(m-1);return .28235-.52105*f(c)+.19659*f(2*c)},values:[],correction:1.39343451},sft4m:{calc:function(p,m){var c=h*p/(m-1);return .241906-.460841*f(c)+.2552381*f(2*c)-.041872*f(3*c)},values:[],correction:1.3190596},sft5m:{calc:function(p,m){var c=h*p/(m-1);return .209671-.407331*f(c)+.281225*f(2*c)-.092669*f(3*c)+.0091036*f(4*c)},values:[],correction:1.26529456464},nift:{calc:function(p,m){var c=h*p/(m-1);return .2810639-.5208972*f(c)+.1980399*f(2*c)},values:[],correction:1.39094182},hpft:{calc:function(p,m){var c=h*p/(m-1);return(1-1.912510941*f(c)+1.079173272*f(2*c)-.1832630879*f(3*c))/m},values:[],correction:1},srft:{calc:function(p,m){var c=h*p/(m-1);return(1-1.93*f(c)+1.29*f(2*c)-.388*f(3*c)+.028*f(4*c))/m},values:[],correction:1},hft70:{calc:function(p,m){var c=h*p/(m-1);return(1-1.90796*f(c)+1.07349*f(2*c)-.18199*f(3*c))/m},values:[],correction:1},hft95:{calc:function(p,m){var c=h*p/(m-1);return(1-1.9383379*f(c)+1.3045202*f(2*c)-.402827*f(3*c)+.0350665*f(4*c))/m},values:[],correction:1},hft90d:{calc:function(p,m){var c=h*p/(m-1);return(1-1.942604*f(c)+1.340318*f(2*c)-.440811*f(3*c)+.043097*f(4*c))/m},values:[],correction:1},hft116d:{calc:function(p,m){var c=h*p/(m-1);return(1-1.9575375*f(c)+1.4780705*f(2*c)-.6367431*f(3*c)+.1228389*f(4*c)-.0066288*f(5*c))/m},values:[],correction:1},hft144d:{calc:function(p,m){var c=h*p/(m-1);return(1-1.96760033*f(c)+1.57983607*f(2*c)-.81123644*f(3*c)+.22583558*f(4*c)-.02773848*f(5*c)+9036e-7*f(6*c))/m},values:[],correction:1},hft196d:{calc:function(p,m){var c=h*p/(m-1);return(1-1.97441842*f(c)+1.65409888*f(2*c)-.95788186*f(3*c)+.3367342*f(4*c)-.06364621*f(5*c)+.00521942*f(6*c)-10599e-8*f(7*c))/m},values:[],correction:1},hft223d:{calc:function(p,m){var c=h*p/(m-1);return(1-1.98298997309*f(c)+1.75556083063*f(2*c)-1.19037717712*f(3*c)+.56155440797*f(4*c)-.17296769663*f(5*c)+.03233247087*f(6*c)-.00324954578*f(7*c)+.0001380104*f(8*c)-132725e-11*f(9*c))/m},values:[],correction:1},hft248d:{calc:function(p,m){var c=h*p/(m-1);return(1-1.985844164102*f(c)+1.791176438506*f(2*c)-1.282075284005*f(3*c)+.667777530266*f(4*c)-.240160796576*f(5*c)+.056656381764*f(6*c)-.008134974479*f(7*c)+.00062454465*f(8*c)-19808998e-12*f(9*c)+132974e-12*f(10*c))/m},values:[],correction:1}},M=function(p){return S[p.name].values.length!==p.N?(p.n===0&&(S[p.name].values.length=0),S[p.name].values[p.n]=S[p.name].correction*S[p.name].calc(p.n,p.N,p.a),S[p.name].values[p.n]):S[p.name].values};return{forward:function(p,m){var c,R,v,g,A,w,D,x,P,N,y,B;v=i.buffer.length;var W={name:m,N:v,a:.5,n:0},j=M(W);if(typeof j=="number")for(c=0;c<v;++c)W.n=c,i.buffer[c]=p[c]*M(W);else for(c=0;c<v;++c)i.buffer[c]=p[c]*j[c];for(c=v;c--;)i.re[c]=i.buffer[i.twiddle[c]],i.im[c]=0;for(g=1;g<v;g=A)for(w=0,A=g+g,D=v/A,R=0;R<g;R++){for(x=i.cosTable[w],P=i.sinTable[w],c=R;c<v;c+=A)N=c+g,y=P*i.im[N]+x*i.re[N],B=x*i.im[N]-P*i.re[N],i.re[N]=i.re[c]-y,i.re[c]+=y,i.im[N]=i.im[c]-B,i.im[c]+=B;w+=D}return{re:i.re,im:i.im}},inverse:function(p,m){var c,R,v,g,A,w,D,x,P,N,y,B;for(v=p.length,c=v;c--;)R=i.twiddle[c],i.reI[c]=p[R],i.imI[c]=-m[R];for(g=1;g<v;g=A)for(w=0,A=g+g,D=v/A,R=0;R<g;R++){for(x=i.cosTable[w],P=i.sinTable[w],c=R;c<v;c+=A)N=c+g,y=P*i.imI[N]+x*i.reI[N],B=x*i.imI[N]-P*i.reI[N],i.reI[N]=i.reI[c]-y,i.reI[c]+=y,i.imI[N]=i.imI[c]-B,i.imI[c]+=B;w+=D}for(c=v;c--;)i.buffer[c]=i.reI[c]/v;return i.buffer},magnitude:function(p){for(var m=[],c=0;c<p.re.length;c++)m.push(Math.sqrt(p.re[c]*p.re[c]+p.im[c]*p.im[c]));return m},magToDb:function(p){for(var m=[],c=0;c<p.length;c++)m.push(20*Math.log(p[c])*Math.LOG10E);return m},phase:function(p){for(var m=[],c=0;c<p.re.length;c++)m.push(Math.atan2(p.im[c],p.re[c]));return m},windows:function(){var p=[];for(var m in S)p.push(m);return p}}};r.exports=_},{}],4:[function(n,r,o){"use strict";var _=function(){var a=function(e){var t=e.Fs,l=e.Fa,u=e.Fb,h=e.order||51,C=e.Att||100,E=function(p){for(var m=0,c=1,R=1;c>1e-6*R;)m+=2,c*=p*p/(m*m),R+=c;return R};h/2-Math.floor(h/2)==0&&h++;var f,T=(h-1)/2,I=[],b=0,S=0,M=[];for(I[0]=2*(u-l)/t,S=1;S<=T;S++)I[S]=(Math.sin(2*S*Math.PI*u/t)-Math.sin(2*S*Math.PI*l/t))/(S*Math.PI);for(b=C<21?0:C>50?.1102*(C-8.7):.5842*Math.pow(C-21,.4)+.07886*(C-21),f=E(b),S=0;S<=T;S++)M[T+S]=I[S]*E(b*Math.sqrt(1-S*S/(T*T)))/f;for(S=0;S<T;S++)M[S]=M[h-1-S];return M},i=function(e){var t=e.Fs,l=e.Fc,u=e.order,h=2*Math.PI*l/t,C=0,E=0,f=[];for(C=0;C<=u;C++)C-u/2==0?f[C]=h:(f[C]=Math.sin(h*(C-u/2))/(C-u/2),f[C]*=.54-.46*Math.cos(2*Math.PI*C/u)),E+=f[C];for(C=0;C<=u;C++)f[C]/=E;return f},d=function(e){var t;for(t=0;t<e.length;t++)e[t]=-e[t];return e[(e.length-1)/2]++,e},s=function(e){for(var t=i({order:e.order,Fs:e.Fs,Fc:e.F2}),l=d(i({order:e.order,Fs:e.Fs,Fc:e.F1})),u=[],h=0;h<t.length;h++)u.push(t[h]+l[h]);return u};return{lowpass:function(e){return i(e)},highpass:function(e){return d(i(e))},bandstop:function(e){return s(e)},bandpass:function(e){return d(s(e))},kbFilter:function(e){return a(e)},available:function(){return["lowpass","highpass","bandstop","bandpass","kbFilter"]}}};r.exports=_},{}],5:[function(n,r,o){"use strict";var _=n("./utils"),a=_.runMultiFilter,i=_.runMultiFilterReverse,d=_.complex,s=_.evaluatePhase,e=function(t){var l=t,u=[],h=0;for(h=0;h<l.length;h++)u[h]={re:l[h],im:0};var C=function(b){var S,M=[];for(S=0;S<b;S++)M.push(0);return{buf:M,pointer:0}},E=C(l.length-1),f=function(b,S){S.buf[S.pointer]=b;var M=0;for(h=0;h<S.buf.length;h++)M+=l[h]*S.buf[(S.pointer+h)%S.buf.length];return S.pointer=(S.pointer+1)%S.buf.length,M},T=function(b){var S=C(l.length-1);return a(b,S,f)},I=function(b){for(var S=b.Fs,M=b.Fr,p=-Math.PI*(M/S)*2,m={re:0,im:0},c=0;c<l.length-1;c++)m=d.add(m,d.mul(u[c],{re:Math.cos(p*c),im:Math.sin(p*c)}));var R=d.magnitude(m);return{magnitude:R,phase:d.phase(m),dBmagnitude:20*Math.log(R)*Math.LOG10E}};return{responsePoint:function(b){return I(b)},response:function(b){b=b||100;var S=[],M=0,p=2*b;for(M=0;M<b;M++)S[M]=I({Fs:p,Fr:M});return s(S),S},simulate:function(b){return T(b)},singleStep:function(b){return f(b,E)},multiStep:function(b,S){return a(b,E,f,S)},filtfilt:function(b,S){return i(a(b,E,f,S),E,f,!0)},reinit:function(){E=C(l.length-1)}}};r.exports=e},{"./utils":9}],6:[function(n,r,o){"use strict";var _=function(){var a=function(s,e){var t=s.Q,l=s.Fc,u=s.Fs,h={},C=2*Math.PI*l/u;return s.BW?h.alpha=Math.sin(C)*Math.sinh(Math.log(2)/2*s.BW*C/Math.sin(C)):h.alpha=Math.sin(C)/(2*t),h.cw=Math.cos(C),h.a0=1+h.alpha,e.a0=h.a0,e.a.push(-2*h.cw/h.a0),e.k=1,e.a.push((1-h.alpha)/h.a0),h},i=function(s){var e=s.Q,t=s.Fc,l=s.Fs,u={},h=2*Math.PI*t/l;return u.alpha=Math.sin(h)/(2*e),u.cw=Math.cos(h),u.A=Math.pow(10,s.gain/40),u},d=function(){var s={};return s.z=[0,0],s.a=[],s.b=[],s};return{fromPZ:function(s){var e=d();return e.a0=1,e.b.push(1),e.b.push(-s.z0.re-s.z1.re),e.b.push(s.z0.re*s.z1.re-s.z0.im*s.z1.im),e.a.push(-s.p0.re-s.p1.re),e.a.push(s.p0.re*s.p1.re-s.p0.im*s.p1.im),s.type==="lowpass"?e.k=(1+e.a[0]+e.a[1])/(1+e.b[1]+e.b[2]):e.k=(1-e.a[0]+e.a[1])/(1-e.b[1]+e.b[2]),e},lowpassMZ:function(s){var e=d();e.a0=1;var t=s.as,l=s.bs,u=2*Math.PI*s.Fc/s.Fs,h=-t/(2*l);return e.a.push(2*-Math.pow(Math.E,h*u)*Math.cos(-u*Math.sqrt(Math.abs(Math.pow(t,2)/(4*Math.pow(l,2))-1/l)))),e.a.push(Math.pow(Math.E,2*h*u)),s.preGain?(e.b.push(1),e.k=e.a0+e.a[0]+e.a[1]):(e.b.push(e.a0+e.a[0]+e.a[1]),e.k=1),e.b.push(0),e.b.push(0),e},lowpassBT:function(s){var e=d();return s.Q=1,e.wp=Math.tan(2*Math.PI*s.Fc/(2*s.Fs)),e.wp2=e.wp*e.wp,s.BW&&delete s.BW,e.k=1,e.a0=3*e.wp+3*e.wp2+1,e.b.push(3*e.wp2*s.Q/e.a0),e.b.push(2*e.b[0]),e.b.push(e.b[0]),e.a.push((6*e.wp2-2)/e.a0),e.a.push((3*e.wp2-3*e.wp+1)/e.a0),e},highpassBT:function(s){var e=d();return s.Q=1,e.wp=Math.tan(2*Math.PI*s.Fc/(2*s.Fs)),e.wp2=e.wp*e.wp,s.BW&&delete s.BW,e.k=1,e.a0=e.wp+e.wp2+3,e.b.push(3*s.Q/e.a0),e.b.push(2*e.b[0]),e.b.push(e.b[0]),e.a.push((2*e.wp2-6)/e.a0),e.a.push((e.wp2-e.wp+3)/e.a0),e},lowpass:function(s){var e=d();s.BW&&delete s.BW;var t=a(s,e);return s.preGain?(e.k=.5*(1-t.cw),e.b.push(1/t.a0)):(e.k=1,e.b.push((1-t.cw)/(2*t.a0))),e.b.push(2*e.b[0]),e.b.push(e.b[0]),e},highpass:function(s){var e=d();s.BW&&delete s.BW;var t=a(s,e);return s.preGain?(e.k=.5*(1+t.cw),e.b.push(1/t.a0)):(e.k=1,e.b.push((1+t.cw)/(2*t.a0))),e.b.push(-2*e.b[0]),e.b.push(e.b[0]),e},allpass:function(s){var e=d();s.BW&&delete s.BW;var t=a(s,e);return e.k=1,e.b.push((1-t.alpha)/t.a0),e.b.push(-2*t.cw/t.a0),e.b.push((1+t.alpha)/t.a0),e},bandpassQ:function(s){var e=d(),t=a(s,e);return e.k=1,e.b.push(t.alpha*s.Q/t.a0),e.b.push(0),e.b.push(-e.b[0]),e},bandpass:function(s){var e=d(),t=a(s,e);return e.k=1,e.b.push(t.alpha/t.a0),e.b.push(0),e.b.push(-e.b[0]),e},bandstop:function(s){var e=d(),t=a(s,e);return e.k=1,e.b.push(1/t.a0),e.b.push(-2*t.cw/t.a0),e.b.push(e.b[0]),e},peak:function(s){var e=d(),t=i(s);return e.k=1,e.a0=1+t.alpha/t.A,e.a.push(-2*t.cw/e.a0),e.a.push((1-t.alpha/t.A)/e.a0),e.b.push((1+t.alpha*t.A)/e.a0),e.b.push(-2*t.cw/e.a0),e.b.push((1-t.alpha*t.A)/e.a0),e},lowshelf:function(s){var e=d();s.BW&&delete s.BW;var t=i(s);e.k=1;var l=2*Math.sqrt(t.A)*t.alpha;return e.a0=t.A+1+(t.A-1)*t.cw+l,e.a.push(-2*(t.A-1+(t.A+1)*t.cw)/e.a0),e.a.push((t.A+1+(t.A-1)*t.cw-l)/e.a0),e.b.push(t.A*(t.A+1-(t.A-1)*t.cw+l)/e.a0),e.b.push(2*t.A*(t.A-1-(t.A+1)*t.cw)/e.a0),e.b.push(t.A*(t.A+1-(t.A-1)*t.cw-l)/e.a0),e},highshelf:function(s){var e=d();s.BW&&delete s.BW;var t=i(s);e.k=1;var l=2*Math.sqrt(t.A)*t.alpha;return e.a0=t.A+1-(t.A-1)*t.cw+l,e.a.push(2*(t.A-1-(t.A+1)*t.cw)/e.a0),e.a.push((t.A+1-(t.A-1)*t.cw-l)/e.a0),e.b.push(t.A*(t.A+1+(t.A-1)*t.cw+l)/e.a0),e.b.push(-2*t.A*(t.A-1+(t.A+1)*t.cw)/e.a0),e.b.push(t.A*(t.A+1+(t.A-1)*t.cw-l)/e.a0),e},aweighting:function(s){var e=d();e.k=1;var t=2*Math.PI*s.Fc/s.Fs,l=2*Math.tan(t/2),u=s.Q,h=Math.pow(l,2);return e.a0=4*u+h*u+2*l,e.a.push(2*h*u-8*u),e.a.push(4*u+h*u-2*l),e.b.push(h*u),e.b.push(2*h*u),e.b.push(h*u),e}}};r.exports=_},{}],7:[function(n,r,o){"use strict";var _=n("./utils"),a=_.complex,i=_.runMultiFilter,d=_.runMultiFilterReverse,s=_.evaluatePhase,e=function(t){for(var l=t,u={re:1,im:0},h=[],C=[],E=0;E<l.length;E++){h[E]={};var f=l[E];h[E].b0={re:f.b[0],im:0},h[E].b1={re:f.b[1],im:0},h[E].b2={re:f.b[2],im:0},h[E].a1={re:f.a[0],im:0},h[E].a2={re:f.a[1],im:0},h[E].k={re:f.k,im:0},h[E].z=[0,0],C[E]={},C[E].b1=f.b[1]/f.b[0],C[E].b2=f.b[2]/f.b[0],C[E].a1=f.a[0],C[E].a2=f.a[1]}var T=function(v,g){var A=g*v.k.re-v.a1.re*v.z[0]-v.a2.re*v.z[1],w=v.b0.re*A+v.b1.re*v.z[0]+v.b2.re*v.z[1];return v.z[1]=v.z[0],v.z[0]=A,w},I=function(v,g){var A=v,w=0;for(w=0;w<g.length;w++)A=T(g[w],A);return A},b=function(v,g){var A=v.Fs,w=v.Fr,D=-Math.PI*(w/A)*2,x={re:Math.cos(D),im:Math.sin(D)},P=a.mul(g.k,a.add(g.b0,a.mul(x,a.add(g.b1,a.mul(g.b2,x))))),N=a.add(u,a.mul(x,a.add(g.a1,a.mul(g.a2,x)))),y=a.div(P,N);return{magnitude:a.magnitude(y),phase:a.phase(y)}},S=function(v){var g=0,A={magnitude:1,phase:0};for(g=0;g<h.length;g++){var w=b(v,h[g]);A.magnitude*=w.magnitude,A.phase+=w.phase}return A.dBmagnitude=20*Math.log(A.magnitude)*Math.LOG10E,A},M=function(){for(var v=[],g=0;g<l.length;g++)v[g]={b0:{re:f.b[0],im:0},b1:{re:f.b[1],im:0},b2:{re:f.b[2],im:0},a1:{re:f.a[0],im:0},a2:{re:f.a[1],im:0},k:{re:f.k,im:0},z:[0,0]};return v},p=function(v){var g=M();return i(v,g,I)},m=function(v,g){var A={},w=[],D=0;for(D=0;D<g;D++)w.push(v(D));A.out=p(w);var x=!1,P=!1;for(D=0;D<g-1;D++)if(A.out[D]>A.out[D+1]&&!x&&(x=!0,A.max={sample:D,value:A.out[D]}),x&&!P&&A.out[D]<A.out[D+1]){P=!0,A.min={sample:D,value:A.out[D]};break}return A},c=function(v,g){var A=Math.pow(v/2,2)-g;return A<0?[{re:-v/2,im:Math.sqrt(Math.abs(A))},{re:-v/2,im:-Math.sqrt(Math.abs(A))}]:[{re:-v/2+Math.sqrt(A),im:0},{re:-v/2-Math.sqrt(A),im:0}]},R=function(){for(var v=[],g=0;g<C.length;g++)v[g]={},v[g].z=c(C[g].b1,C[g].b2),v[g].p=c(C[g].a1,C[g].a2);return v};return{singleStep:function(v){return I(v,h)},multiStep:function(v,g){return i(v,h,I,g)},filtfilt:function(v,g){return d(i(v,h,I,g),h,I,!0)},simulate:function(v){return p(v)},stepResponse:function(v){return m(function(){return 1},v)},impulseResponse:function(v){return m(function(g){return g===0?1:0},v)},responsePoint:function(v){return S(v)},response:function(v){v=v||100;var g=[],A=0,w=2*v;for(A=0;A<v;A++)g[A]=S({Fs:w,Fr:A});return s(g),g},polesZeros:function(){return R()},reinit:function(){for(E=0;E<h.length;E++)h[E].z=[0,0]}}};r.exports=e},{"./utils":9}],8:[function(n,r,o){"use strict";var _=function(a){var i,d=a,s=[],e=function(h){for(i=0;i<h.steps;i++)s.push(d.singleStep((Math.random()-.5)*h.pp+h.offset))},t=function(h){var C=h.offset+h.pp,E=h.offset-h.pp;for(i=0;i<h.steps;i++)i%200<100?s.push(d.singleStep(C)):s.push(d.singleStep(E))},l=function(h){var C=h.offset+h.pp,E=h.offset-h.pp;for(i=0;i<h.steps;i++)i%100==0?s.push(d.singleStep(C)):s.push(d.singleStep(E))},u=function(h){var C=h.offset+h.pp,E=h.offset-h.pp,f=E,T=(C-E)/100;for(i=0;i<h.steps;i++)i%200<100?f+=T:f-=T,s.push(d.singleStep(f))};return{randomStability:function(h){for(d.reinit(),s.length=0,e(h),i=h.setup;i<s.length;i++)if(s[i]>h.maxStable||s[i]<h.minStable)return s[i];return!0},directedRandomStability:function(h){d.reinit(),s.length=0;var C;for(C=0;C<h.tests;C++){var E=Math.random();E<.25?e(h):E<.5?t(h):E<.75?l(h):u(h)}for(e(h),i=h.setup;i<s.length;i++)if(s[i]>h.maxStable||s[i]<h.minStable)return s[i];return!0},evaluateBehavior:function(){}}};r.exports=_},{}],9:[function(n,r,o){"use strict";o.evaluatePhase=function(s){var e=0,t=0,l=Math.PI,u=2*l,h=[];for(t=0;t<s.length;t++)h.push(s[t].phase);for(s[0].unwrappedPhase=s[0].phase,s[0].groupDelay=0,t=1;t<h.length;t++){var C=h[t]-h[t-1];if(C>l)for(e=t;e<h.length;e++)h[e]-=u;else if(C<-l)for(e=t;e<h.length;e++)h[e]+=u;h[t]<0?s[t].unwrappedPhase=-h[t]:s[t].unwrappedPhase=h[t],s[t].phaseDelay=s[t].unwrappedPhase/(t/s.length),s[t].groupDelay=(s[t].unwrappedPhase-s[t-1].unwrappedPhase)/(l/s.length),s[t].groupDelay<0&&(s[t].groupDelay=-s[t].groupDelay)}s[0].magnitude!==0?(s[0].phaseDelay=s[1].phaseDelay,s[0].groupDelay=s[1].groupDelay):(s[0].phaseDelay=s[2].phaseDelay,s[0].groupDelay=s[2].groupDelay,s[1].phaseDelay=s[2].phaseDelay,s[1].groupDelay=s[2].groupDelay)},o.runMultiFilter=function(s,e,t,l){var u=[];l&&(u=s);var h;for(h=0;h<s.length;h++)u[h]=t(s[h],e);return u},o.runMultiFilterReverse=function(s,e,t,l){var u=[];l&&(u=s);var h;for(h=s.length-1;h>=0;h--)u[h]=t(s[h],e);return u};var _=function(s,e){for(var t=!0;t;){var l=s,u=e;if(t=!1,u||(u=1),l!==Math.floor(l)||u!==Math.floor(u))return 1;if(l===0||l===1)return u;s=l-1,e=u*l,t=!0}};o.besselFactors=function(s){for(var e=[],t=0;t<s+1;t++){var l=_(2*s-t),u=Math.pow(2,s-t)*_(t)*_(s-t);e.unshift(Math.floor(l/u))}return e};var a=function(s,e){for(var t=0,l=0;l<e;l++){var u=1/Math.pow(2,l+1);s>u&&(s-=u,t+=u)}return t},i=function(s,e){return s&Math.pow(2,e)},d=function(s,e,t){var l=Math.abs(s),u=s-l;return{number:i(l,e).toString(),fraction:a(u,t).toString(),numberBits:e,fractionBits:t}};o.fixedPoint={convert:function(s,e,t){return d(s,e,t)},add:function(s,e){},sub:function(s,e){},mul:function(s,e){},div:function(s,e){}},o.complex={div:function(s,e){var t=s.re,l=s.im,u=e.re,h=e.im,C=u*u+h*h;return{re:(t*u+l*h)/C,im:(l*u-t*h)/C}},mul:function(s,e){var t=s.re,l=s.im,u=e.re,h=e.im;return{re:t*u-l*h,im:(t+l)*(u+h)-t*u-l*h}},add:function(s,e){return{re:s.re+e.re,im:s.im+e.im}},sub:function(s,e){return{re:s.re-e.re,im:s.im-e.im}},phase:function(s){return Math.atan2(s.im,s.re)},magnitude:function(s){return Math.sqrt(s.re*s.re+s.im*s.im)}}},{}]},{},[1])(1)})});var O=Se(Ae(),1);var Ze=Se(Ae(),1),le=class{timeseries;tsPresOpts;text;x=0;y=0;fillStyle;textBaseline="top";textAlign="start";font="14px Arial";on=!0;on_fillStyle;off_fillStyle="#7f7f7f";width=void 0;height=void 0;constructor(r,o,_,a="start",i=0,d=0,s=!0,e="top",t="14px Arial",l=void 0,u=void 0){this.timeseries=r,this.tsPresOpts=o,this.text=_,this.textAlign=a,this.x=i,this.y=d,this.on=s,this.fillStyle=o?.strokeStyle||(s?"#fbfbfb":"#7f7f7f"),this.textBaseline=e,this.font=t,l!==void 0?this.on_fillStyle=l:this.on&&(this.on_fillStyle=this.fillStyle),u!==void 0?this.off_fillStyle=u:this.on||(this.off_fillStyle=this.fillStyle),this.enable(s)}getHeight(){return this.height=parseFloat(this.font.split("px")[0]),this.height}getWidth(r){let o=r.getContext("2d");return o&&(o.save(),o.textBaseline=this.textBaseline,o.textAlign=this.textAlign,o.font=this.font,o.fillStyle=this.fillStyle,this.width=o.measureText(this.text).width,o.restore()),this.width}enable(r=!0){this.on=r,this.fillStyle=this.on?this.on_fillStyle:this.off_fillStyle}onclick(){this.on=!this.on,this.enable(this.on)}},J=class extends Ze.SmoothieChart{smoothieTSInfos;isRow=!0;allowToggleLegend=!0;allowToggleLabel=!0;constructor(r,o=!0,_=!0,a=!0){super(r),this.smoothieTSInfos=[],this.isRow=o,this.allowToggleLegend=_,this.allowToggleLabel=a}canvasOnClick=r=>{if(console.log(`Click coordinate: ${r.offsetX} ${r.offsetY}`),this.allowToggleLegend&&"canvas"in this){let o=this.canvas;for(let _=0;_<this.smoothieTSInfos.length;_++){let a=this.smoothieTSInfos[_],i=a.width||a.getWidth(o)||0,d=a.height||a.getHeight()||0;i>0&&d>0&&r.offsetX>a.x&&r.offsetX<a.x+i&&r.offsetY>a.y&&r.offsetY<a.y+d&&(a.onclick(),a.on?a.timeseries!==void 0&&this.addTimeSeries(a.timeseries,a.tsPresOpts):a.timeseries!==void 0&&this.removeTimeSeries(a.timeseries))}}};streamTo(r,o){super.streamTo(r,o),"canvas"in this&&this.canvas.addEventListener("click",this.canvasOnClick)}render(r,o){if(super.render(r,o),this.smoothieTSInfos.length){let _=this.lastRenderTimeMillis;Date.now()-_<3&&this.renderLegend(r)}}renderLegend(r){let o=this.smoothieTSInfos,_=r.getContext("2d");if(_){_.save();let a=0;for(let i=0;i<o.length;i++){if(i>0){if(this.isRow&&o[i].x===o[0].x)o[i].x=o[i-1].x+a+5;else if(!this.isRow&&o[i].y===o[0].y){let s=parseFloat(o[i].font.split("px")[0]);o[i].y=o[i-1].y+s+2}}let d=o[i];_.textBaseline=d.textBaseline,_.textAlign=d.textAlign,_.font=d.font,_.fillStyle=d.fillStyle,_.fillText(d.text,d.x,d.y),a=_.measureText(d.text).width}_.restore()}}addSmoothieTSInfo(r){this.smoothieTSInfos.indexOf(r)<0&&(this.smoothieTSInfos.push(r),r.timeseries!==void 0&&r.tsPresOpts!==void 0&&this.addTimeSeries(r.timeseries,r.tsPresOpts))}removeLegendTSInfo(r){let o=this.smoothieTSInfos.indexOf(r);return o>-1?(r.timeseries!==void 0&&this.removeTimeSeries(r.timeseries),this.smoothieTSInfos.splice(o,1)):[]}clearLegendTSInfos(){for(let r=0;r<this.smoothieTSInfos.length;r++){let o=this.smoothieTSInfos[r];o.timeseries!==void 0&&this.removeTimeSeries(o.timeseries)}this.smoothieTSInfos=[]}configureTimeSeries(r,o,_,a=!1,i=void 0,d=void 0,s="",e=!1,t=[]){this.clearLegendTSInfos();for(let l=0;l<r.length;l++){let u=new le(r[l],o[l],_[l].legend,_[l].textAlign,_[l].x,_[l].y,!0,_[l].textBaseline,_[l].font);this.addSmoothieTSInfo(u)}if(a&&"canvas"in this){let l=this.canvas,u=new le(void 0,void 0,"Scroll to change y-range","center",l.width/window.devicePixelRatio/2,30,!0,"top","16px Arial","#fbfbfb");this.addSmoothieTSInfo(u),setTimeout(()=>{this.removeLegendTSInfo(u)},1500)}this.options.minValue=i,this.options.maxValue=d,this.updateValueRange(),s.length>0&&this.options.title!==void 0&&(this.options.title.text=s),this.options.labels!==void 0&&(this.options.labels.disabled=e),this.options.horizontalLines=t}};function F(n,r=10,o=5,_="top",a="start",i="14px Arial"){return{legend:n,x:r,y:o,textBaseline:_,textAlign:a,font:i}}var H=Se(je(),1);var ti="fb005c80-02e7-f387-1cad-8acd2d8df0c8",ii="fb005c81-02e7-f387-1cad-8acd2d8df0c8",ni="fb005c82-02e7-f387-1cad-8acd2d8df0c8",U=(n=>(n[n.ECG=0]="ECG",n[n.PPG=1]="PPG",n[n.ACC=2]="ACC",n[n.PPI=3]="PPI",n[n.GYRO=5]="GYRO",n[n.MAGNETOMETER=6]="MAGNETOMETER",n[n.SDK_MODE=9]="SDK_MODE",n[n.LOCATION=10]="LOCATION",n[n.PRESSURE=11]="PRESSURE",n[n.TEMPERATURE=12]="TEMPERATURE",n))(U||{}),we=(n=>(n[n.SAMPLE_RATE=0]="SAMPLE_RATE",n[n.RESOLUTION=1]="RESOLUTION",n[n.RANGE_PN_UNIT=2]="RANGE_PN_UNIT",n[n.RANGE_MILI_UNIT=3]="RANGE_MILI_UNIT",n[n.NUM_CHANNELS=4]="NUM_CHANNELS",n[n.CONVERSION_FACTOR=5]="CONVERSION_FACTOR",n))(we||{});function Te(n,r,o=!0){return n.getUint16(r,o)}function si(n,r,o=!0){return n.getFloat32(r,o)}function ai(n,r,o=!0){return[n.getUint16(r,o),n.getUint16(r+2,o),n.getUint16(r+4,o),n.getUint16(r+6,o)]}var ri={SAMPLE_RATE:Te,RESOLUTION:Te,RANGE_PN_UNIT:Te,RANGE_MILI_UNIT:ai,CONVERSION_FACTOR:si},oi={SAMPLE_RATE:2,RESOLUTION:2,RANGE_PN_UNIT:2,RANGE_MILI_UNIT:8,NUM_CHANNELS:1,CONVERSION_FACTOR:4},Ie=(n=>(n[n.GET_MEASUREMENT_SETTINGS=1]="GET_MEASUREMENT_SETTINGS",n[n.REQUEST_MEASUREMENT_START=2]="REQUEST_MEASUREMENT_START",n[n.REQUEST_MEASUREMENT_STOP=3]="REQUEST_MEASUREMENT_STOP",n))(Ie||{}),wi=Object.keys(we).filter(n=>isNaN(Number(n))),ce=Object.keys(U).filter(n=>isNaN(Number(n))),Ii=Object.keys(Ie).filter(n=>isNaN(Number(n))),Y=["SUCCESS","INVALID OP CODE","INVALID MEASUREMENT TYPE","NOT SUPPORTED","INVALID LENGTH","INVALID PARAMETER","ALREADY IN STATE","INVALID RESOLUTION","INVALID SAMPLE RATE","INVALID RANGE","INVALID MTU","INVALID NUMBER OF CHANNELS","INVALID STATE","DEVICE IN CHARGER"],Ke=class{device;server=void 0;PMDService=void 0;PMDCtrlChar=void 0;PMDDataChar=void 0;BattService=void 0;BattLvlChar=void 0;streaming=!1;verbose=!0;dataHandle={};timeOffset=BigInt(0);eventTimeOffset;lastECGTimestamp;lastACCTimestamp;ACCStarted=!1;ECGStarted=!1;constructor(n,r=!0){this.device=n,this.verbose=r,this.lastECGTimestamp=0,this.lastACCTimestamp=0,this.ACCStarted=!1,this.ECGStarted=!1;for(let o=0;o<ce.length;o++)this.dataHandle[ce[o]]=[]}addEventListener(n,r){this.dataHandle[n].includes(r)||this.dataHandle[n].push(r)}removeEventListener(n,r){let o=this.dataHandle[n].indexOf(r);return o>-1&&this.dataHandle[n].splice(o,1),o}clearEventListner(n){delete this.dataHandle[n],this.dataHandle[n]=[]}log(...n){this.verbose&&console.log(...n)}async init(){this.server=await this.device.gatt?.connect(),this.log(`Connecting to ${this.device.name} GATT server...`),this.PMDService=await this.server?.getPrimaryService(ti),this.log("  Got PMD Service"),this.PMDCtrlChar=await this.PMDService?.getCharacteristic(ii),this.log("    Got PMD control characteristic"),await this.PMDCtrlChar?.startNotifications(),this.log("    Start notification"),this.PMDDataChar=await this.PMDService?.getCharacteristic(ni),this.log("    Got PMD data characteristic"),await this.PMDDataChar?.startNotifications(),this.log("    Start notification"),this.streaming=!1,this.BattService=await this.server?.getPrimaryService("battery_service"),this.log("  Got battery Service"),this.BattLvlChar=await this.BattService?.getCharacteristic("battery_level"),this.log("    Got battery level characteristic"),this.PMDDataChar?.addEventListener("characteristicvaluechanged",this.PMDDataHandle.bind(this))}PMDCtrlCharHandle(n){this.log(n)}PMDCtrlDataHandle(n){this.log(n)}async getBatteryLevel(){let n=await this.BattLvlChar?.readValue();return n?n.getUint8(0):0}async getPMDFeatures(){let n=await this.PMDCtrlChar?.readValue(),r=[];if(n!==void 0&&n.byteLength===17&&n.getUint8(0)===15){let o=n.getUint8(1);for(let _=0;_<ce.length;_++){let a=ce[_];o>>U[a]&1&&r.push(a)}}return r}async getSensorSettingsFromName(n){return this.getSensorSettingsFromId(U[n])}parseSensorSettings(n){if(n.getUint8(0)==240&&n.getUint8(1)==1){let r={type:U[n.getUint8(2)],error:Y[n.getUint8(3)],more_frames:n.getUint8(4),settings:{}},o=5;for(;o<n.byteLength;){let _=n.getUint8(o);o+=1;let a=n.getUint8(o);o+=1;let i=we[_];r.settings[i]=[];for(let d=0;d<a;d++)r.settings[i].push(ri[i](n,o)),o+=oi[i]}return r}}async getSensorSettingsFromId(n){if(!this.streaming){let r,o=new Promise((i,d)=>{r=i}),_=i=>{let d=i?.target?.value;r(this.parseSensorSettings(d))};this.PMDCtrlChar?.addEventListener("characteristicvaluechanged",_,{once:!0});let a=new Uint8Array([1,n]);return await this.PMDCtrlChar?.writeValue(a),await o}}PMDDataHandle(n){let r=n.target.value,o=r.getBigUint64(1,!0);this.timeOffset===BigInt(0)&&(this.timeOffset=o,this.eventTimeOffset=n.timeStamp+performance.timeOrigin);let _=Number(o-this.timeOffset)/1e6,a=r.getUint8(0),i=r.getUint8(9),d={type:U[a],sample_timestamp_ms:_,prev_sample_timestamp_ms:0,recv_epoch_time_ms:n.timeStamp+performance.timeOrigin,event_time_offset_ms:this.eventTimeOffset};switch(a){case 2:i==1&&(d.samples=new Int16Array(r.buffer.slice(10)),d.prev_sample_timestamp_ms=this.lastACCTimestamp,this.lastACCTimestamp=_);break;case 0:if(i===0){let s=Math.floor((r.byteLength-10)/3);d.samples=new Int32Array(s);for(let e=10;e<r.byteLength;e+=3){let t=r.getUint8(e+2)<<16|r.getUint8(e+1)<<8|r.getUint8(e);t&8388608&&(t|=4278190080),d.samples[Math.floor((e-10)/3)]=t}d.prev_sample_timestamp_ms=this.lastECGTimestamp,this.lastECGTimestamp=_}break}for(let s of this.dataHandle[U[a]])s(d)}parseCtrlReply(n){if(n.getUint8(0)===240){let r=n.getUint8(1);if(r===2||r===3){let o={type:Ie[r],sensor:U[n.getUint8(2)],error:Y[n.getUint8(3)],more_frames:n.getUint8(4)};return n.byteLength>5&&(o.reserved=n.getUint8(5)),o}}}async startACC(n=4,r=100,o=16){if(this.ACCStarted)return;let _,a=new Promise((t,l)=>{_=t}),i=t=>{this.log("PMDSensorSettingHandle");let l=t?.target?.value;_(this.parseCtrlReply(l))};this.PMDCtrlChar?.addEventListener("characteristicvaluechanged",i,{once:!0});let d=new Uint8Array(14),s=new DataView(d.buffer);d[0]=2,d[1]=2,d[2]=2,d[3]=1,s.setUint16(4,n,!0),d[6]=0,d[7]=1,s.setUint16(8,r,!0),d[10]=1,d[11]=1,s.setUint16(12,o,!0),await this.PMDCtrlChar?.writeValue(d);let e=await a;return e?.error===Y[0]&&(this.ACCStarted=!0),e}async startECG(n=130,r=14){if(this.ECGStarted)return;let o,_=new Promise((e,t)=>{o=e}),a=e=>{this.log("PMDSensorSettingHandle");let t=e?.target?.value;o(this.parseCtrlReply(t))};this.PMDCtrlChar?.addEventListener("characteristicvaluechanged",a,{once:!0});let i=new Uint8Array(10),d=new DataView(i.buffer);i[0]=2,i[1]=0,i[2]=1,i[3]=1,d.setUint16(4,r,!0),i[6]=0,i[7]=1,d.setUint16(8,n,!0),await this.PMDCtrlChar?.writeValue(i);let s=await _;return s?.error===Y[0]&&(this.ECGStarted=!0),s}async stopECG(){if(!this.ECGStarted)return;let n=await this.stopSensor(0);return n?.error===Y[0]&&(this.ECGStarted=!1),n}async stopACC(){if(!this.ACCStarted)return;let n=await this.stopSensor(2);return n?.error===Y[0]&&(this.ACCStarted=!1),n}async stopSensor(n){let r,o=new Promise((i,d)=>{r=i}),_=i=>{let d=i?.target?.value;r(this.parseCtrlReply(d))};this.PMDCtrlChar?.addEventListener("characteristicvaluechanged",_,{once:!0});let a=new Uint8Array(2);return a[0]=3,a[1]=n,await this.PMDCtrlChar?.writeValue(a),await o}};var et=["","LShoulder","RShoulder","Chest","MiddleSpine","LowerSpine","Hip","LThigh","RThigh"],li=new Date("2000-01-01T00:00:00Z"),ci=new Date("2018-01-01T00:00:00Z"),hi=li.valueOf(),di=BigInt(hi)*BigInt(1e6),ui=ci.valueOf(),fi=BigInt(ui)*BigInt(1e6),tt=fi-di,_i=tt/BigInt(1e6),Je=Number(tt-_i*BigInt(1e6))/1e6,Di=Je+Number(Je);var ee=5,it=35,nt=600,he=200,q=Math.round(130/(1e3/he)),st=-120,Me=120,at=0,Re=120,rt=25,ot=4,de=130,lt=5,ct=5,De=1,ht=600,te=100,Le=4,Ne=-2e3,ue=2e3,xe=10,Fe=4;var Oe=10,dt=100,fe=2.5,_e=.1,ut=4,ft=-20,Pe=20,ye=1,_t=1,Ge={limitFPS:60,grid:{strokeStyle:"#484f58",fillStyle:"#000000",lineWidth:1,millisPerLine:1e3,borderVisible:!1},title:{text:"EXG raw voltage (0.7\u201340 Hz)",fontFamily:"Arial",verticalAlign:"bottom",fillStyle:"#ffffff80",fontSize:14},responsive:!1,nonRealtimeData:!0,millisPerPixel:8,scaleSmoothing:.1,tooltip:!0},He={limitFPS:60,minValue:Ne,maxValue:ue,grid:{strokeStyle:"#484f58",fillStyle:"#000000",lineWidth:1,millisPerLine:1e3,borderVisible:!1},title:{text:"Accelerometer raw",fontFamily:"Arial",verticalAlign:"bottom",fillStyle:"#ffffff80",fontSize:14},labels:{disabled:!1},responsive:!1,nonRealtimeData:!0,millisPerPixel:8,scaleSmoothing:.1,tooltip:!0},pt={lineWidth:2,interpolation:"linear",strokeStyle:"#ebebebcc"},mt={lineWidth:2,interpolation:"linear",strokeStyle:"#ffdcaacc"},vt={lineWidth:2,interpolation:"linear",strokeStyle:"#dcaaffcc",fillStyle:"#f0beff99"},Ct={lineWidth:2,interpolation:"linear",strokeStyle:"#ff453acc"},gt={lineWidth:2,interpolation:"linear",strokeStyle:"#32ff4bcc"},Et={lineWidth:2,interpolation:"linear",strokeStyle:"#0a84ffcc"},St={lineWidth:2,interpolation:"linear",strokeStyle:"#ff776ccc"},At={lineWidth:2,interpolation:"linear",strokeStyle:"#64ff7dcc"},bt={lineWidth:2,interpolation:"linear",strokeStyle:"#3cb6ffcc"},Tt={lineWidth:2,interpolation:"linear",strokeStyle:"#6effffcc"},wt={lineWidth:2,interpolation:"linear",strokeStyle:"#ff70ffcc"},It={lineWidth:2,interpolation:"linear",strokeStyle:"#ffff78cc"},Mt={lineWidth:2,interpolation:"linear",strokeStyle:"#ebebebcc"},Rt={lineWidth:2,interpolation:"linear",strokeStyle:"#ffdcaacc"},Dt={lineWidth:2,interpolation:"linear",strokeStyle:"#f0883e"},Lt={lineWidth:2,interpolation:"linear",strokeStyle:"#f778ba"},Nt={lineWidth:2,interpolation:"linear",strokeStyle:"#388afd"},xt={lineWidth:2,interpolation:"linear",strokeStyle:"#aadcffcc"},Ft=(l=>(l[l.ECG=0]="ECG",l[l.PPG=1]="PPG",l[l.ACC=2]="ACC",l[l.PPI=3]="PPI",l[l.GYRO=5]="GYRO",l[l.MAGNETOMETER=6]="MAGNETOMETER",l[l.SDK_MODE=9]="SDK_MODE",l[l.LOCATION=10]="LOCATION",l[l.PRESSURE=11]="PRESSURE",l[l.TEMPERATURE=12]="TEMPERATURE",l))(Ft||{}),Li=Object.keys(Ft).filter(n=>isNaN(Number(n)));var Be=new H.CalcCascades;async function Vt(n,r){await new pe(n,r).init()}var pe=class n{static polarRowID=0;static polarVisRows=[];device;polarH10;deviceName;battLvl;parent;polarSensorDiv;optionDiv;deviceInfoDiv;nameDiv;loadingDiv;disconnectDiv;deviceNameDiv;battLvlDiv;dataInfo;bodypartLabel;bodypartSelectDiv;bodypartSelect;dataCtrl;extraDataCtrl;rowOrder;visContainerDiv;ECGCtrlDiv;ACCCtrlDiv;order;ECG_FILTER_MIN=st;ECG_FILTER_MAX=Me;ECG_RMS_MIN=at;ECG_RMS_MAX=Re;ACC_MIN=Ne;ACC_MAX=ue;ACC_FILTER_MIN=ft;ACC_FILTER_MAX=Pe;disBtn;orderUpBtn;orderDownBtn;show3DBtn;filterConfigBtn;ECGFormSelect;ECGSwitchInput;ECGDropDown;ACCFormSelect;ACCSwitchInput;ACCDropDown;ECGDiv=void 0;ACCDiv=void 0;ecg_resize=void 0;ecg_chart=void 0;ecg_resize_observer=void 0;ecg_canvas=void 0;ecg_filter_iir_coef=void 0;ecg_ts=void 0;ecg_filter_info;ecg_filter_iir=void 0;ecg_filter_ts=void 0;ecg_rms_ts=void 0;ecg_ss_win=void 0;ecg_ss_win_i=0;ecg_ss=0;acc_resize=void 0;acc_chart=void 0;acc_resize_observer=void 0;acc_canvas=void 0;acc_x_ts=void 0;acc_y_ts=void 0;acc_z_ts=void 0;acc_mag_ts=void 0;acc_lp_info;acc_lp_iir_coef=void 0;acc_x_lp_iir=void 0;acc_y_lp_iir=void 0;acc_z_lp_iir=void 0;acc_mag_lp_iir=void 0;acc_x_lp_ts=void 0;acc_y_lp_ts=void 0;acc_z_lp_ts=void 0;acc_mag_lp_ts=void 0;acc_rho_ts=void 0;acc_phi_ts=void 0;acc_theta_ts=void 0;acc_filter_info;acc_filter_iir_coef=void 0;acc_x_filter_iir=void 0;acc_y_filter_iir=void 0;acc_z_filter_iir=void 0;acc_mag_filter_iir=void 0;acc_x_filter_ts=void 0;acc_y_filter_ts=void 0;acc_z_filter_ts=void 0;acc_mag_filter_ts=void 0;ecg_rms_window_ms=he;constructor(r,o){if(o.name===void 0)throw new Error("Invalid Bluetooth device! Missing name");this.parent=r,this.device=o,this.deviceName=this.device?.name?.substring(10)||"",this.ecg_rms_window_ms=he,this.ecg_filter_info={type:"highpass",order:ot,characteristic:"butterworth",Fs:de,Fc:rt,Fl:void 0,Fh:void 0,BW:void 0,gain:void 0,preGain:!1},this.acc_lp_info={type:"lowpass",order:Fe,characteristic:"butterworth",Fs:te,Fc:xe,Fl:void 0,Fh:void 0,BW:void 0,gain:void 0,preGain:!1},this.acc_filter_info={type:"bandpass",order:ut,characteristic:"butterworth",Fs:te,Fc:Math.sqrt(_e*fe),Fl:_e,Fh:fe,BW:fe-_e,gain:void 0,preGain:!1}}disconnectPolarH10=async(r=void 0)=>{this.removeSelf(),this.ecg_chart!==void 0&&this.ecg_chart.stop(),this.ecg_resize_observer!==void 0&&this.ecg_resize_observer.disconnect(),this.ECGDiv!==void 0&&(this.visContainerDiv?.removeChild(this.ECGDiv),this.polarH10.removeEventListener("ECG",this.newECGCallback),await this.stopECG()),this.resetECG(),this.acc_chart!==void 0&&this.acc_chart.stop(),this.acc_resize_observer!==void 0&&this.acc_resize_observer.disconnect(),this.ACCDiv!==void 0&&(this.visContainerDiv?.removeChild(this.ACCDiv),this.polarH10.removeEventListener("ACC",this.newACCCallback),await this.stopAcc()),this.resetACC(),this.disconnectPolarH10IfAlone()};async init(){try{await this.initPolarH10(),await this.initDeviceInfo(),await this.initDeviceGraphCtrl(),n.polarRowID+=1,n.polarVisRows.push(this)}catch(r){this.disconnectPolarH10(),alert(r)}}moveUp=r=>{this.order-=1,this.polarSensorDiv.style.order=this.order.toString();let o=n.polarVisRows[this.order];o.order+=1,o.polarSensorDiv.style.order=o.order.toString(),n.polarVisRows[this.order]=this,n.polarVisRows[o.order]=o,this.order===0?(this.orderUpBtn.disabled=!0,this.orderDownBtn.disabled=!1,o.orderUpBtn.disabled=!1):this.order===n.polarVisRows.length-2&&(this.orderDownBtn.disabled=!1),o.order===n.polarVisRows.length-1&&(o.orderDownBtn.disabled=!0,o.orderUpBtn.disabled=!1)};moveDown=r=>{this.order+=1,this.polarSensorDiv.style.order=this.order.toString();let o=n.polarVisRows[this.order];o.order-=1,o.polarSensorDiv.style.order=o.order.toString(),n.polarVisRows[this.order]=this,n.polarVisRows[o.order]=o,this.order===n.polarVisRows.length-1?(this.orderUpBtn.disabled=!1,this.orderDownBtn.disabled=!0,o.orderDownBtn.disabled=!1):this.order===1&&(this.orderUpBtn.disabled=!1),o.order===0&&(o.orderDownBtn.disabled=!1,o.orderUpBtn.disabled=!0)};newECGCallback=r=>{if(this.ecg_ts!==void 0&&this.ecg_rms_ts!==void 0&&this.ecg_filter_ts!==void 0&&r.prev_sample_timestamp_ms>0&&r.samples!==void 0&&this.ecg_filter_iir!==void 0){let o=(r.sample_timestamp_ms-r.prev_sample_timestamp_ms)/r.samples.length,_=r.event_time_offset_ms+r.prev_sample_timestamp_ms+o;for(let a=0;a<r.samples.length;a++){let i=a*o,d=_+i,s=r.samples[a],e=this.ecg_filter_iir.singleStep(s),t=e*e,l;this.ecg_ss_win!==void 0&&(this.ecg_ss+=t,this.ecg_ss_win_i<q?(this.ecg_ss_win[this.ecg_ss_win_i]=t,this.ecg_ss_win_i++):(this.ecg_ss-=this.ecg_ss_win[0],this.ecg_ss_win.set(this.ecg_ss_win.subarray(1)),this.ecg_ss_win[q-1]=t),this.ecg_ss_win_i===q&&(l=Math.sqrt(this.ecg_ss/q))),setTimeout(()=>{this.ecg_ts?.append(d,s),this.ecg_filter_ts?.append(d,e),l!==void 0&&this.ecg_rms_ts?.append(d,l)},i)}}};newACCCallback=r=>{if(r.prev_sample_timestamp_ms>0&&r.samples!==void 0&&this.acc_x_ts!==void 0&&this.acc_y_ts!==void 0&&this.acc_z_ts!==void 0&&this.acc_mag_ts!==void 0&&this.acc_x_lp_ts!==void 0&&this.acc_y_lp_ts!==void 0&&this.acc_z_lp_ts!==void 0&&this.acc_mag_lp_ts!==void 0&&this.acc_rho_ts!==void 0&&this.acc_phi_ts!==void 0&&this.acc_theta_ts!==void 0&&this.acc_x_filter_ts!==void 0&&this.acc_y_filter_ts!==void 0&&this.acc_z_filter_ts!==void 0&&this.acc_mag_filter_ts!==void 0&&this.acc_x_lp_iir!==void 0&&this.acc_y_lp_iir!==void 0&&this.acc_z_lp_iir!==void 0&&this.acc_mag_lp_iir!==void 0&&this.acc_x_filter_iir!==void 0&&this.acc_y_filter_iir!==void 0&&this.acc_z_filter_iir!==void 0&&this.acc_mag_filter_iir!==void 0){let o=r.samples.length/3,_=(r.sample_timestamp_ms-r.prev_sample_timestamp_ms)/o,a=r.event_time_offset_ms+r.prev_sample_timestamp_ms+_;for(let i=0;i<r.samples.length;i+=3){let s=Math.floor(i/3)*_,e=a+s,t=-r.samples[i],l=-r.samples[i+1],u=r.samples[i+2],h=this.acc_x_lp_iir.singleStep(l),C=this.acc_y_lp_iir.singleStep(t),E=this.acc_z_lp_iir.singleStep(u),f=h*h,T=C*C,I=E*E,b=Math.atan(h/Math.sqrt(T+I))/Math.PI*180,S=Math.atan(C/Math.sqrt(f+I))/Math.PI*180,M=Math.atan(Math.sqrt(f+T)/E)/Math.PI*180,p=Math.sqrt(l*l+t*t+u*u),m=this.acc_mag_lp_iir.singleStep(p),c=this.acc_x_filter_iir.singleStep(l),R=this.acc_y_filter_iir.singleStep(t),v=this.acc_z_filter_iir.singleStep(u),g=this.acc_mag_filter_iir.singleStep(p);setTimeout(()=>{this.acc_x_ts?.append(e,l),this.acc_y_ts?.append(e,t),this.acc_z_ts?.append(e,u),this.acc_mag_ts?.append(e,p),this.acc_rho_ts?.append(e,b),this.acc_phi_ts?.append(e,S),this.acc_theta_ts?.append(e,M),this.acc_x_lp_ts?.append(e,h),this.acc_y_lp_ts?.append(e,C),this.acc_z_lp_ts?.append(e,E),this.acc_mag_lp_ts?.append(e,m),this.acc_x_filter_ts?.append(e,c),this.acc_y_filter_ts?.append(e,R),this.acc_z_filter_ts?.append(e,v),this.acc_mag_filter_ts?.append(e,g)},s)}}};changeECGGraph=r=>{if(this.ecg_chart!==void 0&&this.ecg_ts!==void 0&&this.ecg_filter_ts!==void 0&&this.ecg_rms_ts!==void 0){let o=r.target.selectedIndex;switch(this.ecg_chart.stop(),o){case 0:this.ecg_chart.configureTimeSeries([this.ecg_ts],[pt],[F("\u2015 Raw voltage (\u03BCV)",10,5)],!1,void 0,void 0,Ge.title?.text||"EXG raw voltage (0.7\u201340 Hz)",!1,[]);break;case 1:this.ecg_chart.configureTimeSeries([this.ecg_filter_ts],[mt],[F("\u2015 Filtered raw voltage (\u03BCV)",10,5)],!1,this.ECG_FILTER_MIN,this.ECG_FILTER_MAX,`${Bt(this.ecg_filter_info)} on ECG/EMG raw`,!1,[]);break;case 2:this.ecg_chart.configureTimeSeries([this.ecg_rms_ts],[vt],[F(`\u2015 Filtered EXG ${this.ecg_rms_window_ms} ms window RMS (\u03BCV)`,10,5)],!0,this.ECG_RMS_MIN,this.ECG_RMS_MAX,"RMS (filtered EXG raw)",!1,[]);break}this.ecg_chart.start()}};changeACCGraph=r=>{if(this.acc_chart!==void 0&&this.acc_x_ts!==void 0&&this.acc_y_ts!==void 0&&this.acc_z_ts!==void 0&&this.acc_x_lp_ts!==void 0&&this.acc_y_lp_ts!==void 0&&this.acc_z_lp_ts!==void 0&&this.acc_mag_lp_ts!==void 0&&this.acc_rho_ts!==void 0&&this.acc_phi_ts!==void 0&&this.acc_theta_ts!==void 0&&this.acc_mag_ts!==void 0&&this.acc_x_filter_ts!==void 0&&this.acc_y_filter_ts!==void 0&&this.acc_z_filter_ts!==void 0&&this.acc_mag_filter_ts!==void 0){let o=r.target.selectedIndex,_="";switch(this.acc_chart.stop(),o){case 0:this.acc_chart.configureTimeSeries([this.acc_x_ts,this.acc_y_ts,this.acc_z_ts,this.acc_mag_ts],[Ct,gt,Et,Mt],[F("\u2015 X-axis (mG)",10,5),F("\u2015 Y-axis (mG)",10,5),F("\u2015 Z-axis (mG)",10,5),F("\u2015 Accelerometer magnitude (mG)",10,5)],!0,this.ACC_MIN,this.ACC_MAX,He.title?.text||"Accelerometer raw",!1,[]);break;case 1:this.acc_chart.configureTimeSeries([this.acc_x_lp_ts,this.acc_y_lp_ts,this.acc_z_lp_ts,this.acc_mag_lp_ts],[St,At,bt,Rt],[F("\u2015 Lowpass X-axis (mG)",10,5),F("\u2015 Lowpass Y-axis (mG)",10,5),F("\u2015 Lowpass Z-axis (mG)",10,5),F("\u2015 Lowpass accelerometer magnitude (mG)",10,5)],!0,this.ACC_MIN,this.ACC_MAX,`Lowpass (${xe}Hz ${Fe}th order Butterworth) on Accelerometer raw`,!1,[]);break;case 2:this.acc_chart.configureTimeSeries([this.acc_rho_ts,this.acc_phi_ts,this.acc_theta_ts],[Tt,wt,It],[F("\u2015 \u03C1\xB0 \u2220(X-axis, Horizon)",10,5),F("\u2015 \u03D5\xB0 \u2220(Y-axis, Horizon)",10,5),F("\u2015 \u03B8\xB0 \u2220(Z-axis, -Gravity)",10,5)],!1,-140,140,"Tilt angle [-90\xB0, 90\xB0] from lowpass on accelerometer raw",!0,[{value:90,color:"#ffffff7f",lineWidth:1},{value:-90,color:"#ffffff7f",lineWidth:1}]);break;case 3:this.acc_chart.configureTimeSeries([this.acc_x_filter_ts,this.acc_y_filter_ts,this.acc_z_filter_ts,this.acc_mag_filter_ts],[Dt,Lt,Nt,xt],[F("\u2015 Filtered X-axis (mG)",10,5),F("\u2015 Filtered Y-axis (mG)",10,5),F("\u2015 Filtered Z-axis (mG)",10,5),F("\u2015 Filtered accelerometer magnitude (mG)",10,5)],!0,this.ACC_FILTER_MIN,this.ACC_FILTER_MAX,`${Bt(this.acc_filter_info)} on accelerometer raw magnitude`,!1,[]);break}this.acc_chart.start()}};onWheelECG=r=>{if(this.ecg_chart!==void 0){let o=r.deltaY<0?De:-De;switch(this.ECGFormSelect?.selectedIndex){case 0:break;case 1:this.ECG_FILTER_MAX!==void 0&&this.ECG_FILTER_MIN!==void 0&&(r.preventDefault(),this.ECG_FILTER_MAX+=o,this.ECG_FILTER_MIN-=o,(this.ECG_FILTER_MAX<lt||this.ECG_FILTER_MAX<=this.ECG_FILTER_MIN||this.ECG_FILTER_MAX/ee>Me)&&(this.ECG_FILTER_MAX-=o,this.ECG_FILTER_MIN+=o),this.ecg_chart.options.minValue=this.ECG_FILTER_MIN,this.ecg_chart.options.maxValue=this.ECG_FILTER_MAX);break;case 2:if(this.ECG_RMS_MAX!==void 0){r.preventDefault(),this.ECG_RMS_MAX+=o,(this.ECG_RMS_MAX<ct||this.ECG_RMS_MAX<=this.ECG_RMS_MIN||this.ECG_RMS_MAX/ee>Re)&&(this.ECG_RMS_MAX-=o),this.ecg_chart.options.minValue=0,this.ecg_chart.options.maxValue=this.ECG_RMS_MAX;break}}}};onWheelACC=r=>{if(this.acc_chart!==void 0){let o=0;switch(this.ACCFormSelect?.selectedIndex){case 0:case 1:this.ACC_MAX!==void 0&&this.ACC_MIN!==void 0&&(r.preventDefault(),o=r.deltaY<0?Oe:-Oe,this.ACC_MAX+=o,this.ACC_MIN-=o,(this.ACC_MAX<dt||this.ACC_MAX<=this.ACC_MIN||this.ACC_MAX/ee>ue)&&(this.ACC_MAX-=o,this.ACC_MIN+=o),this.acc_chart.options.minValue=this.ACC_MIN,this.acc_chart.options.maxValue=this.ACC_MAX);break;case 2:break;case 3:this.ACC_FILTER_MAX!==void 0&&this.ACC_FILTER_MIN!==void 0&&(r.preventDefault(),o=r.deltaY<0?ye:-ye,this.ACC_FILTER_MAX+=o,this.ACC_FILTER_MIN-=o,(this.ACC_FILTER_MAX<_t||this.ACC_FILTER_MAX<=this.ACC_MIN||this.ACC_FILTER_MAX/ee>Pe)&&(this.ACC_FILTER_MAX-=o,this.ACC_FILTER_MIN+=o),this.acc_chart.options.minValue=this.ACC_FILTER_MIN,this.acc_chart.options.maxValue=this.ACC_FILTER_MAX);break}}};onToggleECG=async r=>{if(this.ACCSwitchInput.disabled=!0,r.target?.checked){let o;this.ACCDiv===void 0?o="full-width":(o="half-width",this.ACCDiv.classList.remove("full-width"),this.ACCDiv.classList.add("half-width"),this.visContainerDiv.removeChild(this.ACCDiv)),this.ECGDiv=L("ECGDiv",this.visContainerDiv,["float-left","almost-full-height",o]),this.ECGDiv.addEventListener("wheel",this.onWheelECG),this.ACCDiv!==void 0&&this.visContainerDiv.appendChild(this.ACCDiv),this.ecg_canvas=yt("ecg_canvas",this.ECGDiv),this.ecg_chart=new J(Ge),this.ecg_ts=new O.TimeSeries,this.ecg_rms_ts=new O.TimeSeries,this.ecg_filter_ts=new O.TimeSeries,this.ecg_chart.streamTo(this.ecg_canvas,nt),this.ecg_ss_win=new Float64Array(q),this.ecg_ss_win_i=0,this.ecg_ss=0,this.ecg_resize=Ot(this.ecg_chart,1,1),this.ecg_resize_observer=new ResizeObserver(_=>{for(let a of _)a.target===this.ECGDiv&&this.ecg_resize!==void 0&&this.ecg_resize()}),this.ecg_resize_observer.observe(this.ECGDiv),this.ecg_filter_iir_coef=Be[this.ecg_filter_info.type](this.ecg_filter_info),this.ecg_filter_iir=(0,H.IirFilter)(this.ecg_filter_iir_coef),this.ecg_resize(),this.ECGFormSelect!==void 0&&(this.ECGFormSelect.disabled=!1,this.ECGFormSelect.selectedIndex=0),await this.startECG(de),this.changeECGGraph({target:{selectedIndex:0}})}else this.ECGDiv!==void 0&&this.ecg_canvas!==void 0&&this.ecg_chart!==void 0&&(this.ecg_chart.stop(),this.ECGFormSelect!==void 0&&(this.ECGFormSelect.disabled=!0,this.ECGFormSelect.selectedIndex=0),this.ECGDiv.contains(this.ecg_canvas)&&(this.ACCDiv?.classList.remove("half-width"),this.ACCDiv?.classList.add("full-width"),await this.stopECG(),this.visContainerDiv.removeChild(this.ECGDiv),this.ecg_resize_observer?.disconnect(),this.polarH10.removeEventListener("ECG",this.newECGCallback),this.resetECG()));this.ACCSwitchInput&&(this.ACCSwitchInput.disabled=!1)};onToggleACC=async r=>{if(this.ECGSwitchInput&&(this.ECGSwitchInput.disabled=!0),r.target?.checked){let o;this.ECGDiv===void 0?o="full-width":(o="half-width",this.ECGDiv.classList.remove("full-width"),this.ECGDiv.classList.add("half-width")),this.ACCDiv=L("ACCDiv",this.visContainerDiv,["float-left","almost-full-height",o]),this.ACCDiv.addEventListener("wheel",this.onWheelACC),this.acc_canvas=yt("acc_canvas",this.ACCDiv),this.acc_chart=new J(He),this.acc_x_ts=new O.TimeSeries,this.acc_y_ts=new O.TimeSeries,this.acc_z_ts=new O.TimeSeries,this.acc_mag_ts=new O.TimeSeries,this.acc_x_lp_ts=new O.TimeSeries,this.acc_y_lp_ts=new O.TimeSeries,this.acc_z_lp_ts=new O.TimeSeries,this.acc_mag_lp_ts=new O.TimeSeries,this.acc_rho_ts=new O.TimeSeries,this.acc_phi_ts=new O.TimeSeries,this.acc_theta_ts=new O.TimeSeries,this.acc_x_filter_ts=new O.TimeSeries,this.acc_y_filter_ts=new O.TimeSeries,this.acc_z_filter_ts=new O.TimeSeries,this.acc_mag_filter_ts=new O.TimeSeries,this.acc_chart.streamTo(this.acc_canvas,ht),this.acc_resize=Ot(this.acc_chart,1,1),this.acc_resize_observer=new ResizeObserver(_=>{for(let a of _)a.target===this.ACCDiv&&this.acc_resize!==void 0&&this.acc_resize()}),this.acc_resize_observer.observe(this.ACCDiv),this.acc_lp_iir_coef=Be[this.acc_lp_info.type](this.acc_lp_info),this.acc_x_lp_iir=(0,H.IirFilter)(this.acc_lp_iir_coef),this.acc_y_lp_iir=(0,H.IirFilter)(this.acc_lp_iir_coef),this.acc_z_lp_iir=(0,H.IirFilter)(this.acc_lp_iir_coef),this.acc_mag_lp_iir=(0,H.IirFilter)(this.acc_lp_iir_coef),this.acc_filter_iir_coef=Be[this.acc_filter_info.type](this.acc_filter_info),this.acc_x_filter_iir=(0,H.IirFilter)(this.acc_filter_iir_coef),this.acc_y_filter_iir=(0,H.IirFilter)(this.acc_filter_iir_coef),this.acc_z_filter_iir=(0,H.IirFilter)(this.acc_filter_iir_coef),this.acc_mag_filter_iir=(0,H.IirFilter)(this.acc_filter_iir_coef),this.acc_resize(),this.ACCFormSelect!==void 0&&(this.ACCFormSelect.disabled=!1,this.ACCFormSelect.selectedIndex=0),await this.startACC(Le,te),this.changeACCGraph({target:{selectedIndex:0}}),this.show3DBtn.disabled=!1}else this.show3DBtn.disabled=!0,this.ACCDiv!==void 0&&this.acc_canvas!==void 0&&this.acc_chart!==void 0&&(this.acc_chart.stop(),this.ACCFormSelect!==void 0&&(this.ACCFormSelect.disabled=!0,this.ACCFormSelect.selectedIndex=0),this.ACCDiv.contains(this.acc_canvas)&&this.ACCDiv.removeChild(this.acc_canvas),this.ECGDiv?.classList.remove("half-width"),this.ECGDiv?.classList.add("full-width"),this.polarH10.removeEventListener("ACC",this.newACCCallback),this.visContainerDiv.removeChild(this.ACCDiv),this.acc_resize_observer?.disconnect(),await this.stopAcc(),this.resetACC());this.ECGSwitchInput&&(this.ECGSwitchInput.disabled=!1)};removeSelf(){this.parent.contains(this.polarSensorDiv)&&this.parent.removeChild(this.polarSensorDiv);let r=n.polarVisRows.indexOf(this);r>-1&&(n.polarVisRows.splice(r,1),n.polarVisRows.length>0&&(r===n.polarVisRows.length?n.polarVisRows[r-1].orderDownBtn.disabled=!0:r===0&&(n.polarVisRows[0].orderUpBtn.disabled=!0),n.reOrderRows()))}static reOrderRows(){for(let r=0;r<n.polarVisRows.length;r++){let o=n.polarVisRows[r];o.order=r,o.polarSensorDiv.style.order=r.toString()}}async initPolarH10(){this.polarSensorDiv=L("polarSensorDiv",this.parent,["polar-sensor-row","flexbox"]),this.optionDiv=L("optionDiv",this.polarSensorDiv,["polar-sensor-left-panel","center"]),this.order=n.polarVisRows.length,this.polarSensorDiv.style.order=this.order.toString(),this.nameDiv=L("device-name-batt",this.optionDiv,["center","flexbox"],`Conneting ${this.deviceName}...`),this.loadingDiv=L("ConnectLoading",this.optionDiv,["loading","loading-lg","full-width","flexbox"]),await this.initPolarH10IfUnique()}includesDuplicate(r="device",o=void 0){let _=-1;if(o!==void 0)for(let a=0;a<n.polarVisRows.length;a++){let i=n.polarVisRows[a];if(i!==this&&i[r]===this[r]&&o(i)){_=a;break}}else for(let a=0;a<n.polarVisRows.length;a++){let i=n.polarVisRows[a];if(i!==this&&i[r]===this[r]){_=a;break}}return _}static includesDuplicate(r,o="device",_=void 0){let a=-1;if(_!==void 0)for(let i=0;i<n.polarVisRows.length;i++){let d=n.polarVisRows[i];if(d!==r&&d[o]===r[o]&&_(d)){a=i;break}}else for(let i=0;i<n.polarVisRows.length;i++){let d=n.polarVisRows[i];if(d!==r&&d[o]===r[o]){a=i;break}}return a}disconnectPolarH10IfAlone(){this.includesDuplicate("device")===-1&&this.device.gatt?.disconnect()}async initPolarH10IfUnique(){let r=this.includesDuplicate("device");if(r<0)try{this.polarH10=new Ke(this.device),await this.polarH10.init()}catch(o){throw console.log(o),new Error("polarH10 device initialization failed!")}else this.polarH10=n.polarVisRows[r].polarH10}resetECG(){this.ecg_canvas=void 0,this.ECGDiv=void 0,this.ecg_resize=void 0,this.ecg_ss_win=void 0,this.ecg_chart=void 0,this.ecg_ts=void 0,this.ecg_filter_ts=void 0,this.ecg_rms_ts=void 0,this.ecg_resize_observer=void 0,this.ecg_filter_iir_coef=void 0,this.ecg_filter_iir=void 0,this.ecg_ss_win_i=0,this.ecg_ss=0}resetACC(){this.ACCDiv=void 0,this.acc_resize=void 0,this.acc_canvas=void 0,this.acc_chart=void 0,this.acc_x_ts=void 0,this.acc_y_ts=void 0,this.acc_z_ts=void 0,this.acc_resize_observer=void 0,this.acc_lp_iir_coef=void 0,this.acc_filter_iir_coef=void 0,this.acc_x_lp_iir=void 0,this.acc_y_lp_iir=void 0,this.acc_z_lp_iir=void 0,this.acc_mag_lp_iir=void 0,this.acc_x_lp_ts=void 0,this.acc_y_lp_ts=void 0,this.acc_z_lp_ts=void 0,this.acc_rho_ts=void 0,this.acc_phi_ts=void 0,this.acc_theta_ts=void 0,this.acc_mag_ts=void 0}async initDeviceInfo(){this.deviceInfoDiv=L("deviceInfoDiv",this.optionDiv,["device-info"]),this.disconnectDiv=L("disconnectDiv",void 0,["flexbox","disconnect"]),this.disBtn=ie("delete","distBtn",this.disconnectDiv,!1,this.disconnectPolarH10,["btn","btn-primary","btn-sm","s-circle"]),Z(this.disBtn,"disconnect","top"),this.battLvl=await this.polarH10.getBatteryLevel(),this.optionDiv.removeChild(this.loadingDiv),this.optionDiv.removeChild(this.nameDiv),this.optionDiv.classList.remove("center"),this.nameDiv.textContent="",this.nameDiv.classList.add("flex"),this.deviceNameDiv=L("devicename",this.nameDiv,["flexbox"],this.deviceName);let r;this.battLvl>it?r=`\u{1F50B}${this.battLvl}%`:r=`\u{1FAAB}${this.battLvl}%`,this.battLvlDiv=L("battLvl",this.nameDiv,["flexbox","small-mid-text"],r),this.nameDiv.classList.add("flexbox"),this.deviceInfoDiv.appendChild(this.disconnectDiv),this.deviceInfoDiv.appendChild(this.nameDiv),this.optionDiv.appendChild(this.deviceInfoDiv),this.dataInfo=L("dataInfo",this.deviceInfoDiv,["data-info"]),this.extraDataCtrl=L("extraDataCtrl",this.optionDiv,["extra-data-ctrl","center"]),this.filterConfigBtn=ie("settings","filterConfigBtn",this.extraDataCtrl,!0,void 0,["btn","btn-sm"]),Z(this.filterConfigBtn,"settings, work-in-progress","left"),this.show3DBtn=ie("view_in_ar","show3DBtn",this.extraDataCtrl,!0,void 0,["btn","btn-sm"]),this.show3DBtn.disabled=!0,Z(this.show3DBtn,"3D Tilt, work-in-progress","left"),this.rowOrder=L("rowOrder",this.optionDiv,["row-order"]),this.orderUpBtn=ie("arrow-up","orderUpBtn",this.rowOrder,!1,this.moveUp,["btn","btn-primary","btn-sm"]),Z(this.orderUpBtn,"Move up","right"),this.orderUpBtn.disabled=n.polarVisRows.length<1,Z(this.orderUpBtn,"Move up","right"),this.orderDownBtn=ie("arrow-down","orderDownBtn",this.rowOrder,!1,this.moveDown,["btn","btn-primary","btn-sm"]),Z(this.orderDownBtn,"Move down","right"),this.orderDownBtn.disabled=!0,n.polarVisRows.length>0&&(n.polarVisRows[n.polarVisRows.length-1].orderDownBtn.disabled=!1),this.bodypartLabel=L("bodypartLabel",this.dataInfo,["bodypart-text"],"Bodypart:"),this.bodypartSelectDiv=L("bodypartSelectDiv",this.dataInfo,["bodypart-select"]),this.bodypartSelect=Ve("bodypartSelect",this.bodypartSelectDiv,["form-select","dark-select","select-sm","almost-full-width"],"",et,X),this.dataCtrl=L("dataCtrl",this.optionDiv,["data-ctrl"]),this.visContainerDiv=L("visContainer",this.polarSensorDiv,["full-width-height"])}async initDeviceGraphCtrl(){this.ECGCtrlDiv=L("ECGCtrlDiv",this.dataCtrl,["half-width"]);let r=Pt("EXG",this.onToggleECG);this.ECGCtrlDiv.appendChild(r),this.ECGSwitchInput=r.children.item(0),this.ECGDropDown=L("ECGDropDownDiv",this.ECGCtrlDiv,["form-group"]),this.generateECGFormSelect(),this.ACCCtrlDiv=L("ACCCtrlDiv",this.dataCtrl,["half-width"]);let o=Pt("ACC",this.onToggleACC);this.ACCCtrlDiv.appendChild(o),this.ACCSwitchInput=o.children.item(0),this.ACCDropDown=L("ACCDropDownDiv",this.ACCCtrlDiv,["form-group"]),this.generateACCFormSelect()}generateECGFormSelect(r=0,o=!0){this.ECGFormSelect!==void 0&&this.ECGFormSelect.parentElement?.removeChild(this.ECGFormSelect),this.ECGFormSelect=Ve("ECGFormSelect",this.ECGDropDown,["form-select","dark-select","select-sm","almost-full-width"],"",["Raw",ze(this.ecg_filter_info),"RMS"]),this.ECGFormSelect.selectedIndex=r,this.ECGFormSelect.onchange=this.changeECGGraph,this.ECGFormSelect.disabled=o}generateACCFormSelect(r=0,o=!0){this.ACCFormSelect!==void 0&&this.ACCFormSelect.parentElement?.removeChild(this.ACCFormSelect),this.ACCFormSelect=Ve("ACCFormSelect",this.ACCDropDown,["form-select","dark-select","select-sm","almost-full-width"],"",["Raw",ze(this.acc_lp_info),"Tilt",ze(this.acc_filter_info)]),this.ACCFormSelect.selectedIndex=r,this.ACCFormSelect.onchange=this.changeACCGraph,this.ACCFormSelect.disabled=o}async startECG(r=de,o=!0){if(this.includesDuplicate("device",Gt)<0)try{let a=await this.polarH10.startECG(r);a?.error==="SUCCESS"||a?.error==="ALREADY IN STATE"?o&&this.polarH10.addEventListener("ECG",this.newECGCallback):(console.log(a),this.disconnectPolarH10())}catch(a){alert(a),this.disconnectPolarH10()}else this.polarH10.addEventListener("ECG",this.newECGCallback)}async stopECG(){if(this.includesDuplicate("device",Gt)<0)try{let o=await this.polarH10.stopECG();o&&console.log(o)}catch(o){console.log(o),alert(o)}}async startACC(r=Le,o=te,_=!0){if(this.includesDuplicate("device",Ht)<0)try{let i=await this.polarH10.startACC(r,o);i?.error==="SUCCESS"||i?.error==="ALREADY IN STATE"?_&&this.polarH10.addEventListener("ACC",this.newACCCallback):(console.log(i),this.disconnectPolarH10())}catch(i){alert(i),this.disconnectPolarH10()}else this.polarH10.addEventListener("ACC",this.newACCCallback)}async stopAcc(){if(this.includesDuplicate("device",Ht)<0)try{let o=await this.polarH10.stopACC();o&&console.log(o)}catch(o){console.log(o),alert(o)}}ECGIsOn(){return this.ECGDiv!==void 0}ACCIsOn(){return this.ACCDiv!==void 0}};function Ot(n,r,o,_=!1){return()=>{let i=n.canvas,d=i.parentNode,s=d.offsetWidth,e=d.offsetHeight,t=s*r,l=e*o;i.width=t-5,i.height=l,_&&console.log(`Resize at ${new Date().valueOf()} parent: ${d.id} ${d.offsetWidth} ${i.width} ${d.offsetHeight} ${i.height}`)}}function Pt(n,r,o=X){let _=document.createElement("label");_.setAttribute("class","form-switch"),_.classList.add("label-sm");let a=document.createElement("input");a.id=`${n}-onoff-${o()}`,a.type="checkbox",a.addEventListener("change",r),a.classList.add("input-sm");let i=document.createElement("i");return i.classList.add("form-icon"),_.textContent=n,_.appendChild(a),_.appendChild(i),_}function Ve(n,r=void 0,o=[],_="",a=[],i=X){let d=document.createElement("select");return Ue(d,n,r,o,_,i),pi(d,a,i),d}function pi(n,r,o=X){for(let _=0;_<r.length;_++){let a=r[_],i=document.createElement("option");i.id=`${n.id}-${_}-${o()}`,i.textContent=a,n.appendChild(i)}}function L(n,r=void 0,o=[],_="",a=X){let i=document.createElement("div");return Ue(i,n,r,o,_,a),i}function yt(n,r=void 0,o=[],_="",a=X){let i=document.createElement("canvas");return Ue(i,n,r,o,_,a),i}function Ue(n,r,o=void 0,_=[],a="",i=X){return n.id=`${r}-${i()}`,o&&o.appendChild(n),_.length>0&&n.classList.add(..._),a.length>0&&(n.textContent=a),n}function X(){return pe.polarRowID}function Gt(n){return n.ECGDiv!==void 0}function Ht(n){return n.ACCDiv!==void 0}function Z(n,r,o="top"){n.setAttribute("data-tooltip",r),n.classList.add("tooltip",`tooltip-${o}`)}function ie(n,r=void 0,o=void 0,_=!1,a=void 0,i=[],d=X){let s=document.createElement("button");r&&(s.id=`${r}-${d()}`),s.classList.add("flexbox","center");let e=document.createElement("i");return _?(e.classList.add("material-icons"),e.textContent=n):e.classList.add("icon",`icon-${n}`),s.appendChild(e),i.length>0&&s.classList.add(...i),a&&(s.onclick=a),o&&o.appendChild(s),s}function ke(n){return typeof n!="string"||n.length===0?n:n.charAt(0).toUpperCase()+n.slice(1)}function Bt(n,r=!0){let o="";return n.type==="lowpass"||n.type==="highpass"?o=`${n.type} (${Number.isInteger(n.Fc)?n.Fc:n.Fc?.toFixed(1)}Hz ${n.order} order ${ke(n.characteristic)})`:o=`bandpass (${Number.isInteger(n.Fl)?n.Fl:n.Fl?.toFixed(1)}-${Number.isInteger(n.Fh)?n.Fh:n.Fh?.toFixed(1)}Hz ${n.order} order ${ke(n.characteristic)})`,r&&(o=ke(o)),o}function ze(n){let r="";return n.type==="lowpass"||n.type==="highpass"?r=`${Number.isInteger(n.Fc)?n.Fc:n.Fc?.toFixed(1)}Hz ${n.type}`:r=`${Number.isInteger(n.Fl)?n.Fl:n.Fl?.toFixed(1)}-${Number.isInteger(n.Fh)?n.Fh:n.Fh?.toFixed(1)}Hz ${n.type}`,r}var ne=document.createElement("div");ne.id="webapp_container";ne.classList.add("container");document.body.appendChild(ne);var se=document.createElement("div");se.id="top_bar_div";ne.appendChild(se);var Xe=document.createElement("h3");Xe.textContent="Polar H10 raw data visualizer";Xe.classList.add("title");se.appendChild(Xe);se.classList.add("center");var mi="ble_connect_btn",Q=document.createElement("button");Q.setAttribute("data-tooltip","Connect new Polar H10");Q.id=mi;Q.classList.add("btn","btn-primary","btn-action","s-circle","ble-conn");var ae=document.createElement("div");ae.id="content_div";ae.classList.add("flexbox","content");ne.appendChild(ae);if(navigator.bluetooth===void 0){let n=document.createElement("p");n.innerHTML=`Web Bluetooth API is not present!<br>
Please make sure you are using the latest chrome/chromium based browser.<br>
Also make sure to enable experimental-web-platform-features in your browser <a href="chrome://flags/#enable-experimental-web-platform-features">chrome://flags/#enable-experimental-web-platform-features</a> `,n.setAttribute("style","margin:5% 20%;font-size:1.4em;"),ae.appendChild(n),window.stop()}var kt=document.createElement("i");kt.setAttribute("class","icon icon-plus");Q.appendChild(kt);Q.addEventListener("click",vi(ae,Vt));se.appendChild(Q);function vi(n,r){return async o=>{let _;try{_=await navigator.bluetooth.requestDevice({filters:[{namePrefix:"Polar"}],optionalServices:["battery_service","fb005c80-02e7-f387-1cad-8acd2d8df0c8"]})}catch(a){console.log(a);return}r(n,_)}}
/*! Bundled license information:

smoothie/smoothie.js:
  (**
   * @license
   * MIT License:
   *
   * Copyright (c) 2010-2013, Joe Walnes
   *               2013-2018, Drew Noakes
   *
   * Permission is hereby granted, free of charge, to any person obtaining a copy
   * of this software and associated documentation files (the "Software"), to deal
   * in the Software without restriction, including without limitation the rights
   * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
   * copies of the Software, and to permit persons to whom the Software is
   * furnished to do so, subject to the following conditions:
   *
   * The above copyright notice and this permission notice shall be included in
   * all copies or substantial portions of the Software.
   *
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
   * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
   * THE SOFTWARE.
   *)

fili/dist/fili.min.js:
  (**
   * @name    fili
   * @version 2.0.3 | December 13th 2018
   * @author  Florian Markert
   * @license MIT
   *)
*/
//# sourceMappingURL=index.js.map
